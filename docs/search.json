[{"path":"/articles/example1.html","id":"table-of-contents","dir":"Articles","previous_headings":"","what":"Table of contents","title":"Space-time model hospital admissions from gastroenteritis","text":"Introduction Notation structure polynomial trend models structure dynamic regression models structure harmonic trend models structure autoregresive models structure overdispersed models Handling multiple structural blocks Handling multiple linear predictors Handling unknown components planning matrix \\(F_t\\) Special priors Normal case Poisson case Gamma case Multinomial case Handling multiple outcomes Filtering smoothing Extracting components Forecasting Intervention monitoring Tools sensibility analysis Sampling hyper parameter estimation Space-time model hospital admissions gastroenteritis","code":""},{"path":"/articles/example1.html","id":"applied-example-space-time-model-for-hospital-admissions-from-gastroenteritis","dir":"Articles","previous_headings":"","what":"Applied example: Space-time model for hospital admissions from gastroenteritis","title":"Space-time model hospital admissions from gastroenteritis","text":"example model number hospital admissions gastroenteritis Brazil 2010 2022 (Ministry Health, Brazil, 2023). kDGLM package provides gatroBR dataset pertinent data models, includes: UF: abbreviated state name. Date: date observation. Note day placeholder, dealing monthly reports. Admissions: number hospital admissions reported combination state date. Population: estimated population combination state date (used offset). Supplementary information can found documentation (see help(gastroBR))).","code":""},{"path":"/articles/example1.html","id":"initial-model-total-hospital-admissions","dir":"Articles","previous_headings":"","what":"Initial model: Total hospital admissions","title":"Space-time model hospital admissions from gastroenteritis","text":"start analysis model total number hospital admissions time Brazil, .e., temporal model consider hospital admissions state.  figure can see consistent trend (log) linear decay rate hospital admissions time, April 2020, abrupt reduction hospital admission due pandemic COVID-19 (Ribeiro et al., 2022), followed seems return previous level, although observations necessary sure. can also note data clear seasonal pattern, period \\(12\\) months. begin simply model. Let \\(Y_t\\) total number hospital admissions Brazil time \\(t\\). Assume : \\[ \\begin{aligned} Y_t|\\eta_t &\\sim Poisson(\\eta_t)\\\\ \\ln{\\eta_t}&=\\lambda_t=\\theta_{1,t}\\\\ \\theta_{1,t}&=\\theta_{1,t-1}+\\theta_{2,t-1}+\\omega_{1,t}\\\\ \\theta_{2,t}&=\\theta_{2,t-1}+\\omega_{2,t}.\\\\ \\end{aligned} \\] First define model structure: define outcome: fit model: Finally, can see model performed methods:  Clearly model described simple describe data. particular, take account form seasonal pattern. Let us proceed assuming following model: \\[ \\begin{aligned} Y_t|\\eta_t &\\sim Poisson(\\eta_t)\\\\ \\ln{\\eta_t}&=\\lambda_t=\\theta_{1,t}+\\theta_{3,t}\\\\ \\theta_{1,t}&=\\theta_{1,t-1}+\\theta_{2,t-1}+\\omega_{1,t}\\\\ \\theta_{2,t}&=\\theta_{2,t-1}+\\omega_{2,t},\\\\ \\begin{bmatrix}\\theta_{3,t}\\\\\\theta_{4,t}\\end{bmatrix}&=R\\begin{bmatrix}\\theta_{3,t}\\\\\\theta_{4,t}\\end{bmatrix}+\\begin{bmatrix}\\omega_{3,t}\\\\\\omega_{4,t}\\end{bmatrix}\\\\ R&=\\begin{bmatrix} \\cos(\\frac{2\\pi}{12})  &\\sin(\\frac{2\\pi}{12})\\\\ -\\sin(\\frac{2\\pi}{12}) & \\cos(\\frac{2\\pi}{12})\\end{bmatrix} \\end{aligned} \\] \\(R\\) rotation matrix angle \\(\\frac{2\\pi}{12}\\), \\(R^{12}\\) equal identity matrix. define structure model can use harmonic_block function alongside polynomial_block function: fit model (using previously defined outcome):  Notice change significantly improves metrics provided model summary, indicates going right direction. encourage reader test different orders harmonic block. previous model capture mean behavior series reasonably well. However, two deficiencies model standout: first, overconfidence predictions, evidenced particularly thin credibility interval; nnd second, difficulty model adapt pandemic period. first problem comes fact using Poisson model, implies \\(Var[Y_t|\\eta_t]=\\mathbb{E}[Y_t|\\eta_t]\\), means \\(Var[Y_t]=\\mathbb{E}[Var[Y_t|\\eta_t]]+Var[\\mathbb{E}[Y_t|\\eta_t]]=\\mathbb{E}[\\eta_t]+Var[\\eta_t]\\). latter observations expect \\(Var[\\eta_t]\\) relatively small; , variance \\(Y_t\\) close mean reasonable amount observations. scenario, coefficient variation, defined \\(\\frac{\\sqrt{Var[Y_t]}}{\\mathbb{E}[Y_t]}\\) goes \\(0\\) \\(\\mathbb{E}[Y_t]\\) grows, particular, data scale working particular problem, expect low coefficient variation Poisson model adequate, observe. phenomena called well known problem literature . solve , can include block representing white noise added linear predictor time, affect previous future observation, capture overdipersion. case, assume following model: \\[ \\begin{aligned} Y_t|\\eta_t &\\sim Poisson(\\eta_t)\\\\ \\ln{\\eta_t}&=\\lambda_t=\\theta_{1,t}+\\theta_{3,t}+\\epsilon_t\\\\ \\theta_{1,t}&=\\theta_{1,t-1}+\\theta_{2,t-1}+\\omega_{1,t}\\\\ \\theta_{2,t}&=\\theta_{2,t-1}+\\omega_{2,t},\\\\ \\begin{bmatrix}\\theta_{3,t}\\\\\\theta_{4,t}\\end{bmatrix}&=R\\begin{bmatrix}\\theta_{3,t}\\\\\\theta_{4,t}\\end{bmatrix}+\\begin{bmatrix}\\omega_{3,t}\\\\\\omega_{4,t}\\end{bmatrix}\\\\ \\epsilon_t & \\sim \\mathcal{N}(0,\\sigma_t^2) \\end{aligned} \\] structure can defined using function, alongside previously used functions: second problem, slow adaptation start pandemic. ideal approach make intervention, increasing uncertainty latent states beginning pandemic period allowing model quickly adapt new scenario (see West Harrison, 1997, Chapter 11). recommend approach already expect change behavior certain time, even looking data (exactly case). Still, didactic purposes, first present automated monitoring can also used solve problem. general, recommend automated monitoring approach known change behavior happened looking data, .e., known particular event expect impact outcome. Following presented Subsection Intervention monitoring, can use following code fit model: Notice set monitoring polynomial_block c(TRUE,TRUE). default, polynomial_block function activates monitoring first component (level), , visual analysis made beginning, clear pandemic affected level slope average number hospital admissions, , like monitor parameters.  summary presented shows massive improvement comparison metrics new changes introduced. Moreover, can see automated monitoring detected exact moment series \\(Y_t\\) changed behavior, allowed model immediately adapt pandemic period. One aspect model may bother reader exceedingly high uncertainty first observations. behavior duo approach estimation variance white noise introduced noise_block function (see dos Santos et al., 2024 associated documentation details), can bit sensitive bad prior specification initial steps. , highly recommend user perform sensitivity analysis choose initial variance white noise: Notice , time around, chose make intervention beginning pandemic, instead automated approach. mentioned , approach preferable scenario, since aware pandemic affect outcome even looking data. , new changes improve comparison metrics even , leading conclusion last model best among presented now. highly encourage reader run example experiment options kDGLM package offers, explored, changing discount factors used block, order blocks, adding/removing structural components, etc..  last side note, user may like approach choosing specific value initial variance white noise introduced noise_block. Indeed, one may wish define prior distribution parameter estimate along others. detail approach sake brevity (since directly supported), like point offer tools facilitate procedure:","code":"structure <- polynomial_block(   rate = 1, order = 2, D = c(0.95, 0.975),   name = \"Trend\" ) outcome <- Poisson(   lambda = \"rate\",   data = data.year$Admissions,   offset = data.year$Population ) fitted.model <- fit_model(structure, outcome) summary(fitted.model) Fitted DGLM with 1 outcomes.  distributions:     Series.1: Poisson  --- No static coeficients. --- See the coef.fitted_dlm for the coeficients with temporal dynamic.  One-step-ahead prediction Log-likelihood        : -24560.92 Interval Score        :   52492.80142 Mean Abs. Scaled Error:       1.41602 --- plot(fitted.model, plot.pkg = \"base\") structure <- polynomial_block(   rate = 1, order = 2, D = c(0.95, 0.975),   name = \"Trend\" ) +   harmonic_block(     rate = 1, period = 12, D = 0.98,     name = \"Season\"   ) fitted.model <- fit_model(structure, outcome) summary(fitted.model) Fitted DGLM with 1 outcomes.  distributions:     Series.1: Poisson  --- No static coeficients. --- See the coef.fitted_dlm for the coeficients with temporal dynamic.  One-step-ahead prediction Log-likelihood        : -17339.1 Interval Score        :   41481.46809 Mean Abs. Scaled Error:       0.70882 --- plot(fitted.model, plot.pkg = \"base\") structure <- polynomial_block(   rate = 1, order = 2, D = c(0.95, 0.975),   name = \"Trend\" ) +   harmonic_block(     rate = 1, period = 12, D = 0.98,     name = \"Season\"   ) +   noise_block(rate = 1, name = \"Noise\") structure <- polynomial_block(   rate = 1, order = 2, D = c(0.95, 0.975),   name = \"Trend\", monitoring = c(TRUE, TRUE) ) +   harmonic_block(     rate = 1, period = 12, D = 0.98,     name = \"Season\"   ) +   noise_block(rate = 1, name = \"Noise\") # To activate the automated monitoring it is enough to set the p.monit argument to a valid value fitted.model <- fit_model(structure, outcome, p.monit = 0.05) summary(fitted.model) Fitted DGLM with 1 outcomes.  distributions:     Series.1: Poisson  --- No static coeficients. --- See the coef.fitted_dlm for the coeficients with temporal dynamic.  One-step-ahead prediction Log-likelihood        : -1283.634 Interval Score        :   14965.54610 Mean Abs. Scaled Error:       0.71239 --- plot(fitted.model, plot.pkg = \"base\") structure <- polynomial_block(   rate = 1, order = 2, D = c(0.95, 0.975),   name = \"Trend\" ) +   harmonic_block(     rate = 1, period = 12, D = 0.98,     name = \"Season\"   ) +   noise_block(rate = 1, R1 = \"H\", name = \"Noise\") # Setting the initial variance as a unknown parameter  structure <- structure |>   intervention(time = 124, var.index = c(1:2), D = 0.005)  search.model <- fit_model(   structure, outcome,   lag = -1, # Using the model likelihood (f(y|M)) as the comparisson metric.   H = seq.int(0, 0.1, l = 101) ) fitted.model <- search.model$model summary(fitted.model) Fitted DGLM with 1 outcomes.  distributions:     Series.1: Poisson  --- No static coeficients. --- See the coef.fitted_dlm for the coeficients with temporal dynamic.  One-step-ahead prediction Log-likelihood        : -1220.102 Interval Score        :    7470.8794 Mean Abs. Scaled Error:       0.5993 --- plot(fitted.model, plot.pkg = \"base\") search.result <- search.model$search.data[order(search.model$search.data$H), ]  H.vals <- search.result$H log.prior <- dgamma(H.vals, 1, 1, log = TRUE) log.like <- search.result$log.like l.fx <- log.prior + log.like pre.fx <- exp(l.fx - max(l.fx)) fx <- pre.fx / sum(pre.fx * (H.vals[2] - H.vals[1])) plot(H.vals, fx,   type = \"l\", xlab = \"H\", ylab = \"Density\",   main = \"Posterior density for the unknown hyperparameter H\" )"},{"path":"/articles/example1.html","id":"advanced-model-hospital-admissions-by-state","dir":"Articles","previous_headings":"","what":"Advanced model: Hospital admissions by state","title":"Space-time model hospital admissions from gastroenteritis","text":"model, need geographic information Brazil, , use auxiliary packages, namely geobr, tidyverse, sf spdep, although kDGLM package depend :  Now proceed fitting model . Let \\(Y_{}\\) number hospital admissions gastroenteritis time \\(t\\) region \\(\\), assume following model: \\[ \\begin{aligned} Y_{}|\\eta_{} &\\sim Poisson(\\eta_{})\\\\ \\ln\\{\\eta_{}\\}&= \\lambda_{}=\\theta_{1,t}+u_{,t}+S_{,t}+\\epsilon_{,t},\\\\ \\theta_{1,t}&= \\theta_{1,t-1}+\\theta_{2,t-1}+\\omega_{1,t},\\\\ \\theta_{2,t}&= \\theta_{2,t-1}+\\omega_{2,t},\\\\ \\begin{bmatrix}u_{,t}\\\\ v_{,t}\\end{bmatrix} &= R \\begin{bmatrix}u_{,t-1}\\\\ v_{,t-1}\\end{bmatrix} + \\begin{bmatrix} \\omega^{u}_{,t}\\\\ \\omega^{u}_{,t}\\end{bmatrix},\\\\ \\epsilon_t & \\sim \\mathcal{N}(0,\\sigma_t^2),\\\\ S_{1,1},...,S_{r,1} & \\sim CAR(\\tau), \\end{aligned} \\] \\(r=27\\) number areas within dataset. Currently, kDGLM package offer support sequential estimation \\(\\tau\\), parameter associated CAR prior. study developed address limitation. now, opt conduct sensitivity analysis determine optimal value \\(tau\\) using tools presented Subsection Tools sensitivity analysis. optimal value found \\(\\tau=0.005\\). Alternatively, real-time inference priority analyst, complete posterior \\(\\tau\\) can obtained adapting code Subsection Sampling hyper parameter estimation, without incurring high computational cost. Notice assuming similar model used initial_model, common effect (global effect) \\(\\theta_{1,t}\\) equally affects regions, local effect \\(S_{,t}\\) affects region \\(\\) evolves smoothly though time. chose vague CAR prior (Banerjee et al., 2014; Schmidt Nobre, 2018) \\(S_{,t}\\). proposed model can fitted using following code: time series hospital admissions gastroenteritis Brazilian states 2010 2022. Notice proposed model can capture general behavior series, simultaneously capturing dependence regions shared component \\(\\theta_{1,t}\\) local effects \\(S_i\\). \\(\\log_{10}\\) hospital admissions rate gastroenteritis Brazilian states 4 key moments: () January 2010, data begins; (b) March 2020, month first case COVID-19 registered Brazil public response; (c) April 2020, first month pandemic period; (d) December 2022, end period study roughly 2 years beginning pandemic. Notice () (b) 10 years passed see steady smoothly yearly reductions hospital admissions led significantly reduction rate hospital. contrast, (b) (c), 1 month passed, see reduction , proportionally, event greater () (b). Lastly, (c) (d), roughly 2 years, rate hospital admissions seems going back seen (c). Since \\(27\\) regions, \\(156\\) observations , reasonably show model performed every combination date location. limit show regions times regions times reader may use code provided document vignette fit model thoroughly examination results. Moreover, focus usage kDGLM package epidemiological aspect results. Finally, computational cost, initial model (total number hospital admissions time) took \\(0.11s\\) fit advanced model took \\(4.24s\\), within expected range, since final model \\(27\\) outcomes \\(110\\) latent states , consider temporal dynamic, yields \\(17.160\\) parameters, joint distribution obtained.","code":"require(geobr) require(tidyverse) require(sf) require(spdep)  br.base <- read_state(   year = 2019,   showProgress = FALSE )  plot.data <- br.base |>   left_join(     gastroBR |>       filter(format(Date, \"%Y\") == \"2019\") |>       select(UF, Population, Admissions) |>       group_by(UF) |>       summarize(         Population = max(Population),         Admissions = sum(Admissions)       ) |>       rename(abbrev_state = UF),     by = \"abbrev_state\"   )  (ggplot() +   geom_sf(data = plot.data, aes(fill = log10(Admissions / Population))) +   scale_fill_distiller(expression(log[10] * \"(admissions/population)\"),     limits = c(-4, -2.5),     palette = \"RdYlBu\",     labels = ~ round(., 2)   ) +   theme_void() +   theme(legend.position = \"bottom\")) adj.matrix <- br.base |>   poly2nb() |>   nb2mat(style = \"B\")  CAR.structure <- polynomial_block(rate = 1, D = 0.9, name = \"CAR\") |>   block_mult(27) |>   block_rename(levels(gastroBR$UF)) |>   CAR_prior(scale = \"Scale\", rho = 1, adj.matrix = adj.matrix)  shared.structure <- polynomial_block(   RO = 1, AC = 1, AM = 1, RR = 1, PA = 1, AP = 1,   TO = 1, MA = 1, PI = 1, CE = 1, RN = 1, PB = 1,   PE = 1, AL = 1, SE = 1, BA = 1, MG = 1, ES = 1,   RJ = 1, SP = 1, PR = 1, SC = 1, RS = 1, MS = 1,   MT = 1, GO = 1, DF = 1,   order = 2, D = c(0.95, 0.975),   name = \"Common\" ) |>   intervention(time = 124, var.index = c(1:2), D = 0.005)  base.structure <- (harmonic_block(rate = 1, order = 1, period = 12, D = 0.98, name = \"Season\") +   noise_block(rate = 1, R1 = 0.007, name = \"Noise\")) |>   block_mult(27) |>   block_rename(levels(gastroBR$UF))  inputs <- list(shared.structure, CAR.structure, base.structure) for (uf in levels(gastroBR$UF)) {   reg.data <- gastroBR |> filter(UF == uf)   inputs[[uf]] <- Poisson(lambda = uf, data = reg.data$Admissions, offset = reg.data$Population) } inputs$Scale <- 10**seq.int(-5, 1, l = 21) model.search <- do.call(fit_model, inputs) fitted.model <- model.search$model (plot(fitted.model, outcomes = c(\"MG\", \"SP\", \"ES\", \"RJ\", \"CE\", \"BA\", \"RS\", \"SC\", \"AM\", \"AC\"), lag = 1, plot.pkg = \"ggplot2\") +   scale_color_manual(\"\", values = rep(\"black\", 10)) +   scale_fill_manual(\"\", values = rep(\"black\", 10)) +   facet_wrap(~Serie, ncol = 2, scale = \"free_y\") +   coord_cartesian(ylim = c(NA, NA)) +   guides(color = \"none\", fill = \"none\") +   theme(legend.position = \"top\"))  [1m [22mScale for  [32mcolour [39m is already present. Adding another scale for  [32mcolour [39m, which will replace the existing scale.  [1m [22mScale for  [32mfill [39m is already present. Adding another scale for  [32mfill [39m, which will replace the existing scale.  [1m [22mCoordinate system already present. Adding new coordinate system, which will replace the existing one. smoothed.values <- coef(fitted.model) plot.data <- data.frame() labels <- list(   \"2010-01-01\" = \"(a) January, 2010\",   \"2020-03-01\" = \"(b) March, 2020\",   \"2020-04-01\" = \"(c) April, 2020\",   \"2022-12-01\" = \"(d) December, 2022\" ) for (date in c(\"2010-01-01\", \"2020-03-01\", \"2020-04-01\", \"2022-12-01\")) {   index <- min(which(gastroBR$Date == date))   plot.data <- rbind(     plot.data,     cbind(       Date = labels[[date]],       Effect = smoothed.values$lambda.mean[order(order(levels(reg.data$UF))), index] / log(10),       br.base     )   ) }  (ggplot() +   geom_sf(data = plot.data, aes(fill = Effect)) +   facet_wrap(~Date, strip.position = \"bottom\") +   scale_fill_distiller(\"$\\\\log_{10}$ rate\",     limits = c(-6, -3),     palette = \"RdYlBu\",     labels = ~ round(., 2)   ) +   theme_void() +   theme(legend.position = \"bottom\")) labels <- list(   \"2015-01-01\" = \"January, 2015\",   \"2019-12-01\" = \"December, 2019\" ) plot.data <- data.frame() for (date in c(\"2015-01-01\", \"2019-12-01\")) {   index <- min(which(gastroBR$Date == date))    forecast.vals <- coef(fitted.model, lag = 3, t.eval = index, eval.pred = TRUE)    mean.pred <- forecast.vals$data$Prediction   reg.data <- gastroBR %>%     filter(Date == date) %>%     mutate(Tx = log10(Admissions / Population))    plot.data <- rbind(     plot.data,     cbind(       Date = labels[[date]],       Effect = log10(mean.pred) - log10(reg.data$Population),       br.base,       Label = \"Prediction\"     )   )   plot.data <- rbind(     plot.data,     cbind(       Date = labels[[date]],       Effect = reg.data$Tx, br.base,       Label = \"Observed\"     )   ) } plot.data$Label <- factor(plot.data$Label, levels = unique(plot.data$Label))  (ggplot() +   geom_sf(data = plot.data, aes(fill = Effect)) +   facet_wrap(Label ~ Date, strip.position = \"bottom\") +   scale_fill_distiller(\"log10 rate\",     limits = c(-5.5, -3.5),     palette = \"RdYlBu\",     labels = ~ round(., 2)   ) +   theme_void() +   theme(legend.position = \"bottom\"))"},{"path":[]},{"path":"/articles/fitting.html","id":"table-of-contents","dir":"Articles","previous_headings":"","what":"Table of contents","title":"Fitting and analysing models","text":"Introduction Notation structure polynomial trend models structure dynamic regression models structure harmonic trend models structure autoregresive models structure overdispersed models Handling multiple structural blocks Handling multiple linear predictors Handling unknown components planning matrix \\(F_t\\) Special priors Normal case Poisson case Gamma case Multinomial case Handling multiple outcomes Filtering smoothing Extracting components Forecasting Intervention monitoring Tools sensibility analysis Sampling hyper parameter estimation Space-time model hospital admissions gastroenteritis","code":""},{"path":"/articles/fitting.html","id":"fitting-and-analysing-models","dir":"Articles","previous_headings":"","what":"Fitting and analysing models","title":"Fitting and analysing models","text":"section briefly present usage fit_model function, along side auxiliary functions analyzing fitted model, summary, coef,plot, forecast simulate methods. deep dive details argument function, see documentation function /reference manual.","code":""},{"path":"/articles/fitting.html","id":"filtering-and-smoothing","dir":"Articles","previous_headings":"","what":"Filtering and smoothing","title":"Fitting and analysing models","text":"... argument receives dlm_block dlm_distr objects, creation described previous sections. particular, user gives dlm_distr object named argument, name used label outcome. argument smooth Boolean indicating smoothed distribution latent states evaluated. general, recommend users change value, computational cost smoothing usually negligible. p_monit controls sensitivity automated monitoring shall discuss usage subsection Intervention monitoring. Bellow present code fits Poisson model: first two lines create structural blocks representing random walk \\(\\mu_t\\) seasonal component described harmonics. fourth line creates Poisson outcome rate parameter lambda equal \\(\\exp\\{\\text{rate}\\}\\), rate label given linear predictor creating structural blocks (see section Creating model structure details linear predictor). last line receives model structure Poisson outcome fits model, obtaining parameters filtered smoothed distribution latent states. user can see model fits data using plot method, syntax follows: model argument must fitted_dlm object (.e., output fit_model function). pred.cred must number \\(0\\) \\(1\\) representing desired credibility predictions. lag must integer representing number steps ahead used predictions. lag\\(<0\\), smoothed distribution used predictions , lag\\(=0\\), filtered distribution used Instead. cutoff must integer representing number initial steps omitted plot. Usually, model still learning initial steps, predictions reliable. default value one tenth sample size rounded . Lastly plot.pkg must string specifying plot engine used. one 'auto', 'base', 'ggplot2' 'plotly'. 'auto' used, function tries use plotly package, fails, tries use ggplot2 packge , also fails, native functions provided R used.  remaining functions methods section similar usage plot.fitte_dlm method, , sake brevity, highlight unique arguments /behaviors function method present. strongly advise user consult reference manual documentation function detailed descriptions function. see summary fitted model, one can use summary method: Note static components model, .e. without temporal dynamic, shown summary. unpratical show values latent states times summary, showing one specific time can lead misleading results unaware users. see latent states temporal dynamic, one must use coef plot methods. details usage summary method, see associated documentation (help(summary.fitted_dlm)).","code":"level <- polynomial_block(rate = 1, order = 2, D = 0.95) season <- harmonic_block(rate = 1, period = 12, order = 2, D = 0.975)  outcome <- Poisson(lambda = \"rate\", data = c(AirPassengers))  fitted.model <- fit_model(   level, season, # Strucuture   AirPassengers = outcome ) # outcome plot.fitted_dlm(model, pred.cred = 0.95, lag = 1, cutoff = floor(model$t / 10), plot.pkg = \"auto\") plot(fitted.model, plot.pkg = \"base\") summary(fitted.model) Fitted DGLM with 1 outcomes.  distributions:     AirPassengers: Poisson  --- No static coeficients. --- See the coef.fitted_dlm for the coeficients with temporal dynamic.  One-step-ahead prediction Log-likelihood        : -572.0896 Interval Score        : 106.83846 Mean Abs. Scaled Error:   0.40837 ---"},{"path":"/articles/fitting.html","id":"extracting-components","dir":"Articles","previous_headings":"","what":"Extracting components","title":"Fitting and analysing models","text":"Naturally, user may want extract information posterior distribution parameters fitted model, thorough analysis may performed. extracting parameters distribution latent states, linear predictors observational model parameters, one can use coef method: object parameter must specified fitted_dlm object, represents model components extracted. t.eval parameter vector denotes time indices posterior evaluated. parameters lag pred.cred retain meanings analogous plot method fitted_dlm class. eval.pred parameter requires boolean value, indicating whether predictive distribution observations evaluated. Additionally, eval.pred parameter boolean specifying whether model comparison metrics computed. output function dlm_coef object containing: data: data frame model evaluated observed time. mt: \\(n \\times T\\) matrix representing mean latent states time, \\(n\\) number latent states model \\(T\\) length time series; Ct: 3D-array containing covariance matrix latent state time. Dimensions \\(n \\times n \\times T\\); ft: \\(k \\times T\\) matrix representing mean linear predictor time, \\(k\\) number linear predictors model \\(T\\) length time series; Qt: 3D-array containing covariance matrix linear predictor time. Dimensions \\(k \\times k \\times T\\); Several vectors metrics, including predictive log-likelihood, Mean Absolute Scaled Error (MASE, Hyndman Koehler, 2006) Interval Score (interval.score, Bracher, 2021). conj.param: list containing parameters conjugate distribution parameter observational model. important highlight , following method proposed Alves et al. (2024), joint distribution latent states linear predictors time Gaussian, mean vector covariance matrix completely define distribution. user may also want plot latent states, plot method dlm_coef class can used:  user wants see restricted set latent states, extra argument var can used specify label variables plot:  user may also plot linear predictors, specifying name linear predictor:  Lastly, although recommend , user may also extract information directly fitted_dlm object. strongly recommend every user consult documentation functions see full set features provided kDGLM package.","code":"coef(object, t.eval = seq_len(object$t), lag = -1, pred.cred = 0.95, eval.pred = FALSE, eval.metric = FALSE, ...) fitted.coef <- coef(fitted.model) plot(fitted.coef, plot.pkg = \"base\") plot(fitted.coef, \"Var.Poly.Level\", plot.pkg = \"base\") plot(fitted.coef, \"rate\", plot.pkg = \"base\")"},{"path":"/articles/fitting.html","id":"forecasting","dir":"Articles","previous_headings":"","what":"Forecasting","title":"Fitting and analysing models","text":"Notice methods functions presented previously restricted period model fitted. user wishes make predictions future observations, forecast method can used: object parameter required fitted_dlm object. t parameter specifies prediction window. plot parameter determines whether plot generated , applicable, engine use, akin plot method fitted_dlm class. pred.cred parameter signifies credibility confidence intervals. Additionally plot (optional), forecast method fitted_dlm class also provides similar set attributes dlm_coef class , specifically, predictive distribution latent states, linear predictors observational model parameters, along predictions future observations. relevant point external data necessary forecasting, models regressive blocks transfer functions, necessary pass values forecast method. scenario, user must pass new argument named variable “missing” model. See documentation see determine name missing values , practically, try use forecast method without necessary arguments, since name missing variables presented error message. present two examples model Multinomial outcome: One covariates properly passed another :  details usage function, see associated documentation.","code":"forecast(object,   t = 1,   plot = ifelse(requireNamespace(\"plotly\", quietly = TRUE), \"plotly\", ifelse(requireNamespace(\"ggplot2\", quietly = TRUE), \"ggplot2\", \"base\")),   pred.cred = 0.95,   ... ) forecast(fitted.model, t = 20, plot = \"base\")$plot structure <-   polynomial_block(p = 1, order = 2, D = 0.95) +   harmonic_block(p = 1, period = 12, D = 0.975) +   noise_block(p = 1, R1 = 0.1) +   regression_block(     p = chickenPox$date >= as.Date(\"2013-09-1\"),     # Vaccine was introduced in September of 2013     name = \"Vaccine\"   )  outcome <- Multinom(p = c(\"p.1\", \"p.2\"), data = chickenPox[, c(2, 3, 5)]) fitted.model <- fit_model(structure * 2, chickenPox = outcome)  forecast(fitted.model, t = 24, plot = \"base\") # Missing extra arguments Error in forecast.fitted_dlm(fitted.model, t = 24, plot = \"base\"): Error: Missing extra argument: Vaccine.1.Covariate forecast(fitted.model,   t = 24,   Vaccine.1.Covariate = rep(TRUE, 24), # Extra argument for covariate 1   Vaccine.2.Covariate = rep(TRUE, 24), plot = \"base\" ) # Extra argument for covariate 2"},{"path":"/articles/fitting.html","id":"updating-a-fitted-model","dir":"Articles","previous_headings":"","what":"Updating a fitted model","title":"Fitting and analysing models","text":"One major advantages sequential nature methodology proposed Alves et al. (2024) allows updating posterior distribution parameter new data arrives, without necessity reprocessing data previously observed. feature particularly useful problems involve monitoring real time inference phenomena. updating fitted_dlm object, user can use update method fitted_dlm class: object argument must fitted_dlm object. Moreover, ... argument must sequence named arguments containing new information observed. example: Note name argument containing new observations must label given outcome first fitting model. case, argument must named update, label used fit_model function label provided fitting model, default name used, consist string 'Series.' followed proper index outcome. update function may require extra arguments containing covariates, pulses (transfer function), offset, etc.. cases, syntax forecast method.","code":"update.fitted_dlm(object, ...) level <- polynomial_block(rate = 1, order = 2, D = 0.95) season <- harmonic_block(rate = 1, period = 12, order = 2, D = 0.975) # Omitting the last 44 observations outcome <- Poisson(lambda = \"rate\", data = c(AirPassengers)[1:100]) fitted.model <- fit_model(   level, season, # Strucuture   AirPassengers = outcome ) # outcome updated.fit <- update(fitted.model,   AirPassengers = list(data = c(AirPassengers)[101:144]) )"},{"path":"/articles/fitting.html","id":"intervention-and-monitoring","dir":"Articles","previous_headings":"","what":"Intervention and monitoring","title":"Fitting and analysing models","text":"key feature, kDGLM package support intervention automated monitoring. First, user aware specific time change time series part temporal dynamic, user provide information model structure. provide intervention function:  See documentation intervention function details arguments. Also, strongly recommend user consult West Harrison (1997), chapter 11 detailed discussion Feed-Foward Interventions. case user aware behavioral changes data, suspects may occurred unknown time, recommend use automated monitoring. fit model using automated monitoring, user must provide valid value p.monit argument fit_model function argument receives values \\(0\\) \\(1\\), value interpreted prior probability (.e., probability observing data), given time, behavioral change series accommodated temporal dynamic.  approach used automated monitoring almost identical West Harrison (1997), chapter 11.4, using Bayes’ factor, p.monit\\(=0.05\\) yields threshold equivalent recommended West Harrison (1997).","code":"data <- c(AirPassengers) # Adding an artificial change, so that we can make an intervention on the data at that point # Obviously, one should NOT change their own data. data[60:144] <- data[60:144] + 100  level <- polynomial_block(rate = 1, order = 2, D = 0.95) season <- harmonic_block(rate = 1, order = 2, period = 12, D = 0.975)  # Reducing the discount factor so that the model can capture the expected change. level <- level |> intervention(time = 60, D = 0.005, var.index = 1) # Comment the line above to see the fit without the intervention  fitted.model <- fit_model(level, season,   AirPassengers = Poisson(lambda = \"rate\", data = data) )  plot(fitted.model, plot.pkg = \"base\") data <- c(AirPassengers) # Adding an artificial change, so that we can make an intervention on the data at that point # Obviously, one should NOT change their own data. data[60:144] <- data[60:144] + 100  level <- polynomial_block(rate = 1, order = 2, D = 0.95) season <- harmonic_block(rate = 1, order = 2, period = 12, D = 0.975)  fitted.model <- fit_model(level, season,   AirPassengers = Poisson(lambda = \"rate\", data = data),   p.monit = 0.05 )  plot(fitted.model, plot.pkg = \"base\")"},{"path":"/articles/fitting.html","id":"tools-for-sensitivity-analysis","dir":"Articles","previous_headings":"","what":"Tools for sensitivity analysis","title":"Fitting and analysing models","text":"situations, user may sure value use hyperparameter model (discount factor order block) inclusion structural block. , one might choose perform sensitivity analysis effect choices. motivational example, let us assume unsure value choose discount factor polynomial trend block Poisson model. First, defining model structure, must set discount factor string, used label unspecified parameter: setting discount factor string, structural block becomes partially : , block used fit_model function, unless value D1 specified: user can see error message , undefined dlm_block can used fit model, unless value missing hyper-parameters passed named arguments. Addionally, user may pass several sequence values missing hyper-parameter. case, fit_model function used fit set models, computing comparative metrics. argumetns ..., smooth p.monit discussed Subsection Filtering smoothing. Beyond dlm_blocks dlm_distr objects, ... argument also must containing, undefined parameter (exist), values tested. default, function test possible combinations undefined parameter. user wishes skip combinations, condition argument can used provide string criterion determine combinations shall evaluated. remaining options provide control comparative metrics. metric argument ('mase', 'log.like' 'interval.score') indicates metric use selecting best model (metrics calculated, matter value metric argument, best model chosen metric saved). lag argument indicates number steps ahead used predictions (\\(0\\) indicates filtered predictions negative values indicate smoothed predictions). pred.cred argument indicates credibility intervals used computing Interval Score. metric.cutoff argument indicates number initial observations ignored computing metrics. evaluating valid combinations hyper parameters, fit_model function returns best model chosen metric, along data frame containing metrics model evaluated. important note hyper parameters can tested directly fit_model function, indeed, components associated \\(F_t\\), \\(D_t\\), \\(h_t\\), \\(H_t\\), \\(a_1\\) \\(R_1\\) can treated undefined. Still, user wants test hyper parameter tested directly (order polynomial block period harmonic block), can create one block option perform sensitivity analysis inclusion/exclusion block:","code":"level <- polynomial_block(rate = 1, order = 2, D = \"D1\") summary(level) Basic DLM block. latent states:      Var.Poly: Level, Slope (2 variable(s))  Linear predictors:      rate  Status: undefined Serie length: 1 Interventions at:  Number of latent states: 2 Number of linear predictors: 1 # D1 is missing season <- harmonic_block(rate = 1, order = 2, period = 12, D = 0.975) outcome <- Poisson(lambda = \"rate\", data = c(AirPassengers)) fitted.model <- fit_model(level, season, AirPassengers = outcome) Error in fit_model(level, season, AirPassengers = outcome): Error: No model to test. Verify if the hyper-parameters are properly specified and if a valid value for condition argument is being passed. # D1 is set within the fit method season <- harmonic_block(rate = 1, order = 2, period = 12, D = 0.975) outcome <- Poisson(lambda = \"rate\", data = c(AirPassengers)) fitted.model <- fit_model(level, season, AirPassengers = outcome, D1 = 0.95) fit.dlm_block(...,   smooth = TRUE, p.monit = NA,   condition = \"TRUE\", metric = \"log.like\",   pred.cred = 0.95, metric.cutoff = NA, lag = 1 ) level <- polynomial_block(rate = 1, order = 2, D = \"D.level\") season <- harmonic_block(   rate = \"sazo.effect\", period = 12,   order = 2, D = \"D.sazo\" )  outcome <- Poisson(lambda = \"rate\", data = c(AirPassengers))  fit_model(level, season, outcome,   sazo.effect = c(0, 1),   D.level = seq(0.8, 1, l = 11),   D.sazo = seq(0.95, 1, l = 11),   condition = \"sazo.effect==1 | D.sazo==1\" )$search.data |> head() # Creating a block for each order level <- polynomial_block(rate = \"pol.ord.1\", order = 1, D = 0.95) +   polynomial_block(rate = \"pol.ord.2\", order = 2, D = 0.95) +   polynomial_block(rate = \"pol.ord.3\", order = 3, D = 0.95) +   polynomial_block(rate = \"pol.ord.4\", order = 4, D = 0.95) season <- harmonic_block(rate = 1, order = 2, period = 12, D = 0.975)  outcome <- Poisson(lambda = \"rate\", data = c(AirPassengers))  fit_model(level, season, outcome,   # Each block can be present (1) or absent (0).   pol.ord.1 = c(0, 1), pol.ord.2 = c(0, 1),   pol.ord.3 = c(0, 1), pol.ord.4 = c(0, 1),   condition = \"pol.ord.1+pol.ord.2+pol.ord.3+pol.ord.4==1\"   # Only test combinations with exactly one polynomial block. )$search.data |> head()"},{"path":"/articles/fitting.html","id":"sampling-and-hyper-parameter-estimation","dir":"Articles","previous_headings":"","what":"Sampling and hyper parameter estimation","title":"Fitting and analysing models","text":"Lastly, one may also want draw samples latent states, linear predictors /parameters \\(\\eta_t\\) observational model. can useful evaluate non-linear functions model parameters DGLM part bigger model, parameters estimated Gibbs Algorithm. important note , method proposed Alves et al. (2024), sampling posterior distribution latent states straight forward, allowing user obtain large independent (approximately independent, exactly independent) samples low computational cost. See West Harrison (1997), chapter 15, details sampling algorithm. kDGLM package offers simulate function, provides routine drawing independent samples fitted model: example , model \\(6\\) latent states \\(144\\) observations (yields total \\(864\\) parameters), takes approximately \\(0.3\\) seconds draw sample size \\(5.000\\). Another useful feature kDGLM package provides approximate value Model likelihood \\(f(y)= \\int_{\\mathbb{R}^{n}}f(y|\\theta)f(\\theta)d\\theta\\), \\(y\\) represents values \\(Y_t\\) \\(t\\) \\(\\theta\\) represents values \\(\\theta_t\\) \\(t\\). feature can used two main purposes: compare different models evaluate posterior distribution hyper parameter. compare different models, \\(\\mathcal{M}_1,...,\\mathcal{M}_k\\) , one can note \\(f(\\mathcal{M}_i|y) \\propto f(y|\\mathcal{M}_i)f(\\mathcal{M}_i)\\), \\(f(y|\\mathcal{M}_i)= \\int_{\\mathbb{R}^{n}}f(y|\\theta,\\mathcal{M}_i)f(\\theta|\\mathcal{M}_i)d\\theta\\) likelihood model \\(\\mathcal{M}_i\\) \\(f(\\mathcal{M}_i)\\) prior model \\(\\mathcal{M}_i\\). evaluate \\(f(y|\\mathcal{M}_i)\\), one can make use coef method, eval_dlm_norm_const fit_model functions setting lag negative number (log likelihood metric \\(\\ln f(y|\\mathcal{M}_i)\\)). Similarly, user wants obtain marginal posterior distribution hyper parameter \\(\\tau\\), can observe \\(f(\\tau|y) \\propto f(y|\\tau)f(\\tau)\\), \\(f(y|\\tau)\\) can evaluated using coef method, eval_dlm_norm_const fit_model functions.","code":"simulate(fitted.model, 5000) H.range <- seq.int(0, 2, l = 100) log.like.H <- seq_along(H.range) log.prior.H <- dlnorm(H.range, 0, 1, log = TRUE) for (i in seq_along(H.range)) {   level <- polynomial_block(rate = 1, order = 2, H = H.range[i])   season <- harmonic_block(rate = 1, order = 2, period = 12, D = 0.975)   # Using only 10 observations, for the sake of a pretty plot. For this particular application, the posterior density of H rapidly becomes highly consentrated in a single value.   outcome <- Poisson(lambda = \"rate\", data = c(AirPassengers)[1:10])   fitted.model <- fit_model(level, season, outcome)   log.like.H[i] <- eval_dlm_norm_const(fitted.model) } log.post.H <- log.prior.H + log.like.H post.H <- exp(log.post.H - max(log.post.H)) plot(H.range, post.H, type = \"l\", xlab = \"H\", ylab = \"f(H|y)\")"},{"path":[]},{"path":"/articles/intro.html","id":"table-of-contents","dir":"Articles","previous_headings":"","what":"Table of contents","title":"Introduction","text":"Introduction Notation structure polynomial trend models structure dynamic regression models structure harmonic trend models structure autoregresive models structure overdispersed models Handling multiple structural blocks Handling multiple linear predictors Handling unknown components planning matrix \\(F_t\\) Special priors Normal case Poisson case Gamma case Multinomial case Handling multiple outcomes Filtering smoothing Extracting components Forecasting Intervention monitoring Tools sensitivity analysis Sampling hyper parameter estimation Space-time model hospital admissions gastroenteritis","code":""},{"path":"/articles/intro.html","id":"introduction","dir":"Articles","previous_headings":"","what":"Introduction","title":"Introduction","text":"vignette intended introduction usage kDGLM package, offers routines Bayesian analysis Dynamic Generalized Linear Models, including fitting (filtering smoothing), forecasting, sampling, intervention automated monitoring, following theory developed /explored Kalman (1960), West Harrison (1997) Alves et al. (2024). document focus exclusively usage package briefly mention theory behind models intention highlighting notation. highly recommend users read theoretical work (dos Santos et al., 2024) based package. document organized following order: First introduce notations class models dealing ; Next present details specification model structure, offering tools allow easy, fast (hopefully) intuitive way defining models; following section discuss details user can specify observational model; present basic examples model fitting, also showing auxiliary functions help user analyse fitted model. also show tools easy model selection; Lastly, present variety advanced examples, combining basic features shown previous sections create complex models;","code":""},{"path":"/articles/intro.html","id":"notation","dir":"Articles","previous_headings":"","what":"Notation","title":"Introduction","text":"section, assume user’s interest lies analyzing Time Series \\(\\{\\vec{Y}_t\\}_{t=1}^T\\), adheres model described : \\[\\begin{equation} \\begin{aligned} \\vec{Y}_t|\\vec{\\eta}_t &\\sim \\mathcal{F}\\left(\\vec{\\eta}_t\\right),\\\\ g(\\vec{\\eta}_t) &=\\vec{\\lambda}_{t}=F_t'\\vec{\\theta}_t,\\\\ \\vec{\\theta}_t&=G_t\\vec{\\theta}_{t-1}+\\vec{\\omega}_t,\\\\ \\vec{\\omega}_t &\\sim \\mathcal{N}_n(\\vec{h}_t,W_t), \\end{aligned} \\end{equation}\\] model comprises: \\(\\vec{Y}_t=(Y_{1,t},...,Y_{r,t})'\\), outcome, \\(r\\)-dimensional vector observed variable. \\(\\vec{\\theta}_t=(\\theta_{1,t},...,\\theta_{n,t})'\\), representing unknown parameters (latent states), \\(n\\)-dimensional vector, consistently dimensioned across observations. \\(\\vec{\\lambda}_t=(\\lambda_{1,t},...,\\lambda_{k,t})'\\), linear predictors, \\(k\\)-dimensional vector indicating linear transformation latent states. per , \\(\\vec{\\lambda}_t\\) assumed (approximately) Normally distributed times directly corresponds observational parameters \\(\\vec{\\eta}_t\\), one--one correspondence \\(g\\). \\(\\vec{\\eta}_t=(\\eta_{1,t},...,\\eta_{l,t})'\\), observational parameters, \\(l\\)-dimensional vector defining model’s observational aspects. Typically, \\(l=k\\), may hold special cases, Multinomial model, \\(k=l-1\\). \\(\\mathcal{F}\\), distribution Exponential Family indexed \\(\\vec{\\eta}_t\\). Pre-determines values \\(k\\) \\(l\\), along link function \\(g\\). \\(g\\), link function, establishes one--one correspondence \\(\\vec{\\lambda}_t\\) \\(\\vec{\\eta}_t\\). \\(F_t\\), design matrix, user-defined, mostly known, matrix size \\(k \\times n\\). \\(G_t\\), evolution matrix, user-defined, mostly known, matrix size \\(n \\times n\\). \\(\\vec{h}_t=(h_{1,t},...,h_{n,t})'\\), drift, known \\(n\\)-dimensional vector, typically set \\(\\vec{0}\\) except model interventions (refer subsection \\(\\ref{intervention}\\)). \\(W_t\\), known covariance matrix size \\(n \\times n\\), specified user. Per , define \\(\\mathcal{D}_t\\) cumulative information observing first \\(t\\) data points, \\(\\mathcal{D}_0\\) denoting pre-observation knowledge process \\(\\{Y_t\\}^T_{t=1}\\). specification \\(W_t\\) follows , section 6.3, \\(W_t=Var[G_t\\theta_{t-1}|\\mathcal{D}_{t-1}] \\odot (1-D_t) \\oslash D_t + H_t\\). , \\(D_t\\) (discount matrix) \\(n \\times n\\) matrix values \\(0\\) \\(1\\), \\(\\odot\\) represents Hadamard product, \\(\\oslash\\) signifies Hadamard division. \\(H_t\\) another known \\(n \\times n\\) matrix specified user. formulation implies \\(D_t\\) entries \\(1\\), \\(H_t\\) entries \\(0\\), model equates Generalized Linear Model. prototypical example within general model framework Poisson model augmented dynamic level featuring linear growth single covariate \\(X\\): \\[\\begin{equation} \\begin{aligned} Y_t|\\eta_t &\\sim \\mathcal{P}\\left(\\eta_t\\right),\\\\ ln(\\eta_t) &=\\lambda_{t}=\\mu_t+\\beta_t X_t,\\\\ \\mu_t&=\\mu_{t-1}+\\beta_{t-1}+\\omega_{\\mu,t},\\\\ \\nu_t&=\\nu_{t-1}+\\omega_{\\nu,t},\\\\ \\beta_t&=\\beta_{t-1}+\\omega_{\\beta,t},\\\\ \\omega_{\\mu,t},\\omega_{\\nu,t},\\omega_{\\beta,t} &\\sim \\mathcal{N}_3(\\vec{0},W_t), \\end{aligned} \\end{equation}\\] model, \\(\\mathcal{F}\\) denotes Poisson distribution; model dimensions \\(r=k=l=1\\); state vector \\(\\theta_t\\) \\((\\mu_t,\\nu_t,\\beta_t)'\\) dimension \\(n=3\\); link function \\(g\\) natural logarithm; matrices \\(F_t\\) \\(G_t\\) defined : \\[ F_t=\\begin{bmatrix}     1 \\\\     0 \\\\     X_t \\end{bmatrix} \\quad G_t=\\begin{bmatrix}     1 & 1 & 0 \\\\     0 & 1 & 0 \\\\     0 & 0 & 1 \\end{bmatrix} \\] Consider now Normal model unknown mean \\(\\eta_{1,t}\\) unknown precision \\(\\eta_{2,t}\\): \\[\\begin{equation} \\begin{aligned} Y_t|\\eta_t &\\sim \\mathcal{N}\\left(\\eta_{1,t},\\eta_{2,t}^{-1}\\right),\\\\ \\eta_{1,t} &=\\lambda_{1,t}=\\mu_{1,t}+\\beta_t X_t,\\\\ ln(\\eta_{2,t}) &=\\lambda_{2,t}=\\mu_{2,t},\\\\ \\mu_{1,t}&=\\mu_{1,t-1}+\\beta_{t-1}+\\omega_{\\mu_1,t},\\\\ \\nu_t&=\\nu_{t-1}+\\omega_{\\nu,t},\\\\ \\beta_t&=\\beta_{t-1}+\\omega_{\\beta,t},\\\\ \\mu_{2,t}&=\\phi_{t-1}\\mu_{2,t-1}+\\omega_{\\mu_2,t},\\\\ \\phi_{t}&=\\phi_{t-1}+\\omega_{\\phi,t},\\\\ \\omega_{\\mu_1,t},\\omega_{\\nu,t},\\omega_{\\mu,t},\\omega_{\\beta,t},\\omega_{\\phi,t} &\\sim \\mathcal{N}_5(\\vec{0},W_t), \\end{aligned} \\end{equation}\\] case, \\(\\mathcal{F}\\) represents Normal distribution; model dimensions \\(r=1\\) \\(k=l=2\\); state vector \\(\\theta_t\\) \\((\\mu_{1,t},\\nu_t,\\beta_t,\\mu_{2,t},\\phi_t)'\\) dimension \\(n=5\\); link function \\(g\\) matrices \\(F_t\\), \\(G_t\\) : \\[ g\\left(\\begin{bmatrix}     x_1 \\\\     x_2 \\end{bmatrix}\\right)= \\begin{bmatrix}     x_1 \\\\     \\ln(x_2) \\end{bmatrix}\\quad F_t=\\begin{bmatrix}     1 & 0 \\\\     0 & 0\\\\     X_t & 0 \\\\     0 & 1 \\\\     0 & 0 \\end{bmatrix} \\quad G_t=\\begin{bmatrix}     1 & 1 & 0 & 0 & 0\\\\     0 & 1 & 0 & 0 & 0\\\\     0 & 0 & 1 & 0 & 0\\\\     0 & 0¨& 0 & \\phi & 0\\\\     0 & 0¨& 0 & 0 & 1 \\end{bmatrix} \\] configuration introduces \\(l=2\\) observational parameters, necessitating \\(k=2\\) linear predictors. first linear predictor pertains location parameter Normal distribution includes linear growth model covariate \\(X_t\\). second linear predictor, associated precision parameter, models log precision autoregressive (AR) process. express model terms Extended Kalman Filter (Kalman, 1960; West Harrison, 1997). formulation aligns concept traditional Stochastic Volatility model, highlighted Alves et al. (2024). Normal Poisson models illustrate univariate cases. However, general model also accommodates multivariate outcomes, multinomial case. Consider vector counts \\(\\vec{Y}_t=(Y_{1,t},Y_{2,t},Y_{3,t},Y_{4,t},Y_{5,t})'\\), \\(Y_{,T} \\\\mathbb{Z}\\) \\(N_t=\\sum_{=1}^{5}Y_{,t}\\). model : \\[\\begin{equation} \\begin{aligned} \\vec{Y}_{5,t}|N_t,\\vec{\\eta}_{t} &\\sim Multinomial\\left(N_t,\\vec{\\eta}_{t}\\right),\\\\ \\ln\\left(\\frac{\\eta_{,t}}{\\eta_{5,t}}\\right) &=\\lambda_{1,t}=\\mu_{,t},=1,...,4\\\\ \\mu_{,t}&=\\mu_{,t-1}+\\omega_{\\mu_i,t},=1,...,4\\\\ \\omega_{\\mu_1,t},\\omega_{\\mu_2,t},\\omega_{\\mu_3,t},\\omega_{\\mu_4,t} &\\sim \\mathcal{N}_4(\\vec{0},W_t), \\end{aligned} \\end{equation}\\] multinomial model, \\(\\mathcal{F}\\) Multinomial distribution; model dimensions \\(r=5\\), \\(l=5\\) \\(k=4\\); state vector \\(\\theta_t\\) \\((\\mu_{1,t},\\mu_{2,t},\\mu_{3,t},\\mu_{4,t})'\\); \\(F_t\\) \\(G_t\\) identity matrices size \\(4\\times 4\\); link function \\(g\\) maps \\(\\mathbb{R}^5\\) \\(\\mathbb{R}^{4}\\) : \\[ g\\left(\\begin{bmatrix}     x_1 \\\\     x_2 \\\\     x_3 \\\\     x_4 \\\\     x_5 \\end{bmatrix}\\right)= \\begin{bmatrix}     \\ln\\left(\\frac{x_1}{x_5}\\right) \\\\     \\ln\\left(\\frac{x_2}{x_5}\\right) \\\\     \\ln\\left(\\frac{x_3}{x_5}\\right) \\\\     \\ln\\left(\\frac{x_4}{x_5}\\right) \\end{bmatrix} \\] Note Multinomial distribuition, \\(\\eta_i\\ge 0, \\forall \\) \\(\\sum_{=1}^{5} \\eta_i=1\\). Thus, \\(k=l-1\\) linear predictors necessary describe model. ’s important emphasize chosen illustrate simple model structures, random walk log odds outcome, neither general model framework kDGLM package restricts configurations. Analysts flexibility tailor models specific contexts, including incorporation additional latent states enhance outcome explanation. Lastly, general model framework can extended encompass multiple outcome models. details, see Handling multiple outcomes. Given complexity manually specifying model components, kDGLM package includes range auxiliary functions simplify process. subsequent section delves tools.","code":""},{"path":[]},{"path":"/articles/outcomes.html","id":"table-of-contents","dir":"Articles","previous_headings":"","what":"Table of contents","title":"Creation of model outcomes","text":"Introduction Notation structure polynomial trend models structure dynamic regression models structure harmonic trend models structure autoregresive models structure overdispersed models Handling multiple structural blocks Handling multiple linear predictors Handling unknown components planning matrix \\(F_t\\) Special priors Normal case Poisson case Gamma case Multinomial case Handling multiple outcomes Filtering smoothing Extracting components Forecasting Intervention monitoring Tools sensibility analysis Sampling hyper parameter estimation Space-time model hospital admissions gastroenteritis","code":""},{"path":"/articles/outcomes.html","id":"creation-of-model-outcomes","dir":"Articles","previous_headings":"","what":"Creation of model outcomes","title":"Creation of model outcomes","text":"presented tools creating structure DGLM model, specifically, shown define relationship latent vector \\(\\vec{\\theta}_t\\) linear predictors \\(\\vec{\\lambda}_t\\), along temporal dynamic \\(\\vec{\\theta}_t\\). Now proceed define observational model \\(\\vec{Y}_t\\) relationship \\(\\vec{\\lambda}_t\\) \\(\\vec{\\eta}_t\\), .e., highlighted part following equations: \\[ \\require{color} \\begin{equation}\\begin{aligned} \\color{red}{Y_t|\\eta_t }&{\\color{red}\\sim \\mathcal{F}\\left(\\eta_t\\right),}\\\\ {\\color{red}g(\\eta_t) }&{\\color{red}= \\lambda_{t}}=F_t'\\theta_t,\\\\ \\theta_t &=G_t\\theta_{t-1}+\\omega_t,\\\\ \\omega_t &\\sim \\mathcal{N}_n(h_t,W_t), \\end{aligned}\\end{equation} \\] subsection, assume linear predictors already defined, along structure comes along (.e., take granted part model highlighted), moreover, also assume user created necessary amount linear predictors type outcome linear predictors named \\(\\lambda_1\\),…,\\(\\lambda_k\\). Currently, offer support following observational distributions: Normal distribution unknown mean unknown variance (dynamic predictive structure parameters). particular case, also support Normal distribution known variance. Bivariate Normal distribution unknown means, unknown variances unknown correlation (dynamic predictive structure parameters). particular case, also support Multivariate Normal distribution known covariance matrix. Poisson distribution unknown rate parameter dynamic predictive structure. Multinomial distribution known number trials, arbitrary number categories, unknown event probabilities dynamic predictive structure probability category. particular cases, support Binomial Bernoulli distributions. Gamma distribution known shape parameter, unknown mean dynamic predictive structure. currently working include several distributions. particular, following distributions shall supported soon: Dirichlet; Geometric; Negative Binomial; Rayleigh; Pareto; Asymmetric Laplace known mean.","code":""},{"path":"/articles/outcomes.html","id":"normal-case","dir":"Articles","previous_headings":"","what":"Normal case","title":"Creation of model outcomes","text":"sense, can think basic case, least theoretical point view, since Kalman Filter first developed specific scenario (Kalman, 1960). Indeed, static observational variance/covariance matrix (even unknown), fall within DLM class, exact analytical solution posterior latent states. adaptations, one can also degree temporal dynamic variance/covariance matrix (see Ameen Harrison, 1985; West Harrison, 1997, sec. 10.8). Yet, kDGLM package goes step , offering possibility predictive structure mean observational variance/covariance matrix, allowing inclusion dynamic regressions, seasonal trends, autoregressive components, etc., parameters. present case two contexts: first, simple implementation Kalman Filter Smoother, deals data coming Normal distribution (possibly multivariate) unknown mean known variance/covariance matrix; second deals data coming univariate Normal distribution unknown mean unknown variance. Also, end second subsection, present extension bivariated Normal distribution unknown mean unknown covariance matrix. study conducted expand approach \\(k\\)-variated case, arbitrary \\(k\\).","code":""},{"path":"/articles/outcomes.html","id":"normal-outcome-with-known-variance","dir":"Articles","previous_headings":"Normal case","what":"Normal outcome with known variance","title":"Creation of model outcomes","text":"Suppose sequence \\(k\\)-dimensional vectors \\(\\vec{Y}_t\\), \\(\\vec{Y}_t=(Y_{1t},...,Y_{kt})'\\). assume : \\[ \\begin{aligned} \\vec{Y}_t|\\mu_t,V &\\sim \\mathcal{N}_k\\left(\\vec{\\mu}_t,V\\right),\\\\ \\mu_{}&=\\lambda_{}, =1,...,k,\\\\ \\end{aligned} \\] \\(\\vec{\\mu}_t=(\\mu_{1,t},...,\\mu_{k,t})'\\) \\(V\\) known symmetric, definite positive \\(k\\times k\\) matrix. Also, model, assume link function \\(g\\) identity function. create outcome model, can make use Normal function: Intuitively, mu argument must character vector size \\(k\\) containing names linear predictors associated \\(\\mu_{.}\\). user must also specify one (one) V, Tau Sd. user provides V, \\(V\\) assumed value; user provides Tau, \\(V\\) assumed inverse given matrix (.e., Tau precision matrix); user provides Sd, \\(V\\) assumed standard deviation observations equal main diagonal Sd correlation observations assumed equal -diagonal elements Sd. data argument must \\(T \\times k\\) matrix containing values \\(\\vec{Y}_t\\) observation. Notice line \\(t\\) must values categories time \\(t\\) column \\(\\) must represent values category \\(\\) time. value argument data available (NA) specific time, assumed observation time, thus update step filtering algorithm skipped time. Note evolution step still performed, predictive distribution missing data updated distribution latent states time still provided. Next, present brief example usage Normal function univariate outcome (multivariate case works similarly). use functions described previous sections, well functions presented later . now, let us focus usage Normal function.  Notice , since univariate case, data argument can vector.","code":"Normal(mu, V = NA, Tau = NA, Sd = NA, data) level <- polynomial_block(mu = 1, D = 0.95, order = 2) season <- harmonic_block(mu = 1, period = 12, D = 0.975)  outcome <- Normal(   mu = \"mu\", V = 6e-3,   data = c(log(AirPassengers)) ) fitted.model <- fit_model(level, season, outcome) plot(fitted.model, plot.pkg = \"base\")"},{"path":"/articles/outcomes.html","id":"univariated-normal-outcome-with-unknown-variance","dir":"Articles","previous_headings":"Normal case","what":"Univariated Normal outcome with unknown variance","title":"Creation of model outcomes","text":"type outcome, assume : \\[ \\begin{aligned} Y_t|\\mu_t,\\tau_t &\\sim \\mathcal{N}\\left(\\mu_t,\\tau_t^{-1}\\right),\\\\ \\mu_{t}&=\\lambda_{1t},\\\\ \\ln\\{\\tau_{t}\\}&=\\lambda_{2t}.\\\\ \\end{aligned} \\] create outcome model, also make use Normal function: Just , mu argument must character representing label linear predictor associated \\(\\mu_t\\). user must also specify one (one) V, Tau Sd, must character string representing label associated linear predictor. Similar known variance case, allow multiple parametrizations observational variance. Specifically, user provides V, assume \\(\\lambda_{2t}=\\ln\\{\\sigma^2_{t}\\}=-\\ln\\{\\tau_t\\}\\); user provides Sd, assume \\(\\lambda_{2t}=\\ln\\{\\sigma_{t}\\}=-\\ln\\{\\tau_t\\}/2\\); user provides Tau, default parametrization used, .e., \\(\\lambda_{2t}=\\ln\\{\\tau_t\\}\\). data argument usually \\(T \\times 1\\) matrix containing values \\(Y_t\\) observation. cases \\(\\vec{Y}_t\\) univariated, also accept data line vector, case assume coordinate data represents observed value time. value data available (NA) specific time, assumed observation time, thus update step filtering algorithm skipped time. Note evolution step still performed, predictive distribution missing data updated distribution latent states time still provided. Next, present brief example usage outcome. use functions described previous sections, well functions presented later . now, let us focus usage Normal function.  Currently, also support models bivariate Normal outcomes. scenario assume following model: \\[ \\begin{aligned} Y_t|\\mu_{t},V_t &\\sim \\mathcal{N}_2\\left(\\mu_t,V_t\\right),\\\\ \\mu_t&=\\begin{bmatrix}\\mu_{1,t}\\\\ \\mu_{2t}\\end{bmatrix},\\\\ V_t&=\\begin{bmatrix}\\tau_{1,t}^{-1} & (\\tau_{1,t}\\tau_{2,t})^{-1/2}\\rho_t\\\\ (\\tau_{1,t}\\tau_{2,t})^{-1/2}\\rho_t & \\tau_2^{-1}\\end{bmatrix},\\\\ \\mu_{,t}&=\\lambda_{,t}, =1,2\\\\ \\tau_{,t}&=\\ln\\{\\lambda_{(+2),t}\\}, =1,2\\\\ \\rho_{t}&=\\tanh\\{\\lambda_{5,t}\\}.\\\\ \\end{aligned} \\] Notice \\(\\rho_t\\) represents (covariance) series time \\(t\\). guarantee \\(\\rho_t \\(-1,1)\\), use Inverse Fisher transformation (also known hyperbolic tangent function) link function. models, `mu must character vector, similarly case \\(V\\) known, V, Tau Sd must \\(2 \\times 2\\) character matrix. main diagonal elements interpreted linear predictors associated precisions, variances standard deviations, depending user used Tau, V Sd, respectively. diagonal elements must equals (one can NA) interpreted linear predictor associated \\(\\rho_t\\). Bellow present example bivariate case: Notice , second plot, correlation series (represented atanh.rho, .e., plot shows \\(\\tanh^{-1}(\\rho)\\)) significant changes time, making proposed model much adequate two independent Normal models (one outcome).","code":"Normal(mu, V = NA, Tau = NA, Sd = NA, data) structure <- polynomial_block(mu = 1, D = 0.95) +   polynomial_block(V = 1, D = 0.95)  outcome <- Normal(mu = \"mu\", V = \"V\", data = cornWheat$corn.log.return[1:500]) fitted.model <- fit_model(structure, outcome) plot(fitted.model, plot.pkg = \"base\")"},{"path":"/articles/outcomes.html","id":"section","dir":"Articles","previous_headings":"","what":"Creation of model outcomes","title":"Creation of model outcomes","text":"","code":"# Bivariate Normal case structure <- (polynomial_block(mu = 1, D = 0.95) +   polynomial_block(log.V = 1, D = 0.95)) * 2 +   polynomial_block(atanh.rho = 1, D = 0.95)  outcome <- Normal(   mu = c(\"mu.1\", \"mu.2\"),   V = matrix(c(\"log.V.1\", \"atanh.rho\", \"atanh.rho\", \"log.V.2\"), 2, 2),   data = cornWheat[1:500, c(4, 5)] ) fitted.model <- fit_model(structure, outcome)"},{"path":"/articles/outcomes.html","id":"predictions","dir":"Articles","previous_headings":"Normal case > Univariated Normal outcome with unknown variance","what":"Predictions","title":"Creation of model outcomes","text":"","code":"plot(fitted.model, plot.pkg = \"base\")"},{"path":"/articles/outcomes.html","id":"correlation","dir":"Articles","previous_headings":"Normal case > Univariated Normal outcome with unknown variance","what":"Correlation","title":"Creation of model outcomes","text":"","code":"plot(fitted.model, linear.predictors = \"atanh.rho\", plot.pkg = \"base\")"},{"path":"/articles/outcomes.html","id":"poisson-case","dir":"Articles","previous_headings":"","what":"Poisson case","title":"Creation of model outcomes","text":"case, assume following observational model: \\[ \\begin{equation}\\begin{aligned} Y_t|\\eta_t &\\sim Poisson\\left(\\eta_t\\right),\\\\ \\ln(\\eta_t) &=\\lambda_{t}. \\end{aligned}\\end{equation} \\] notation introduced , link function \\(g\\) (natural) logarithm function. define observational model, offer Poisson function, whose usage presented bellow: usual literature, refer rate parameter Poisson distribution lambda (although, context document, might seem confusing) user must provide argument name linear predictor associated parameter. argument data user must provide sequence numerical values consisting observed values \\(Y_t\\) time. Since \\(Y_t\\) scalar \\(t\\), user can pass outcome vector matrix single column. value data available (NA) specific time, assumed observation time, thus update step filtering algorithm skipped time. Note evolution step still performed, predictive distribution missing data updated distribution latent states time still provided. Lastly, offset argument optional can used provide measure scale data. offset provided equal \\(E_t\\), fit model assuming : \\[ \\begin{equation}\\begin{aligned} Y_t|\\theta_t &\\sim Poisson\\left(\\eta_tE_t\\right),\\\\ \\ln(\\eta_t) &=\\lambda_{t}. \\end{aligned}\\end{equation} \\] Bellow present example usage outcome. use functions described previous section, well functions present later , now, let us focus usage Poisson function.  Notice , creating structure, defined linear predictor named rate, whose behavior explained second order polynomial trend seasonal component defined second order harmonic block. Since value passed rate equals \\(1\\) blocks, components constant effect (equal \\(1\\)) linear predictor times, although components change values time capture behavior series. Later , creating outcome, pass name 'rate' linear predictor associated lambda, rate (mean) parameter Poisson distribution. particularly simply usage package, Poisson kernel one smallest amount parameters. Moving forward, present outcomes whose specification can bit complex.","code":"Poisson(lambda, data, offset = data^0) data <- c(AirPassengers)  level <- polynomial_block(rate = 1, order = 2, D = 0.95) season <- harmonic_block(rate = 1, period = 12, order = 2, D = 0.975)  outcome <- Poisson(lambda = \"rate\", data = data)  fitted.data <- fit_model(level, season,   AirPassengers = outcome ) plot(fitted.data, plot.pkg = \"base\")"},{"path":"/articles/outcomes.html","id":"gamma-case","dir":"Articles","previous_headings":"","what":"Gamma case","title":"Creation of model outcomes","text":"subsection present Gamma case, assume following observational model: \\[ \\begin{equation}\\begin{aligned} Y_t|\\alpha_t,\\beta_t &\\sim \\mathcal{G}\\left(\\alpha_t,\\beta_t\\right),\\\\ \\ln\\{\\alpha_t\\}&=\\lambda_{1t},\\\\ \\ln\\{\\beta_t\\}&=\\lambda_{2t} \\end{aligned}\\end{equation} \\] outcome variations. First, ’s matter parametrization. allow user define model non redundant pair : \\[ \\begin{equation}\\begin{aligned} \\alpha_t&,\\\\ \\beta_t&,\\\\ \\phi_t&=\\alpha_t,\\\\ \\mu_t&=\\frac{\\alpha_t}{\\beta_t},\\\\ \\sigma_t&=\\frac{1}{\\beta_t}. \\end{aligned}\\end{equation} \\] Naturally, user specify \\(\\alpha_t\\) \\(\\phi_t\\) \\(\\beta_t\\) \\(\\sigma_t\\), specification redundant best, incoherent worst. Outside cases, package raise error, combination can used user, allowing structure model defined within variables convenient (may easier intuitive specify structure mean \\(\\mu_t\\) scale \\(\\sigma_t\\), shape \\(\\alpha_t\\) rate \\(\\beta_t\\)). Another particularity Gamma outcome user may set shape parameter \\(\\phi_t\\) known constant. case, user must specify structure mean parameter \\(\\mu_t\\) (allowed specify neither \\(\\beta_t\\) \\(\\sigma_t\\)). general, expect shape parameter known, still, important applications common use particular cases Gamma distribution, Exponential Model (\\(\\phi_t=1\\)) \\(\\chi^2\\) model (\\(\\phi_t=0.5\\)). estimation shape parameter \\(\\phi_t\\) still development, , current version package support unknown \\(\\phi_t\\) (version package proper estimation \\(\\phi_t\\) released soon). matter parametrization, link function \\(g\\) always logarithm function, , given certain parametrization, can write linear predictor parametrization linear transformation original. examples section, always use parameters \\(\\phi_t\\) (applicable) \\(\\mu_t\\), code used can trivially adapted parametrizations. Similar Poisson case, argument data must provide set numerical values consisting observed values \\(Y_t\\) time. Since \\(Y_t\\) scalar \\(t\\), user can pass outcome either vector matrix single column. value argument data available (NA) specific time, assumed observation time, thus update step filtering algorithm skipped time. Note evolution step still performed, predictive distribution missing data updated distribution latent states time still provided. offset argument optional can used provide measure scale data. offset provided equal \\(E_t\\), fit model assuming : \\[ \\begin{equation}\\begin{aligned} Y_t|\\theta_t &\\sim \\mathcal{G}\\left(\\alpha_t,\\beta_t E_t^{-1}\\right). \\end{aligned}\\end{equation} \\] Note model implies : \\[ \\mathbb{E}[Y_t|\\theta_t]=\\frac{\\alpha_t}{\\beta_t}E_t. \\] arguments phi, mu, alpha, beta sigma character strings indicating name linear predictor associated respective linear predictor. user may opt pass phi positive numerical value, case, shape parameter \\(\\phi_t\\) considered known equal phi \\(t\\).","code":"Gamma(phi = NA, mu = NA, alpha = NA, beta = NA, sigma = NA, data = , offset = data^0) structure <- polynomial_block(mu = 1, D = 0.95)  outcome <- Gamma(phi = 0.5, mu = \"mu\", data = cornWheat$corn.log.return[1:500]**2) fitted.data <- fit_model(structure, outcome) plot(fitted.data, plot.pkg = \"base\")"},{"path":"/articles/outcomes.html","id":"multinomial-case","dir":"Articles","previous_headings":"","what":"Multinomial case","title":"Creation of model outcomes","text":"Let us assume sequence \\(k\\)-dimensional non-negative integer vectors \\(Y_t\\), \\(Y_t=(Y_{1t},...,Y_{kt})'\\) : \\[ \\begin{equation}\\begin{aligned} Y_t|N_t,\\vec{p}_t &\\sim Multinom\\left(N_t,\\vec{p}_t\\right),\\\\ \\ln\\left\\{\\frac{p_{}}{p_{kt}}\\right\\}&=\\lambda_{}, =1,...,k-1,\\\\ N_t&=\\sum_{=1}^{k}Y_{}, \\end{aligned}\\end{equation} \\] \\(\\vec{p}_t=(p_{1t},...,p_{kt})'\\), \\(p_{} > 0, \\forall \\) \\(\\sum_{=1}^k p_{}=1\\). Notice \\(N_t\\) automatically defined values \\(Y_t\\), \\(N_t\\) always considered known parameter. Also, important point model \\(k-1\\) free parameters (instead \\(k\\)), since restriction \\(\\sum_{=1}^k p_{}=1\\) implies defining \\(k-1\\) entries \\(\\vec{p}_t\\) defines remaining value. Specifically, always take last entry (category) \\(Y_t\\) reference value, \\(p_{kt}\\) can considered baseline probability observing data category (.e., model \\(p_{}\\) relates baseline probability \\(p_{kt}\\)). create outcome model, can make use Multinom function: Multinomial case, p must character vector size \\(k-1\\) containing names linear predictors associated \\(\\ln\\left\\{\\frac{p_{}}{p_{kt}}\\right\\}\\) \\(=1,...,k-1\\). data argument must \\(T \\times k\\) matrix containing values \\(Y_t\\) observation. Notice line \\(\\) must represent values categories time \\(\\) column \\(j\\) must represent values category \\(j\\) time. value argument data available (NA) specific time, assumed observation time, thus update step filtering algorithm skipped time. Note evolution step still performed, predictive distribution missing data updated distribution latent states time still provided. offset argument optional must dimensions data (dimensions interpreted manner). argument can used provide measure scale data , offset provided, , time \\(t\\), offset equal \\(E_t=(E_{1t},...,E_{kt})'\\), fit model assuming : \\[ \\begin{equation}\\begin{aligned} Y_t|\\theta_t &\\sim Multinom\\left(N_t,\\vec{p}^*_t\\right),\\\\ \\ln\\left\\{\\frac{p^*_{}}{p^*_{kt}}\\right\\}&=\\ln\\left\\{\\frac{p_{}}{p_{kt}}\\right\\}+\\ln\\left\\{\\frac{E_{}}{E_{kt}}\\right\\}, =1,...,k-1. \\end{aligned}\\end{equation} \\] end subsection present brief discussion implications inclusion offset interpret , well explanation way chose include . , present brief example usage outcome:","code":"Multinom(p, data, offset = data^0) # Multinomial case structure <- (   polynomial_block(p = 1, order = 2, D = 0.95) +     harmonic_block(p = 1, period = 12, D = 0.975) +     noise_block(p = 1, R1 = 0.1) +     regression_block(p = chickenPox$date >= as.Date(\"2013-09-01\"))   # Vaccine was introduced in September of 2013 ) * 4  outcome <- Multinom(p = structure$pred.names, data = chickenPox[, c(2, 3, 4, 6, 5)]) fitted.data <- fit_model(structure, chickenPox = outcome) summary(fitted.data) plot(fitted.data, plot.pkg = \"base\")"},{"path":"/articles/outcomes.html","id":"some-comments-on-the-usage-of-an-offset","dir":"Articles","previous_headings":"Multinomial case","what":"Some comments on the usage of an offset","title":"Creation of model outcomes","text":"model presented section intend describe phenomena \\(N_t\\) subjects distributed randomly (necessarily uniformly randomly) among \\(k\\) categories. scenario, \\(p_{}\\) represent probability one observation fall within category \\(\\), : \\[ p_{}=\\mathbb{P}(Y_{}=1|N_t=1). \\] applications, might case \\(N_t\\) represents counting event interest want model probability event occurring category. scenario, clear use multinomial model, since : \\[ p_{}=\\mathbb{P}(\\text{Observation belong category }|\\text{Event occured}), \\] actually want known: \\[ p^*_{}=\\mathbb{P}(\\text{Event occured}|\\text{Observation belong category }). \\] Notice can write: \\[ \\begin{aligned} p^*_{}&=\\mathbb{P}(\\text{Event occured}|\\text{Observation belong category })\\\\ &=\\frac{\\mathbb{P}(\\text{Observation belong category }|\\text{Event occured})\\mathbb{P}(\\text{Event occured})}{\\mathbb{P}(\\text{Observation belong category })}\\\\ &=\\frac{p_{}\\mathbb{P}(\\text{Event occured})}{\\mathbb{P}(\\text{Observation belong category })}. \\end{aligned} \\] relation implies : \\[ \\begin{aligned} \\ln\\left\\{\\frac{p^*_{}}{p^*_{kt}}\\right\\} &=\\ln\\left\\{\\frac{p_{}}{p_{kt}}\\right\\}-\\ln\\left\\{\\frac{\\mathbb{P}(\\text{Observation belong category })}{\\mathbb{P}(\\text{Observation belong category }k)}\\right\\}. \\end{aligned} \\] pass offset argument Multinom function set values \\(E_t\\), \\(E_{t} \\propto (\\mathbb{P}(\\text{Observation belong category }1),...,\\mathbb{P}(\\text{Observation belong category }k))'\\), , specification provided section, : \\[ \\ln\\left\\{\\frac{p^*_{}}{p^*_{kt}}\\right\\}=\\lambda_{}, \\] words, linear predictors (consequently, model structure) describe probability event occurs specific class (instead probability observation belongs class, given occurrence event). obtain \\(p^*_{}\\) (.e. probability event occurring given observation belongs category \\(\\)), one can use Bayes formula, long \\(\\mathbb{P}(\\text{Event occured})\\) known. Indeed, one can write: \\[ \\begin{aligned} p^*_{}&=p_{}\\frac{\\mathbb{P}(\\text{Event occured})}{\\mathbb{P}(\\text{Observation belong category })}\\\\         &=\\frac{\\exp\\{\\lambda_i\\}}{1+\\sum_j \\exp\\{\\lambda_j\\}}\\frac{\\mathbb{P}(\\text{Event occured})}{\\mathbb{P}(\\text{Observation belong category })} \\end{aligned} \\]","code":""},{"path":"/articles/outcomes.html","id":"handling-multiple-outcomes","dir":"Articles","previous_headings":"","what":"Handling multiple outcomes","title":"Creation of model outcomes","text":"Lastly, kDGLM package also allows user jointly fit multiple time series, long marginal distribution series one supported distributions series independent given latent state vector \\(\\vec{\\theta}_t\\). words, let \\(\\{\\vec{Y}_{,t}\\}_{t=1}^{T}, =1,...,r\\), set time series : \\[ \\begin{aligned} \\vec{Y}_{,t}|\\vec{\\eta}_{,t} &\\sim \\mathcal{F}_{}\\left(\\vec{\\eta}_{,t}\\right),\\\\ g_i(\\vec{\\eta}_{,t})&=\\vec{\\lambda}_{,t}=F_{,t}'\\vec{\\theta}_{t}, \\end{aligned} \\] \\(\\vec{Y}_{1,t}, ...,\\vec{Y}_{r,t}\\) mutually independent given \\(\\vec{\\eta}_{1,t}, ...,\\vec{\\eta}_{r,t}\\). Note observational distributions \\(\\mathcal{F}_i\\) need outcome, long \\(\\mathcal{F}_i\\) within supported marginal distributions. example, three time series (\\(r=3\\)), \\(\\mathcal{F}_1\\) Poisson distribution, \\(\\mathcal{F}_2\\) Normal distribution unknown mean precision \\(\\mathcal{F}_3\\) Gamma distribution known shape. Also, specification impose restriction model structure, outcome can component, polynomial, regression harmonic blocks, besides shared components . See (dos Santos et al., 2024) detailed discussion approach used model multiple time series using kDGLMs. fit model, one must pass outcomes fit_model function. example, present code fitting two Poisson series: important note Multivariate Normal Multinomial cases multivariated outcomes considered multiple outcomes , instead, treated one outcome , outcome vector (note made restrictions dimension \\(\\vec{Y}_{,t}\\)). , cases, components vector \\(\\vec{Y}_{,t}\\) mutually independent given \\(\\vec{\\eta}_{,t}\\). Also important note general approach modeling multiple time series can , , considered generalization Multivariate Normal Multinomial models. Specifically, treat coordinate outcome outcome , satisfy hypotheses independence given latent states \\(\\vec{\\theta}_t\\). can compensated changes model structure, , general, better model data using known joint distribution assume conditional independence model outcomes dependence shared structure.","code":"structure <- polynomial_block(mu.1 = 1, mu.2 = 1, order = 2, D = 0.95) + # Common factor   harmonic_block(mu.2 = 1, period = 12, order = 2, D = 0.975) + # Seasonality for Series 2   polynomial_block(mu.2 = 1, order = 1, D = 0.95) + # Local level for Series 2   noise_block(mu = 1) * 2 # Overdispersion for both Series  fitted.model <- fit_model(structure,   Adults = Poisson(lambda = \"mu.1\", data = chickenPox[, 5]),   Infants = Poisson(lambda = \"mu.2\", data = chickenPox[, 2]) )  plot(fitted.model)"},{"path":"/articles/outcomes.html","id":"special-case-conditional-modelling","dir":"Articles","previous_headings":"Handling multiple outcomes","what":"Special case: Conditional modelling","title":"Creation of model outcomes","text":"special type specification model multiple outcomes require outcomes independent given latent states. Indeed, user specifies conditional distribution outcome given previous ones, hypotheses needed fitting data. instance, lets say three time series \\(Y_{1,t},Y_{2,t}\\) \\(Y_{3,t}\\), series follows Poisson distribution parameter \\(\\eta_{,t}, =1,2,3\\). , \\(Z_t=Y_{1,t}+Y_{2,t}+Y_{3,t}\\) follows Poisson distribution parameter \\(\\eta_{1,t}+\\eta_{2,t}+\\eta_{3,t}\\) \\(Y_{1,t},Y_{2,t},Y_{3,t}|Z_t\\) jointly follows Multinomial distribution parameters \\(N_t=Z_t\\) \\(\\vec{p}_t=\\left(\\frac{\\eta_{1,t}}{\\eta_{1,t}+\\eta_{2,t}+\\eta_{3,t}},\\frac{\\eta_{2,t}}{\\eta_{1,t}+\\eta_{2,t}+\\eta_{3,t}},\\frac{\\eta_{3,t}}{\\eta_{1,t}+\\eta_{2,t}+\\eta_{3,t}}\\right)'\\). user may model \\(Z_t\\) \\(Y_{1,t},Y_{2,t},Y_{3,t}|Z_t\\):  See Schmidt et al. (2022) discussion Multinomial-Poisson models. applications presented advanced examples section vignette.","code":"structure <- polynomial_block(mu = 1, order = 2, D = 0.95) +   harmonic_block(mu = 1, period = 12, order = 2, D = 0.975) +   noise_block(mu = 1) + polynomial_block(p = 1, D = 0.95) * 2  outcome1 <- Poisson(lambda = \"mu\", data = rowSums(chickenPox[, c(2, 3, 5)])) outcome2 <- Multinom(p = c(\"p.1\", \"p.2\"), data = chickenPox[, c(2, 3, 5)])  fitted.model <- fit_model(structure, Total = outcome1, Proportions = outcome2)  plot(fitted.model, plot.pkg = \"base\")"},{"path":[]},{"path":"/articles/structures.html","id":"table-of-contents","dir":"Articles","previous_headings":"","what":"Table of contents","title":"Creation of model structures","text":"Introduction Notation structure polynomial trend models structure dynamic regression models structure harmonic trend models structure autoregresive models structure overdispersed models Handling multiple structural blocks Handling multiple linear predictors Handling unknown components planning matrix \\(F_t\\) Special priors Normal case Poisson case Gamma case Multinomial case Handling multiple outcomes Filtering smoothing Extracting components Forecasting Intervention monitoring Tools sensibility analysis Sampling hyper parameter estimation Space-time model hospital admissions gastroenteritis","code":""},{"path":"/articles/structures.html","id":"creation-of-model-structures","dir":"Articles","previous_headings":"","what":"Creation of model structures","title":"Creation of model structures","text":"section discuss specification model structure. consider structure model elements determine relation linear predictor \\(\\vec{\\lambda}_t\\) latent states \\(\\vec{\\theta}_t\\) though time. Thus, present section dedicated definition following, highlighted equations general dynamic generalized model: \\[ \\require{color} \\begin{equation} \\begin{aligned} Y_t|\\eta_t &\\sim \\mathcal{F}\\left(\\eta_t\\right),\\\\ g(\\eta_t) &= {\\color{red}\\lambda_{t}=F_t'\\theta_t,}\\\\ {\\color{red}\\theta_t }&{\\color{red}=G_t\\theta_{t-1}+\\omega_t,}\\\\ {\\color{red}\\omega_t }&{\\color{red}\\sim \\mathcal{N}_n(h_t,W_t)}. \\end{aligned} \\end{equation} \\] Namely, consider structure model consists matrices/vectors \\(F_t\\), \\(G_t\\), \\(\\vec{h}_t\\), \\(H_t\\) \\(D_t\\). Although allow user manually define entry matrices (recommend), also offer tools simplify task. Currently, offer support following base structures: polynomial_block: Structural block polynomial trends (see West Harrison, 1997, Chapter 7). special cases, block support random walks linear growth models. harmonic_block: Structural block seasonal trends using harmonics (see West Harrison, 1997, Chapter 8). regression_block: Structural block (dynamic) regressions (see West Harrison, 1997, Chapter 6 9). TF_block: Structural block autoregressive components transfer functions (see West Harrison, 1997, Chapter 9 13). noise_block: Structural block random effects dos Santos et al. (2024). sake brevity, present details polynomial_block, since functions similar usage (full description block can found vignette, reference manual respective help pages). Along aforementioned functions, also present auxiliary functions operations help user manipulate created structural blocks. Subsections structure polynomial trend models, structure dynamic regression models, structure harmonic trend models, structure autoregresive models structure overdispersed models introduce several functions design facilitate creation single structural blocks. sections begin examining simplistic models, characterized single structural block one linear predictor, completely known \\(F_t\\) matrix. Subsection Handling multiple structural blocks builds upon concepts, exploring models incorporate multiple structural blocks maintaining singular linear predictor. focus shifts Subsection Handling multiple linear predictors, delve specification multiple linear predictors within model. Section Handling unknown components planning matrix \\(F_t\\), discussion turns scenarios \\(F_t\\) includes one unknown components. Finally, Subsection Special priors provides brief examination functions used define specialized priors.","code":""},{"path":"/articles/structures.html","id":"a-structure-for-polynomial-trend-models","dir":"Articles","previous_headings":"","what":"A structure for polynomial trend models","title":"Creation of model structures","text":"Recall notation introduced Section Notation revisited beginning vignette. polynomial_block function create structural block based West Harrison (1997), chapter 7. involves creation latent vector \\(\\vec{\\theta}_t=(\\theta_{1,t},...,\\theta_{n,t})'\\), : \\[\\begin{equation} \\begin{aligned} \\theta_{,t} &= \\theta_{,t-1}+\\theta_{+1, t-1}+\\omega_{,t}, =1,...,n-1\\\\ \\theta_{n,t} &= \\theta_{n,t-1}+\\omega_{n,t},\\\\ \\theta_1&\\sim \\mathcal{N}_k(a_1,R_1),\\\\ \\omega_{1,t},...,\\omega_{n,t}&\\sim \\mathcal{N}_n(\\vec{h}_t,W_t), \\end{aligned} \\label{eq:defpol} \\end{equation}\\] \\(W_t=Var[\\theta_t|\\mathcal{D}_{t-1}]\\odot (1-D_t) \\oslash D_t+H_t\\). Let’s dissect component specification. order argument sets polynomial block’s order, correlating \\(n\\) value passed. optional name argument aids identifying structural block post-fitting analysis, plotting result examination (see Section Fitting analysing models). D, h, H, a1, R1 arguments correspond \\(D_t\\), \\(\\vec{h}_t\\), \\(H_t\\), \\(\\vec{}_1\\) \\(R_1\\), respectively. D specifies discount matrices time. format varies: scalar implies constant discount factor; vector size \\(T\\) (length time series) means varying discount factors time; \\(n\\times n\\) matrix indicates discount matrix given D times; 3D-array dimension \\(n\\times n\\times T\\) indicates time-specific discount matrices. shape D considered invalid. h specifies drift vector time. h scalar, understood drift variables time. h vector size \\(T\\), understood drift variables, different values time, coordinate \\(t\\) h represents drift time \\(t\\). h \\(n \\times T\\) matrix, assume drift vector time \\(t\\) given h[,t]. shape h considered invalid. argument H follows syntax D, since matrix \\(H_t\\) shape \\(D_t\\). argument a1 R1 used define, respectively mean covariance matrix prior \\(\\theta_1\\). a1 scalar, understood latent states associated block prior mean; a1 vector size \\(n\\), understood prior mean \\(a_1\\) given a1. R1 scalar, understood latent states independent priors variance (imply independent posteriors); R1 vector size \\(n\\), understood latent states independent priors prior variance \\(\\theta_{,1}\\) given R1[]; R1 \\(n \\times n\\) matrix, understood \\(R_1\\) given R1. shape a1 R1 considered invalid. arguments D, h, H, a1, R1 can accept character values, indicating certain parameters fully defined. cases, dimensions arguments interpreted manner numerical counterparts. instance, D single character, implies uniform, yet unspecified, discount factor across variables time points, D serving placeholder label. D vector length \\(T\\) (time series length), suggests varying discount factors time, character entry vector (e.g., D[]) acting label discount factor respective time point. logic extends arguments various dimensional forms. ’s crucial recognize arguments specified labels rather explicit values, corresponding model block treated “undefined,” indicating absence key hyperparameter. Consequently, model undefined block fitted. Users must either employ specify.dlm_block method replace labels concrete values pass value value hyper-parameter named values fit_model function systematically evaluate models different values labels. Section Tools sensitivity analysis elaborates available tools sensitivity analysis. information specify fit_model available reference manual help function. Notice user need specify matrix \\(G_t\\), since implicitly determined equation \\(\\eqref{eq:defpol}\\) order polynomial block. type block define matrix \\(G_t\\), , user need worry \\(G_t\\), except specific circumstances, advanced user may need type model yet implemented. argument ... used specify matrix \\(F_t\\) (see details Subsection Handling multiple linear predictors). Specifically, user must provide list named values arbitrary labels linear predictor \\(\\lambda_{,t}\\) , \\(=1,\\ldots,k\\), associated value represents effect level \\(\\theta_{1,t}\\) (see Eq. \\(\\eqref{eq:defpol}\\)) predictor. example, consider polynomial block order \\(2\\), representing linear growth. user passes extra argument lambda (naming arbitrary) \\(1\\), matrix \\(F_t\\) created : \\[ F_t=\\begin{bmatrix}1\\\\0\\end{bmatrix} \\] Note , polynomial block order \\(2\\), \\(2\\) latent states, \\(\\theta_{1,t}\\) \\(\\theta_{2,t}\\). \\(\\theta_{2,t}\\) affect linear predictor lambda directly, serves auxiliary variable induce complex dynamic \\(\\theta_{1,t}\\). Indeed, Equation \\(\\eqref{eq:defpol}\\), second order polynomial block following temporal evolution: \\[ \\begin{aligned} \\theta_{1,t} &= \\theta_{1,t-1}+\\theta_{2, t-1}+\\omega_{1,t}\\\\ \\theta_{2,t} &= \\theta_{2,t-1}+\\omega_{2,t},\\\\ \\omega_{1,t},\\omega_{2,t}&\\sim \\mathcal{N}_2(\\vec{h}_t,W_t). \\end{aligned} \\] , \\(\\theta_{2,t}\\) represents growth factor added \\(\\theta_{1,t}\\) smoothly changes overtime. Even complex structures can defined, either higher order polynomial block one several types block offered kDGLM. specification values associated predictor label illustrated examples exhibited section. Lastly, argument monitoring shall explained later, Subsection Intervention monitoring, discusses automated monitoring interventions. exemplify usage function, let us assume simple Normal model known variance \\(\\sigma^2\\), \\(\\eta\\) mean parameter link function \\(g\\) \\(g(\\eta)=\\eta\\). Let us also assume mean constant time explanatory variables, model can simply written : \\[ \\begin{aligned} Y_t|\\theta_t &\\sim \\mathcal{N}_1\\left(\\eta_t, \\sigma^2\\right),\\\\ \\eta_t &={\\color{red}\\lambda_{t}=\\theta_t,}\\\\ {\\color{red}\\theta_t} &{\\color{red}=\\theta_{t-1}=\\theta.} \\end{aligned} \\] case, \\(F_t=1\\), \\(G_t=1\\), \\(D_t=1\\), \\(h_t=0\\) \\(H_t=0\\), \\(t\\). Assuming prior distribution \\(\\mathcal{N}(0,9)\\) \\(\\theta\\), can create highlighted structure using following code: Setting eta=1, specify linear predictor named eta, \\(eta = 1 \\times \\theta\\). Setting order = 1, specify \\(\\theta_t\\) scalar \\(G_t=1\\). can omit values a1 , R1, D, h H, since default values reflect specified model. also omit argument order, since default \\(1\\), chose explicit define emphasize usage. argument name specifies label created block; case, chose call “Mean”, help identify role model. Suppose now explanatory variable \\(X\\) like introduce model help explain behavior \\(\\eta_t\\). similarly define structure creating additional block : setting eta=X, specify linear predictor called eta, \\(eta = X \\times \\theta\\). \\(X=(X_1,...,X_T)'\\) vector, \\(F_t=X_t\\), \\(t\\), \\(eta_t = X_t \\times \\theta\\). noted kDGLM specific structural block designed regressions, regression_block, also allow structural block used regression, just setting value assigned predictor equal regressor vector \\(X_t, t=1, \\ldots, X_T\\). user can specify complex temporal dynamics effects co-variate. instance, assumed regressor seasonal effect linear predictor. accommodated insertion values regressor associated seasonal block. use seasonal blocks illustrated Section Space-time model hospital admissions gastroenteritis. far, discussed creation static latent effects, inclusion stochastic temporal dynamics straightforward. One must simply specify values H greater \\(0\\) /values D lesser \\(1\\): Notice dynamic regression model obtained assigning eta=X previous code line. Bellow present plot two simple trend models fitted data: one static mean another using dynamic mean. following example use functions Normal, fit_model plot method. advise reader initially concentrate solely application polynomial_block. functionalities detailed usage functions methods, Normal, fit_model, plot, explored later sections, specifically Sections Creating model outcome: Fitting analysing models:. inclusion functions current example primarily offer comprehensive operational code sample.  extensive presentation thorough discussion theoretical aspects underlying structure highlighted section, interested readers encouraged consult West Harrison (1997), Chapters 6, 7, 9. Additionally, strongly recommend users refer associated documentation detailed information. can accessed using help(polynomial_block) function consulting reference manual.","code":"polynomial_block(...,   order = 1, name = \"Var.Poly\",   D = 1, h = 0, H = 0,   a1 = 0, R1 = c(9, rep(1, order - 1)),   monitoring = c(TRUE, rep(FALSE, order - 1)) ) mean_block <- polynomial_block(eta = 1, order = 1, name = \"Mean\") polynomial_block(eta = X, name = \"Var X\") mean_block <- polynomial_block(eta = 1, order = 1, name = \"Mean\", D = 0.95)"},{"path":"/articles/structures.html","id":"a-structure-for-dynamic-regression-models","dir":"Articles","previous_headings":"","what":"A structure for dynamic regression models","title":"Creation of model structures","text":"regression_block function creates structural block dynamic regression covariate \\(X_t\\), specified West Harrison (1997), chapter 9. max.lag equal \\(0\\), function can see wrapper polynomial_block function order equal \\(1\\). max.lag greater equal \\(1\\), regression_block function equivalent superposition several polynomial_block functions order equal \\(1\\). Specifically, linear predictor \\(\\lambda_t\\) associated block, can describe structure following equations: \\[ \\begin{equation} \\begin{aligned} \\lambda_t&=\\sum_{=0}^{max.lag}X_{t-}\\theta_{,t},\\\\ \\theta_{,t}&=\\theta_{,t-1}+\\omega_{,t},\\quad \\forall ,\\\\ \\omega_{0,t},...,\\omega_{max.lag,t}&\\sim \\mathcal{N}_{max.lag+1}(0,W_t),\\\\ \\theta_{0,1},..., \\theta_{max.lag,1}&\\sim \\mathcal{N}_{max.lag+1}(a_1,R_1), \\end{aligned} \\end{equation} \\] \\(W_t=Var[\\theta_t|\\mathcal{D}_{t-1}]\\odot (1-D_t) \\oslash D_t+H_t\\). usage regression_block function quite similar polynomial_block function, differences max.lag zero.fill arguments. max.lag defines maximum lag variable \\(X_t\\) effect linear predictor. example, define max.lag \\(3\\), defining \\(X_t\\), \\(X_{t-1}\\), \\(X_{t-2}\\) \\(X_{t-3}\\) effect \\(\\lambda_t\\), \\(max.lag+1\\) latent variables created, one representing effect lagged value \\(X_t\\). Lastly, zero.fill argument defines package take value \\(X_t\\) \\(0\\) \\(t\\) non-positive, .e., TRUE (default), package considers \\(X_t=0\\), \\(t=0,-1,...,-max.lag+1\\). zero.fill FALSE, user must provide values \\(X_t\\) vector size \\(T+max.lag\\) (instead \\(T\\)), \\(T\\) length time series modeled, first \\(max.lag\\) values vector taken \\(X_{-max.lag+1},...,X_0\\). usage remaining arguments identical polynomial_block function, can also inferred previous equation. present code fitting following model: \\[ \\begin{equation} \\begin{aligned} Y_t|\\theta_t &\\sim Poisson\\left(\\eta_t\\right),\\\\ \\ln(\\eta_t) &=\\lambda_{t}=X_t\\theta_t,\\\\ \\theta_t&=\\theta_{t-1}+\\omega_t,\\\\ \\omega_t &\\sim \\mathcal{N}_1(0,W_t), \\end{aligned} \\end{equation} \\] \\(X_t\\) known covariate \\(W_t\\) specified using discount factor \\(0.95\\).  detailed theory behind structure discussed section can found chapters 6 9 West Harrison (1997).","code":"regression_block(...,   max.lag = 0,   zero.fill = TRUE,   name = \"Var.Reg\",   D = 1,   h = 0,   H = 0,   a1 = 0,   R1 = 9,   monitoring = rep(FALSE, max.lag + 1) ) regression <- regression_block(The_name_of_the_linear_predictor = X, D = 0.95)  outcome <- Poisson(lambda = \"The_name_of_the_linear_predictor\", data = data)  fitted.data <- fit_model(regression, outcome)"},{"path":"/articles/structures.html","id":"a-structure-for-harmonic-trend-models","dir":"Articles","previous_headings":"","what":"A structure for harmonic trend models","title":"Creation of model structures","text":"function creates structural block based West Harrison (1997), chapter 8, .e., creates latent vector \\(\\theta_t=(\\theta_{1,t},\\theta_{2,t},...,\\theta_{2\\times order-1,t},\\theta_{2\\times order,t})'\\), : \\[ \\begin{equation} \\begin{aligned} \\begin{bmatrix}\\theta_{2i -1,t}\\\\ \\theta_{2i,t}\\end{bmatrix} = \\begin{bmatrix}cos(iw) & sin(iw)\\\\ -sin(iw) & cos(iw)\\end{bmatrix}&\\begin{bmatrix}\\theta_{2i -1,t-1}\\\\ \\theta_{2i,t-1}\\end{bmatrix}+\\begin{bmatrix}\\omega_{2i -1,t}\\\\ \\omega_{2i,t}\\end{bmatrix}, =1,...,order\\\\ \\theta_{1,1},...,\\theta_{2 \\times order,1}&\\sim \\mathcal{N}_{2\\times order}(a_1,R_1),\\\\ \\omega_{1,t},...,\\omega_{2 \\times order,t}&\\sim \\mathcal{N}_{2\\times order}(0,W_t),\\\\ \\end{aligned} \\end{equation} \\] \\(W_t=Var[\\theta_t|\\mathcal{D}_{t-1}]\\odot (1-D_t) \\oslash D_t+H_t\\) \\(w=\\frac{2\\pi}{period}\\). Notice user need specify matrix \\(G_t\\), since implicitly determined order period harmonic block, block diagonal matrix block rotation matrix angle multiple \\(w\\), , period integer, \\(G_t^{period}=\\). Notice , period integer, represents length seasonal cycle. instance, time series monthly observations believe series annual pattern, set period harmonic block equal \\(12\\) (number observations cycle “resets”). details order harmonic block representation seasonal patterns Fourier Series, see West Harrison (1997), chapter 8. natural usage block specifying harmonic trends model, can also used explanatory variables seasonal effect linear predictor, , see usage regression_block polynomial_block functions. present simply usage example harmonic block period \\(12\\): Bellow present plot Poisson model structure:  detailed theory behind structure discussed section can found chapters 6, 8 9 West Harrison (1997).","code":"harmonic_block(   ...,   period,   order = 1,   name = \"Var.Sazo\",   D = 1,   h = 0,   H = 0,   a1 = 0,   R1 = 4,   monitoring = rep(FALSE, order * 2) ) mean_block <- harmonic_block(   eta = 1,   period = 12,   D = 0.975 )"},{"path":"/articles/structures.html","id":"a-structure-for-autoregresive-models","dir":"Articles","previous_headings":"","what":"A structure for autoregresive models","title":"Creation of model structures","text":"function creates structural block based West Harrison (1997), chapter 9, .e., creates latent state vector \\(\\theta_t\\), autoregressive (AR) coefficient vector \\(\\phi_t=(\\phi_{1,t},...,\\phi_{order, t})'\\) pulse coefficient vector \\(\\rho_t=(\\rho_{1,t},...,\\rho_{l,t})'\\), \\(l\\) number pulses (discussed later ) : \\[ \\begin{equation} \\begin{aligned} \\theta_{t} &= \\sum_{=1}^{k}\\phi_{,t}\\theta_{t-}+\\sum_{=1}^{l}\\rho_{,t}X_{,t}+\\omega_{t},\\\\ \\phi_{,t}&=\\phi_{,t-1}+\\omega^{\\text{coef}}_{,t},\\\\ \\rho_{,t}&=\\rho_{,t-1}+\\omega_{,t}^{pulse},\\\\ \\omega_{t}&\\sim \\mathcal{N}_1(h_t,W_t),\\\\ \\omega_{t}^{\\text{coef}}&\\sim \\mathcal{N}_k(h_t^{\\text{coef}},W_t^{\\text{coef}}),\\\\ \\omega_{t}^{pulse}&\\sim \\mathcal{N}_l(h_t^{pulse},W_t^{pulse}),\\\\ \\theta_1&\\sim \\mathcal{N}(a_1,R_1),\\\\ \\phi_1&\\sim \\mathcal{N}_k(a_1^{\\text{coef}},R_1^{\\text{coef}}),\\\\ \\rho_1&\\sim \\mathcal{N}_l(a_1^{pulse},R_1^{pulse}). \\end{aligned} \\end{equation} \\] : \\[ \\begin{equation} \\begin{aligned} W_t&=noise.var&+&\\frac{(1-noise.disc)}{noise.disc}Var[\\theta_t|\\mathcal{D}_{t-1}] & &  & & ,\\\\ W_t^{\\text{coef}}&=H_t^{\\text{coef}}&+&Var[\\phi_t|\\mathcal{D}_{t-1}] &\\odot& (1-D_t^{\\text{coef}}) &\\oslash& D_t^{\\text{coef}},\\\\ W^{pulse}_t&=H_t^{pulse}&+&Var[\\rho_t|\\mathcal{D}_{t-1}] &\\odot&(1-D_t^{pulse}) &\\oslash&D_t^{pulse}, \\end{aligned} \\end{equation} \\] \\(X\\), called pulse matrix, known \\(T \\times l\\) matrix. Notice user need specify matrix \\(G_t\\), since implicitly determined order Tranfer Function (TF) block equations , although, reader might noticed, evolution always non-linear. Since method used fit models package requires linear evolution, use approach described West Harrison (1997), chapter 13, linearize previous evolution equation. details usage autoregressive models transfer functions context DLM’s, see West Harrison (1997), chapter 9. easy understand meaning arguments TF_block function based previous equations, explanation still needed AR.support argument, plus arguments related called pulse. advise users consult associated documentation details (see help(TF_block) reference manual). AR.support character string, either \"constrained\" \"free\". AR.support \"constrained\", AR coefficients \\(\\phi_t\\) forced interval \\((-1,1)\\), otherwise, coefficients unrestricted. Beware , restriction coefficients, guarantee estimated coefficients imply stationary process, furthermore, order TF block greater 1, restriction imposed AR.support equal \"constrained\" guarantee process stationary, , user allowed use constrained parameters order block greater \\(1\\). constrain \\(\\phi_t\\) interval \\((-1,1)\\), apply inverse Fisher transformation, also known hyperbolic tangent function. pulse matrix \\(X\\) informed argument pulse, dimension \\(\\rho_t\\) implied number columns \\(X\\). important notice package expects \\(X\\) inform pulse value time instance, interpreting column distinct pulse associated coordinate \\(\\rho_t\\). Note pulse absent, \\(X_t=0, \\forall t\\), TF block equivalent autoregressive block. Finally, can summarize usage TF_block function follows: a1, R1 parameter prior accumulated effects \\((\\theta_1,...,\\theta_{1-order})'\\); noise.var, noise.disc h define mean variance random fluctuations \\(\\theta_t\\) time; a1.coef, R1.coef parameter prior coefficients \\(\\phi_1, ...,\\phi_{order}\\); h.coef, H.coef D.coef define mean variance random fluctuations \\(\\phi_t\\) time; a1.pulse, R1.pulse parameter prior pulse coefficient \\(\\rho_1\\); h.pulse, H.pulse D.pulse define mean variance random fluctuations \\(\\rho_t\\) time; pulse pulse matrix \\(X\\); AR.support defines support AR coefficients \\(\\phi_t\\). Bellow present code simply \\(AR(1)\\) block \\(W_t=0.1, \\forall t\\): Finally present plot Gamma model known shape \\(\\alpha=1.5\\) AR structure mean fitted simulated data. refrain show code fitting model , since discuss tools fitting section .","code":"TF_block(   ...,   order,   noise.var = NULL,   noise.disc = NULL,   pulse = 0,   name = \"Var.AR\",   AR.support = \"free\",   a1 = 0,   R1 = 9,   h = 0,   monitoring = TRUE,   D.coef = 1,   h.coef = 0,   H.coef = 0,   a1.coef = c(1, rep(0, order - 1)),   R1.coef = c(1, rep(0.25, order - 1)),   monitoring.coef = rep(FALSE, order),   a1.pulse = 0,   R1.pulse = 9,   D.pulse = 1,   h.pulse = 0,   H.pulse = 0,   monitoring.pulse = NA ) mean_block <- TF_block(   eta = 1,   order = 1,   noise.var = 0.1 )"},{"path":"/articles/structures.html","id":"some-comments-about-autoregressive-models-in-the-normal-family","dir":"Articles","previous_headings":"A structure for autoregresive models","what":"Some comments about autoregressive models in the Normal family","title":"Creation of model structures","text":"user may notice autoregressive block described little different common literature. Specifically, assume observed data (\\(Y_t\\)) follows autoregressive evolution, instead \\(\\theta_t\\) . approach generalization usual autoregressive model, indeed, \\(Y_t\\) follows usual AR(k), : \\[ \\begin{equation} \\begin{aligned} Y_t&=\\sum_{=1}^{k}\\phi_{,t}Y_{t-1}+\\epsilon_t,\\\\ \\epsilon_t &\\sim \\mathcal{N}_1(0,\\sigma_t^2), \\end{aligned} \\end{equation} \\] , model can also written : \\[ \\begin{equation} \\begin{aligned} Y_t|\\eta_t&\\sim \\mathcal{N}_1(\\eta_t,0),\\\\ \\eta_t=\\theta_t&=\\sum_{=1}^{k}\\phi_{,t}\\theta_{t-}+\\omega_t,\\\\ \\omega_t &\\sim \\mathcal{N}_1(0,W_t), \\end{aligned} \\end{equation} \\] model can described using TF_block function. generally, \\(Y_t|\\eta_t \\sim \\mathcal{F}(\\eta_t)\\), \\(\\mathcal{F}\\) distribution family contained exponential family indexed \\(\\eta_t\\), : \\[ \\begin{equation} \\begin{aligned} Y_t|\\eta_t &\\sim \\mathcal{F}(\\eta_t),\\\\ g(\\eta_t)=\\theta_t&=\\sum_{=1}^{k}\\phi_{,t}\\theta_{t-}+\\omega_t,\\\\ \\omega_t &\\sim \\mathcal{N}_1(0,W_t). \\end{aligned} \\end{equation} \\] important note caveats first specification (usual one) general one presented . reader see bellow, offer, particular case, Normal distribution unknown mean observational variance, can specify predictive strucutre mean observational variance. model, matter evolution error associated observation equation evolution equation (specify predictive structure former, latter can). cases, recommend use regression_block function instead TF_block. present example specification AR(k) using regression_block function time series \\(Y_t\\) length \\(T\\): Advanced Examples section provide wide range examples, including ones aforementioned structures. particular, present code usual (yet different discussed) forms AR, including following model: \\[ \\begin{equation} \\begin{aligned} Y_t&=\\mu_t+\\sum_{=1}^{k}\\phi_{,t}(Y_{t-1}-\\mu_{t-1})+\\epsilon_t,\\\\ \\epsilon_t &\\sim \\mathcal{N}_1(0,\\sigma_t^2), \\end{aligned} \\end{equation} \\]","code":"regression_block(   mu = c(0, Y[-T]),   max.lag = k )"},{"path":"/articles/structures.html","id":"a-structure-for-overdispersed-models","dir":"Articles","previous_headings":"","what":"A structure for overdispersed models","title":"Creation of model structures","text":"function creates sequence independent latent variables \\(\\epsilon_1,...,\\epsilon_t\\) based discussions presented dos Santos et al. (2024), : \\[ \\begin{equation} \\begin{aligned} \\epsilon_{t} &\\sim \\mathcal{N}(0,\\sigma_t^2),\\\\ \\sigma_t^2&=\\frac{t-1}{t}D_t\\sigma_{t-1}^2+\\frac{1}{t}(1-D_t)\\mathbb{E}[\\epsilon_{t-1}^2|\\mathcal{D}_{t-1}],\\\\ \\sigma_1^2&=R_1. \\end{aligned} \\end{equation} \\] Notice user need specify matrix \\(G_t\\), since implicitly determined equations , \\(G_t=0\\) \\(t\\). easy see correspondence arguments noise_block function respective meaning block specification, remaining ones follow usage seen previous block functions (see polynomial_block function). user must noticed, block makes sense , since barely capability learning patterns. , shown next subsection, structural blocks can combined , noise block one several structural blocks model. exemplify utility structural block, let us assume want model following (simulated) time series counts:  Since data counting, natural propose Poisson model, : \\[ \\begin{equation} \\begin{aligned} Y_t|\\theta_t &\\sim Poisson\\left(\\eta_t\\right),\\\\ \\ln(\\eta_t) &=\\lambda_{t}=\\theta_t,\\\\ \\theta_t&=\\theta_{t-1}+\\omega_t,\\\\ \\omega_t &\\sim \\mathcal{N}_1(0,W_t), \\end{aligned} \\end{equation} \\] Bellow present model fitted using kDGLM package:  Notice data middle observed period overdispersed, Poisson model properly address uncertainty. One proposed usage Normal model , indeed, capture uncertainty middle, notice data beginning end series low values, Normal model inappropriate. scenario, better approach add noise component linear predictor, can capture overdispersion:  relevant point choice R1 can affect final fit, , highly recommend user perform sensibility analysis help specify value R1. Lastly, see latter , noise block can also useful model dependency multiple time series. detailed discussion type blocks, see dos Santos et al. (2024).","code":"noise_block(..., name = \"Noise\", D = 0.99, R1 = 1) level <- polynomial_block(   rate = 1,   order = 3,   D = 0.95 )  fitted.data <- fit_model(level,   \"Model 1\" = Poisson(lambda = \"rate\", data = data) )  plot(fitted.data, lag = 1, plot.pkg = \"base\") level <- polynomial_block(   mu = 1,   order = 3,   D = 0.95 ) noise <- noise_block(   mu = 1 )  fitted.data <- fit_model(level, noise,   \"Model 2\" = Poisson(lambda = \"mu\", data = data) )  plot(fitted.data, lag = 1, plot.pkg = \"base\")"},{"path":"/articles/structures.html","id":"handling-multiple-structural-blocks","dir":"Articles","previous_headings":"","what":"Handling multiple structural blocks","title":"Creation of model structures","text":"n previous subsections, discussed define structure model using functions polynomial_block, regression_block, harmonic_block, TF_block noise_block. functions results single structural block. Generally, user want mix multiple types structures, one responsible explain part outcome \\(Y_t\\). task, introduce operator designed combine structural blocks superposition principle (see West Harrison, 1997, sec. 6.2), follows. Consider scenario one wishes superimpose \\(p\\) structural blocks; instance: trend, seasonal regression components (\\(p=3\\)). general overlaid structure given following specifications: \\[ \\begin{aligned} \\vec{\\theta}_t&=\\begin{bmatrix}\\vec{\\theta}_t^1\\\\ \\vdots\\\\ \\vec{\\theta}_t^n\\end{bmatrix}, & F_t&=\\begin{bmatrix}F_t^1 \\\\ \\vdots \\\\ F_t^p\\end{bmatrix},\\\\ G_t&=diag\\{G_t^{1},...,G_t^{p}\\},& W_t&=diag\\{W_t^{1},...,W_t^{p}\\}, \\end{aligned} \\] \\(diag\\{M^1,...,M^{p}\\}\\) represents block diagonal matrix diagonal composed \\(M^1,...,M^{p}\\); \\(\\theta_t\\) vector obtained concatenation vectors \\(\\vec{\\theta}_t^1,..., \\vec{\\theta}_t^p\\) corresponding structural block; \\(F_t\\) obtained follows: single linear predictor considered model, \\(F_t\\) line vector concatenating $F_t^1,…, F_t^p \\(. case several predictors  (\\)k>1$, seen next section), design matrix associated structural block \\(\\), \\(F_t^\\), dimension $n_i k $ \\(F_t\\) \\(n \\times k\\) matrix, obtained row-wise concatenation matrices \\(F_t^1,..., F_t^p\\), \\(n=\\sum_{=1}^p n_i\\). scenario, facilitate specification model, create one structural block \\(\\vec{\\theta}_t^\\), \\(F_t^{}\\), \\(G_t^{}\\) \\(W_t^{}\\), \\(=1,...p\\), “combine” blocks together. kDGLM package allows operation function block_superpos , equivalently, + operator: high number \\(p\\) structural blocks, use block_superpos slightly faster. demonstrate usage + operator, suppose like create model using four structures presented previously (polynomial trend, dynamic regression, harmonic trend AR model). following code: multiple regression context, , one regressor included predictor, user must specify different regression sub blocks, one regressor, apply superposition principle blocks. Thus, previous code lines, X vector \\(T\\) observations regressor \\(X_t\\), already defined R object current environment matrix covariates. Ideally, user also provide block name help identify model fitted, , user provide name, block default name type block. different blocks name, index automatically added variables conflicting labels based order blocks combined. Note automatic naming might make analysis fitted model confusing, specially dealing large number latent states. mind, strongly recommend users specify intuitive name structural block. integrating multiple blocks within model, ’s crucial understand associated design matrices, denoted \\(F_t^{}\\) block, combined. matrices concatenated vertically, one . Consequently, since predictor vector \\(\\vec{\\lambda}_t\\) calculated \\(F_{t}'\\vec{\\theta}_t\\), influence block \\(\\vec{\\lambda}_t\\) cumulative. previous code example, introduced linear predictor named eta. context, operations performed lines 1, 5, 7 (corresponding polynomial_block, regression_block, TF_block, respectively), represented \\(eta_t=1 \\times \\theta_{1,t}^{},=1,3,4\\); line 3 (corresponding regression_block), operation \\(eta_t=X_t \\times \\theta_{1,t}^{2}\\). ’s important note block initially defines eta independently. However, blocks combined, respective equations merged. result, complete structure line 9 can expressed : \\[ eta_t= 1 \\times \\theta_{1,t}^{1} + X_t \\times \\theta_{1,t}^{2} + 1 \\times \\theta_{1,t}^{3} + 1 \\times \\theta_{1,t}^{4} \\] expression illustrates contributions individual block aggregated form final model. methodology allows flexible construction complex models combining simpler components, contributing explain particular facet process \\(\\{Y_t\\}_{t=1}^T\\).","code":"block_1 <- ... . . . block_n <- ...  complete_structure <- block_superpos(block_1, ..., block_n) # or complete_structure <- block_1 + ... + block_n poly_subblock <- polynomial_block(eta = 1, name = \"Poly\", D = 0.95)  regr_subblock <- regression_block(eta = X, name = \"Regr\", D = 0.95)  harm_subblock <- harmonic_block(eta = 1, period = 12, name = \"Harm\")  AR_subblock <- TF_block(eta = 1, order = 1, noise.var = 0.1, name = \"AR\")  complete_block <- poly_subblock + regr_subblock + harm_subblock + AR_subblock"},{"path":"/articles/structures.html","id":"handling-multiple-linear-predictors","dir":"Articles","previous_headings":"","what":"Handling multiple linear predictors","title":"Creation of model structures","text":"user may noticed, one argument can passed ... argument. Indeed, user , several linear predictors created block (one unique name), affected associated latent state. instance, take following code: code creates \\(3\\) linear predictors \\(\\lambda_{1,t}\\),\\(\\lambda_{2,t}\\) \\(\\lambda_{3,t}\\) design matrix \\(F_t=(1,1,1)'\\), : \\[ \\begin{aligned} \\lambda_{1,t}&=1 \\times \\theta_{t}\\\\ \\lambda_{2,t}&=1 \\times \\theta_{t}\\\\ \\lambda_{3,t}&=1 \\times \\theta_{t} \\end{aligned} \\] Note latent state \\(\\theta_{t}\\) linear predictors \\(\\lambda_{,t}\\), .e., \\(\\theta_{t}\\) shared effect among linear predictors used induce association among predictors. specification independent effects linear predictor can done using different blocks latent state: name linear predictor missing particular block, .e., name linear predictor passed argument one block, absent another, understood particular block effect linear predictor absent, previous code equivalent : discussed end Subsection Handling multiple structural blocks, effect block linear predictors added . codes create \\(3\\) linear predictors, : \\[ \\begin{aligned} \\lambda_{1,t}&=1 \\times \\theta_{1,t} + 0 \\times \\theta_{2,t} + 0 \\times \\theta_{3,t}=\\theta_{1,t}\\\\ \\lambda_{2,t}&=0 \\times \\theta_{1,t} + 1 \\times \\theta_{2,t} + 0 \\times \\theta_{3,t}=\\theta_{2,t}\\\\ \\lambda_{3,t}&=0 \\times \\theta_{1,t} + 0 \\times \\theta_{2,t} + 1 \\times \\theta_{3,t}=\\theta_{3,t} \\end{aligned} \\] Remind syntax presented first illustration current section, guides creation common factors among predictors. One can use multiple blocks structure define linear predictors share () components: representing following structure: \\[ \\begin{aligned} \\lambda_{1,t}&=\\theta_{1,t}+\\theta_{4,t}\\\\ \\lambda_{2,t}&=\\theta_{2,t}+\\theta_{4,t}\\\\ \\lambda_{3,t}&=\\theta_{3,t}+\\theta_{4,t}\\\\ \\end{aligned} \\] examples basic structures, overwhelm reader overly intricate models. Still, kDGLM package limited way inclusion multiple linear predictors, structure one may use single predictor can also used multiple linear predictors. example, model \\(3\\) linear predictors, one mixture shared components exclusive components: Now focus replication structural blocks, apply block_mult function associated operator *. function allows user create multiple blocks identical structure, one associated different linear predictor. usage function simple : replicating blocks, understood copy base block independent (.e., latent states) block associated different set linear predictors. name linear predictors associated block taken original names index: Naturally, user might want rename linear predictors intuitive label. task, provide function:","code":"polynomial_block(lambda1 = 1, lambda2 = 1, lambda3 = 1) # Common factor polynomial_block(lambda1 = 1, order = 1) + # theta_1   polynomial_block(lambda2 = 1, order = 1) + # theta_2   polynomial_block(lambda3 = 1, order = 1) # theta_3 # Longer version of the previous code for the sake of clarity. # In general, when a block does not affect a particular linear predictor, that linear predictor should be ommited when creating the block. polynomial_block(lambda1 = 1, lambda2 = 0, lambda3 = 0, order = 1) + # theta_1   polynomial_block(lambda1 = 0, lambda2 = 1, lambda3 = 0, order = 1) + # theta_2   polynomial_block(lambda1 = 0, lambda2 = 0, lambda3 = 1, order = 1) # theta_3 polynomial_block(lambda1 = 1, order = 1) + # theta_1   polynomial_block(lambda2 = 1, order = 1) + # theta_2   polynomial_block(lambda3 = 1, order = 1) + # theta_3   polynomial_block(lambda1 = 1, lambda2 = 1, lambda3 = 1, order = 1) # theta_4: Common factor #### Global level with linear growth #### polynomial_block(lambda1 = 1, lambda2 = 1, lambda3 = 1, D = 0.95, order = 2) +   #### Local variables for lambda1 ####   polynomial_block(lambda1 = 1, order = 1) +   regression_block(lambda1 = X1, max.lag = 3) +   harmonic_block(lambda1 = 1, period = 12, D = 0.98) +   #### Local variables for lambda2 ####   polynomial_block(lambda2 = 1, order = 1) +   TF_block(lambda2 = 1, pulse = X2, order = 1, noise.disc = 1) +   harmonic_block(lambda2 = 1, period = 12, D = 0.98, order = 2) +   #### Local variables for lambda3 ####   polynomial_block(lambda3 = 1, order = 1) +   TF_block(lambda3 = 1, order = 2, noise.disc = 0.9) +   regression_block(lambda3 = X3, D = 0.95) base.block <- polynomial_block(eta = 1, name = \"Poly\", D = 0.95, order = 1)  # final.block <- block_mult(base.block, 4) # or # final.block <- base.block * 4 # or final.block <- 4 * base.block final.block$pred.names [1] \"eta.1\" \"eta.2\" \"eta.3\" \"eta.4\" final.block <- block_rename(final.block, c(\"Matthew\", \"Mark\", \"Luke\", \"John\")) final.block$pred.names"},{"path":"/articles/structures.html","id":"handling-unknown-components-in-the-planning-matrix-f_t","dir":"Articles","previous_headings":"","what":"Handling unknown components in the planning matrix \\(F_t\\)","title":"Creation of model structures","text":"situations user may want fit model : \\[ \\begin{aligned} \\lambda_{t}=F_t'\\theta_t=\\cdots+\\phi_t\\theta_t +\\cdots, \\end{aligned} \\] words, may case planning matrix \\(F_t\\) contains one unknown components. idea may foreign working one linear predictor, observational model several predictors make sense shared effects among predictors. Besides, construction also natural modeling multiple time series simultaneously, dealing correlated outcomes working compound regression. cases explored Advanced Examples section vignette. now, focus specify structures, whatever use may . simplicity, let us assume want create linear predictor \\(\\lambda_t\\) \\(\\lambda_{t}=\\phi_t\\theta_t\\). first step create linear predictor associated \\(\\phi_t\\) (call phi, although user may call whatever pleases user): Notice creating linear predictor \\(\\phi_t\\) latent state \\(\\tilde{\\theta}_t\\) \\(\\phi_t=1\\times \\tilde{\\theta}_t\\). Also, important note structure \\(\\phi_t\\) structural block (harmonic, regression, auto regression, etc.). Now can create structural block \\(\\theta_t\\): code creates linear predictor \\(\\lambda_t\\) latent state \\(\\theta_t\\) \\(\\lambda_t=\\phi_t \\times \\theta_t\\). Notice ... argument structural block used specify planning matrix \\(F_t\\), specifically, user must provide list named values, name indicates linear predictor \\(\\lambda_t\\) associated value represent effect \\(\\theta_{t}\\) predictor. user pass string ..., implicitly component \\(F_t\\) associated \\(\\theta_t\\) unknown modeled linear predictor labelled passed string. Lastly, one guess, possible establish chain components \\(F_t\\) order create even complex structure. instance, take following code: first line create linear predictor \\(\\eta_{1,t}\\) \\(\\eta_{1,t}=1 \\times \\theta_{1,t}\\). second line create another linear predictor \\(\\eta_{2,t}\\) \\(\\eta_{2,t}=\\eta_{1,t} \\times \\theta_{2,t}=\\theta_{1,t} \\times \\theta_{2,t}\\). create linear predictor \\(\\eta_{3,t}\\) \\(\\eta_{3,t}=\\eta_{2,t} \\times \\theta_{3,t}=\\theta_{1,t} \\times \\theta_{2,t} \\times \\theta_{3,t}\\). fit models non-linear components \\(F_t\\) /\\(G_t\\) matrices, use Extended Kalman Filter (Kalman, 1960; West Harrison, 1997).","code":"phi_block <- polynomial_block(phi = 1, order = 1) theta_block <- polynomial_block(lambda = \"phi\", order = 1) polynomial_block(eta1 = 1, order = 1) +   polynomial_block(eta2 = \"eta1\", order = 1) +   polynomial_block(eta3 = \"eta2\", order = 1)"},{"path":"/articles/structures.html","id":"special-priors","dir":"Articles","previous_headings":"","what":"Special priors","title":"Creation of model structures","text":"discussed Subsection structure polynomial trend models, default prior polynomial block—well blocks—assumes latent states independent mean \\(0\\) variance \\(9\\). Users flexibility modify prior combination mean vector covariance matrix, although latent states different blocks always assumed independent. important note independence applies prior distribution; subsequent updates may induce correlations latent states. prior setup may appropriate broad range applications, may instances user needs apply joint prior latent states across different blocks. example, similar model previously fitted another dataset, analyst might wish integrate information prior model new fitting. facilitate specification joint prior set latent states, kDGLM package offers joint_prior function: joint_prior function accepts dlm_block object returns object modified prior. block argument dlm_block object. syntax function designed facilitate use pipe operator (either |> %>%), allowing seamless integration piped sequences. example: var.index argument optional indicates indexes latent states prior distribution modified. a1 R1 arguments represent, respectively, mean vector covariance matrix latent states user wishes modify prior . user may also want specify special priors impose certain structure data. instance, user may believe certain set latent state sum \\(0\\) spacial structure . specially relevant modelling multiple time series, instance, lets say \\(r\\) series \\(Y_{,t}\\), \\(=1,...r\\), : \\[ \\begin{aligned}     Y_{,t}|\\eta_{,t} &\\sim Poisson(\\eta_{,t})\\\\ \\ln(\\eta_{,t})&=\\lambda_{}=\\mu_t+\\alpha_{,t},\\\\ \\sum_{=1}^{r} \\alpha_{,t}&=0, \\forall t. \\end{aligned} \\] Similarly, one want specify CAR prior (Banerjee et al., 2014; Schmidt Nobre, 2018) variables \\(\\alpha_1,...\\alpha_r\\), user believes spacial autocorrelation. scenarios, kDGLM package provides functions facilitate specification special priors structural blocks, zero_sum_prior CAR_prior. general usage analogous joint_prior function. Details functions omitted document sake brevity. comprehensive usage instructions, please refer vignette associated documentation.","code":"joint_prior(block, var.index = 1:block$n, a1 = block$a1[var.index], R1 = block$R1[var.index, var.index]) polynomial_block(mu = 1, order = 2, D = 0.95) |>   block_mult(5) |>   joint_prior(a1 = prior.mean, R1 = prior.var) # assuming the objects prior.mean and prior.var are defined."},{"path":[]},{"path":"/authors.html","id":null,"dir":"","previous_headings":"","what":"Authors","title":"Authors and Citation","text":"Silvaneo Vieira dos Santos Junior. Author, maintainer. Mariane Branco Alves. Author. Hélio dos Santos Migon. Author.","code":""},{"path":"/authors.html","id":"citation","dir":"","previous_headings":"","what":"Citation","title":"Authors and Citation","text":"dos Santos SV Junior, Alves MB, Migon HS (2024). \"kDGLM: R package Bayesian analysis Generalized Dynamic Linear Models.\" 2403.13069.","code":"@Misc{,   title = {kDGLM: An R package for Bayesian analysis of Generalized Dynamic Linear Models},   author = {Silvaneo Vieira dos Santos Junior and Mariane Branco Alves and Helio dos Santos Migon},   eprint = {2403.13069},   archiveprefix = {arXiv},   primaryclass = {stat.ME},   year = {2024}, }"},{"path":"/index.html","id":"kdglm-an-r-package-for-bayesian-analysis-of-generalized-dynamic-linear-models","dir":"","previous_headings":"","what":"Bayesian Analysis of Dynamic Generalized Linear Models","title":"Bayesian Analysis of Dynamic Generalized Linear Models","text":"Welcome kDGLM GitHub repository! kDGLM innovative R package tailored Bayesian analysis Generalized Dynamic Linear Models (GDLM), catering uni- multivariate exponential families. package go-tool sequential inference time series data, offering broad spectrum functionalities including fitting, smoothing, monitoring, feed-forward interventions. Developed based methodology proposed Alves et al.(2024), kDGLM integrates seamlessly established techniques literature, particularly applied Gaussian Dynamic Models. supports various features discount strategies, autoregressive components, transfer functions, , leveraging Kalman filter smoothing properties exceptional computational efficiency. kDGLM, can expect almost instantaneous fitting times scale linearly time series length, making invaluable tool analyzing extended time series datasets. Currently, kDGLM supports variety distributions, including: Univariate Normal (unknown mean observational variance); Bivariate Normal (unknown means, observational variances, correlation); Poisson; Gamma (known shape unknown mean); Multinomial (known number trials unknown event probabilities). Furthermore, kDGLM allows joint modeling multiple time series, provided series adheres one supported distributions. ongoing development efforts focused continuously expanding range supported distributions enhance package’s versatility. Whether analyzing time series data research, business intelligence, purpose, kDGLM offers powerful, efficient, comprehensive solution needs. Explore documentation get started join community users benefiting advanced capabilities kDGLM!","code":""},{"path":[]},{"path":"/index.html","id":"dependencies","dir":"","previous_headings":"","what":"Dependencies","title":"Bayesian Analysis of Dynamic Generalized Linear Models","text":"installing kDGLM, ensure following dependencies installed R environment: extraDistr >= 1.9.1 cubature >= 2.1.0 Rfast >= 2.0.8 generics >= 0.1.3 Additionally, enhanced plotting experience, recommend installing ggplot2 plotly packages, augment built-plot methods provided kDGLM.","code":""},{"path":"/index.html","id":"installing-kdglm","dir":"","previous_headings":"","what":"Installing kDGLM","title":"Bayesian Analysis of Dynamic Generalized Linear Models","text":"now, kDGLM available directly GitHub repository. process submitting kDGLM CRAN, can install latest version package executing following command R console: command uses remotes package install kDGLM. remotes installed, can install first running install.packages(“remotes”).","code":"remotes::install_github('silvaneojunior/kDGLM')"},{"path":"/index.html","id":"getting-started","dir":"","previous_headings":"","what":"Getting Started","title":"Bayesian Analysis of Dynamic Generalized Linear Models","text":"installation, load kDGLM R session: test package working properly, execute following code exemple: Refer vignettes detailed usage instructions. Also see documentation fit method basic examples type outcome kDGLM package offers.","code":"library(kDGLM) # Poisson case  data <- c(AirPassengers)   level <- polynomial_block(rate = 1, order = 2, D = 0.95)  season <- harmonic_block(rate = 1, order = 2, period = 12, D = 0.975)   outcome <- Poisson(lambda = \"rate\", data = data)   fitted.data <- fit(level, season,    AirPassengers = outcome  )  summary(fitted.data)  plot(fitted.data, plot.pkg = \"base\")"},{"path":"/index.html","id":"contributing","dir":"","previous_headings":"","what":"Contributing","title":"Bayesian Analysis of Dynamic Generalized Linear Models","text":"welcome contributions! ’re interested improving kDGLM, please consider submitting bug reports, feature requests, pull requests.","code":""},{"path":"/index.html","id":"acknowledgements","dir":"","previous_headings":"","what":"Acknowledgements","title":"Bayesian Analysis of Dynamic Generalized Linear Models","text":"Raíra Marotta, gently provided base code initial versions.","code":""},{"path":"/index.html","id":"contact","dir":"","previous_headings":"","what":"Contact","title":"Bayesian Analysis of Dynamic Generalized Linear Models","text":"support provide feedback, please contact Silvaneo dos Santos Jr. open issue GitHub repository.","code":""},{"path":"/LICENSE.html","id":null,"dir":"","previous_headings":"","what":"GNU General Public License","title":"GNU General Public License","text":"Version 3, 29 June 2007Copyright © 2007 Free Software Foundation, Inc. <http://fsf.org/> Everyone permitted copy distribute verbatim copies license document, changing allowed.","code":""},{"path":"/LICENSE.html","id":"preamble","dir":"","previous_headings":"","what":"Preamble","title":"GNU General Public License","text":"GNU General Public License free, copyleft license software kinds works. licenses software practical works designed take away freedom share change works. contrast, GNU General Public License intended guarantee freedom share change versions program–make sure remains free software users. , Free Software Foundation, use GNU General Public License software; applies also work released way authors. can apply programs, . speak free software, referring freedom, price. General Public Licenses designed make sure freedom distribute copies free software (charge wish), receive source code can get want , can change software use pieces new free programs, know can things. protect rights, need prevent others denying rights asking surrender rights. Therefore, certain responsibilities distribute copies software, modify : responsibilities respect freedom others. example, distribute copies program, whether gratis fee, must pass recipients freedoms received. must make sure , , receive can get source code. must show terms know rights. Developers use GNU GPL protect rights two steps: (1) assert copyright software, (2) offer License giving legal permission copy, distribute /modify . developers’ authors’ protection, GPL clearly explains warranty free software. users’ authors’ sake, GPL requires modified versions marked changed, problems attributed erroneously authors previous versions. devices designed deny users access install run modified versions software inside , although manufacturer can . fundamentally incompatible aim protecting users’ freedom change software. systematic pattern abuse occurs area products individuals use, precisely unacceptable. Therefore, designed version GPL prohibit practice products. problems arise substantially domains, stand ready extend provision domains future versions GPL, needed protect freedom users. Finally, every program threatened constantly software patents. States allow patents restrict development use software general-purpose computers, , wish avoid special danger patents applied free program make effectively proprietary. prevent , GPL assures patents used render program non-free. precise terms conditions copying, distribution modification follow.","code":""},{"path":[]},{"path":"/LICENSE.html","id":"id_0-definitions","dir":"","previous_headings":"TERMS AND CONDITIONS","what":"0. Definitions","title":"GNU General Public License","text":"“License” refers version 3 GNU General Public License. “Copyright” also means copyright-like laws apply kinds works, semiconductor masks. “Program” refers copyrightable work licensed License. licensee addressed “”. “Licensees” “recipients” may individuals organizations. “modify” work means copy adapt part work fashion requiring copyright permission, making exact copy. resulting work called “modified version” earlier work work “based ” earlier work. “covered work” means either unmodified Program work based Program. “propagate” work means anything , without permission, make directly secondarily liable infringement applicable copyright law, except executing computer modifying private copy. Propagation includes copying, distribution (without modification), making available public, countries activities well. “convey” work means kind propagation enables parties make receive copies. Mere interaction user computer network, transfer copy, conveying. interactive user interface displays “Appropriate Legal Notices” extent includes convenient prominently visible feature (1) displays appropriate copyright notice, (2) tells user warranty work (except extent warranties provided), licensees may convey work License, view copy License. interface presents list user commands options, menu, prominent item list meets criterion.","code":""},{"path":"/LICENSE.html","id":"id_1-source-code","dir":"","previous_headings":"TERMS AND CONDITIONS","what":"1. Source Code","title":"GNU General Public License","text":"“source code” work means preferred form work making modifications . “Object code” means non-source form work. “Standard Interface” means interface either official standard defined recognized standards body, , case interfaces specified particular programming language, one widely used among developers working language. “System Libraries” executable work include anything, work whole, () included normal form packaging Major Component, part Major Component, (b) serves enable use work Major Component, implement Standard Interface implementation available public source code form. “Major Component”, context, means major essential component (kernel, window system, ) specific operating system () executable work runs, compiler used produce work, object code interpreter used run . “Corresponding Source” work object code form means source code needed generate, install, (executable work) run object code modify work, including scripts control activities. However, include work’s System Libraries, general-purpose tools generally available free programs used unmodified performing activities part work. example, Corresponding Source includes interface definition files associated source files work, source code shared libraries dynamically linked subprograms work specifically designed require, intimate data communication control flow subprograms parts work. Corresponding Source need include anything users can regenerate automatically parts Corresponding Source. Corresponding Source work source code form work.","code":""},{"path":"/LICENSE.html","id":"id_2-basic-permissions","dir":"","previous_headings":"TERMS AND CONDITIONS","what":"2. Basic Permissions","title":"GNU General Public License","text":"rights granted License granted term copyright Program, irrevocable provided stated conditions met. License explicitly affirms unlimited permission run unmodified Program. output running covered work covered License output, given content, constitutes covered work. License acknowledges rights fair use equivalent, provided copyright law. may make, run propagate covered works convey, without conditions long license otherwise remains force. may convey covered works others sole purpose make modifications exclusively , provide facilities running works, provided comply terms License conveying material control copyright. thus making running covered works must exclusively behalf, direction control, terms prohibit making copies copyrighted material outside relationship . Conveying circumstances permitted solely conditions stated . Sublicensing allowed; section 10 makes unnecessary.","code":""},{"path":"/LICENSE.html","id":"id_3-protecting-users-legal-rights-from-anti-circumvention-law","dir":"","previous_headings":"TERMS AND CONDITIONS","what":"3. Protecting Users’ Legal Rights From Anti-Circumvention Law","title":"GNU General Public License","text":"covered work shall deemed part effective technological measure applicable law fulfilling obligations article 11 WIPO copyright treaty adopted 20 December 1996, similar laws prohibiting restricting circumvention measures. convey covered work, waive legal power forbid circumvention technological measures extent circumvention effected exercising rights License respect covered work, disclaim intention limit operation modification work means enforcing, work’s users, third parties’ legal rights forbid circumvention technological measures.","code":""},{"path":"/LICENSE.html","id":"id_4-conveying-verbatim-copies","dir":"","previous_headings":"TERMS AND CONDITIONS","what":"4. Conveying Verbatim Copies","title":"GNU General Public License","text":"may convey verbatim copies Program’s source code receive , medium, provided conspicuously appropriately publish copy appropriate copyright notice; keep intact notices stating License non-permissive terms added accord section 7 apply code; keep intact notices absence warranty; give recipients copy License along Program. may charge price price copy convey, may offer support warranty protection fee.","code":""},{"path":"/LICENSE.html","id":"id_5-conveying-modified-source-versions","dir":"","previous_headings":"TERMS AND CONDITIONS","what":"5. Conveying Modified Source Versions","title":"GNU General Public License","text":"may convey work based Program, modifications produce Program, form source code terms section 4, provided also meet conditions: ) work must carry prominent notices stating modified , giving relevant date. b) work must carry prominent notices stating released License conditions added section 7. requirement modifies requirement section 4 “keep intact notices”. c) must license entire work, whole, License anyone comes possession copy. License therefore apply, along applicable section 7 additional terms, whole work, parts, regardless packaged. License gives permission license work way, invalidate permission separately received . d) work interactive user interfaces, must display Appropriate Legal Notices; however, Program interactive interfaces display Appropriate Legal Notices, work need make . compilation covered work separate independent works, nature extensions covered work, combined form larger program, volume storage distribution medium, called “aggregate” compilation resulting copyright used limit access legal rights compilation’s users beyond individual works permit. Inclusion covered work aggregate cause License apply parts aggregate.","code":""},{"path":"/LICENSE.html","id":"id_6-conveying-non-source-forms","dir":"","previous_headings":"TERMS AND CONDITIONS","what":"6. Conveying Non-Source Forms","title":"GNU General Public License","text":"may convey covered work object code form terms sections 4 5, provided also convey machine-readable Corresponding Source terms License, one ways: ) Convey object code , embodied , physical product (including physical distribution medium), accompanied Corresponding Source fixed durable physical medium customarily used software interchange. b) Convey object code , embodied , physical product (including physical distribution medium), accompanied written offer, valid least three years valid long offer spare parts customer support product model, give anyone possesses object code either (1) copy Corresponding Source software product covered License, durable physical medium customarily used software interchange, price reasonable cost physically performing conveying source, (2) access copy Corresponding Source network server charge. c) Convey individual copies object code copy written offer provide Corresponding Source. alternative allowed occasionally noncommercially, received object code offer, accord subsection 6b. d) Convey object code offering access designated place (gratis charge), offer equivalent access Corresponding Source way place charge. need require recipients copy Corresponding Source along object code. place copy object code network server, Corresponding Source may different server (operated third party) supports equivalent copying facilities, provided maintain clear directions next object code saying find Corresponding Source. Regardless server hosts Corresponding Source, remain obligated ensure available long needed satisfy requirements. e) Convey object code using peer--peer transmission, provided inform peers object code Corresponding Source work offered general public charge subsection 6d. separable portion object code, whose source code excluded Corresponding Source System Library, need included conveying object code work. “User Product” either (1) “consumer product”, means tangible personal property normally used personal, family, household purposes, (2) anything designed sold incorporation dwelling. determining whether product consumer product, doubtful cases shall resolved favor coverage. particular product received particular user, “normally used” refers typical common use class product, regardless status particular user way particular user actually uses, expects expected use, product. product consumer product regardless whether product substantial commercial, industrial non-consumer uses, unless uses represent significant mode use product. “Installation Information” User Product means methods, procedures, authorization keys, information required install execute modified versions covered work User Product modified version Corresponding Source. information must suffice ensure continued functioning modified object code case prevented interfered solely modification made. convey object code work section , , specifically use , User Product, conveying occurs part transaction right possession use User Product transferred recipient perpetuity fixed term (regardless transaction characterized), Corresponding Source conveyed section must accompanied Installation Information. requirement apply neither third party retains ability install modified object code User Product (example, work installed ROM). requirement provide Installation Information include requirement continue provide support service, warranty, updates work modified installed recipient, User Product modified installed. Access network may denied modification materially adversely affects operation network violates rules protocols communication across network. Corresponding Source conveyed, Installation Information provided, accord section must format publicly documented (implementation available public source code form), must require special password key unpacking, reading copying.","code":""},{"path":"/LICENSE.html","id":"id_7-additional-terms","dir":"","previous_headings":"TERMS AND CONDITIONS","what":"7. Additional Terms","title":"GNU General Public License","text":"“Additional permissions” terms supplement terms License making exceptions one conditions. Additional permissions applicable entire Program shall treated though included License, extent valid applicable law. additional permissions apply part Program, part may used separately permissions, entire Program remains governed License without regard additional permissions. convey copy covered work, may option remove additional permissions copy, part . (Additional permissions may written require removal certain cases modify work.) may place additional permissions material, added covered work, can give appropriate copyright permission. Notwithstanding provision License, material add covered work, may (authorized copyright holders material) supplement terms License terms: ) Disclaiming warranty limiting liability differently terms sections 15 16 License; b) Requiring preservation specified reasonable legal notices author attributions material Appropriate Legal Notices displayed works containing ; c) Prohibiting misrepresentation origin material, requiring modified versions material marked reasonable ways different original version; d) Limiting use publicity purposes names licensors authors material; e) Declining grant rights trademark law use trade names, trademarks, service marks; f) Requiring indemnification licensors authors material anyone conveys material (modified versions ) contractual assumptions liability recipient, liability contractual assumptions directly impose licensors authors. non-permissive additional terms considered “restrictions” within meaning section 10. Program received , part , contains notice stating governed License along term restriction, may remove term. license document contains restriction permits relicensing conveying License, may add covered work material governed terms license document, provided restriction survive relicensing conveying. add terms covered work accord section, must place, relevant source files, statement additional terms apply files, notice indicating find applicable terms. Additional terms, permissive non-permissive, may stated form separately written license, stated exceptions; requirements apply either way.","code":""},{"path":"/LICENSE.html","id":"id_8-termination","dir":"","previous_headings":"TERMS AND CONDITIONS","what":"8. Termination","title":"GNU General Public License","text":"may propagate modify covered work except expressly provided License. attempt otherwise propagate modify void, automatically terminate rights License (including patent licenses granted third paragraph section 11). However, cease violation License, license particular copyright holder reinstated () provisionally, unless copyright holder explicitly finally terminates license, (b) permanently, copyright holder fails notify violation reasonable means prior 60 days cessation. Moreover, license particular copyright holder reinstated permanently copyright holder notifies violation reasonable means, first time received notice violation License (work) copyright holder, cure violation prior 30 days receipt notice. Termination rights section terminate licenses parties received copies rights License. rights terminated permanently reinstated, qualify receive new licenses material section 10.","code":""},{"path":"/LICENSE.html","id":"id_9-acceptance-not-required-for-having-copies","dir":"","previous_headings":"TERMS AND CONDITIONS","what":"9. Acceptance Not Required for Having Copies","title":"GNU General Public License","text":"required accept License order receive run copy Program. Ancillary propagation covered work occurring solely consequence using peer--peer transmission receive copy likewise require acceptance. However, nothing License grants permission propagate modify covered work. actions infringe copyright accept License. Therefore, modifying propagating covered work, indicate acceptance License .","code":""},{"path":"/LICENSE.html","id":"id_10-automatic-licensing-of-downstream-recipients","dir":"","previous_headings":"TERMS AND CONDITIONS","what":"10. Automatic Licensing of Downstream Recipients","title":"GNU General Public License","text":"time convey covered work, recipient automatically receives license original licensors, run, modify propagate work, subject License. responsible enforcing compliance third parties License. “entity transaction” transaction transferring control organization, substantially assets one, subdividing organization, merging organizations. propagation covered work results entity transaction, party transaction receives copy work also receives whatever licenses work party’s predecessor interest give previous paragraph, plus right possession Corresponding Source work predecessor interest, predecessor can get reasonable efforts. may impose restrictions exercise rights granted affirmed License. example, may impose license fee, royalty, charge exercise rights granted License, may initiate litigation (including cross-claim counterclaim lawsuit) alleging patent claim infringed making, using, selling, offering sale, importing Program portion .","code":""},{"path":"/LICENSE.html","id":"id_11-patents","dir":"","previous_headings":"TERMS AND CONDITIONS","what":"11. Patents","title":"GNU General Public License","text":"“contributor” copyright holder authorizes use License Program work Program based. work thus licensed called contributor’s “contributor version”. contributor’s “essential patent claims” patent claims owned controlled contributor, whether already acquired hereafter acquired, infringed manner, permitted License, making, using, selling contributor version, include claims infringed consequence modification contributor version. purposes definition, “control” includes right grant patent sublicenses manner consistent requirements License. contributor grants non-exclusive, worldwide, royalty-free patent license contributor’s essential patent claims, make, use, sell, offer sale, import otherwise run, modify propagate contents contributor version. following three paragraphs, “patent license” express agreement commitment, however denominated, enforce patent (express permission practice patent covenant sue patent infringement). “grant” patent license party means make agreement commitment enforce patent party. convey covered work, knowingly relying patent license, Corresponding Source work available anyone copy, free charge terms License, publicly available network server readily accessible means, must either (1) cause Corresponding Source available, (2) arrange deprive benefit patent license particular work, (3) arrange, manner consistent requirements License, extend patent license downstream recipients. “Knowingly relying” means actual knowledge , patent license, conveying covered work country, recipient’s use covered work country, infringe one identifiable patents country reason believe valid. , pursuant connection single transaction arrangement, convey, propagate procuring conveyance , covered work, grant patent license parties receiving covered work authorizing use, propagate, modify convey specific copy covered work, patent license grant automatically extended recipients covered work works based . patent license “discriminatory” include within scope coverage, prohibits exercise , conditioned non-exercise one rights specifically granted License. may convey covered work party arrangement third party business distributing software, make payment third party based extent activity conveying work, third party grants, parties receive covered work , discriminatory patent license () connection copies covered work conveyed (copies made copies), (b) primarily connection specific products compilations contain covered work, unless entered arrangement, patent license granted, prior 28 March 2007. Nothing License shall construed excluding limiting implied license defenses infringement may otherwise available applicable patent law.","code":""},{"path":"/LICENSE.html","id":"id_12-no-surrender-of-others-freedom","dir":"","previous_headings":"TERMS AND CONDITIONS","what":"12. No Surrender of Others’ Freedom","title":"GNU General Public License","text":"conditions imposed (whether court order, agreement otherwise) contradict conditions License, excuse conditions License. convey covered work satisfy simultaneously obligations License pertinent obligations, consequence may convey . example, agree terms obligate collect royalty conveying convey Program, way satisfy terms License refrain entirely conveying Program.","code":""},{"path":"/LICENSE.html","id":"id_13-use-with-the-gnu-affero-general-public-license","dir":"","previous_headings":"TERMS AND CONDITIONS","what":"13. Use with the GNU Affero General Public License","title":"GNU General Public License","text":"Notwithstanding provision License, permission link combine covered work work licensed version 3 GNU Affero General Public License single combined work, convey resulting work. terms License continue apply part covered work, special requirements GNU Affero General Public License, section 13, concerning interaction network apply combination .","code":""},{"path":"/LICENSE.html","id":"id_14-revised-versions-of-this-license","dir":"","previous_headings":"TERMS AND CONDITIONS","what":"14. Revised Versions of this License","title":"GNU General Public License","text":"Free Software Foundation may publish revised /new versions GNU General Public License time time. new versions similar spirit present version, may differ detail address new problems concerns. version given distinguishing version number. Program specifies certain numbered version GNU General Public License “later version” applies , option following terms conditions either numbered version later version published Free Software Foundation. Program specify version number GNU General Public License, may choose version ever published Free Software Foundation. Program specifies proxy can decide future versions GNU General Public License can used, proxy’s public statement acceptance version permanently authorizes choose version Program. Later license versions may give additional different permissions. However, additional obligations imposed author copyright holder result choosing follow later version.","code":""},{"path":"/LICENSE.html","id":"id_15-disclaimer-of-warranty","dir":"","previous_headings":"TERMS AND CONDITIONS","what":"15. Disclaimer of Warranty","title":"GNU General Public License","text":"WARRANTY PROGRAM, EXTENT PERMITTED APPLICABLE LAW. EXCEPT OTHERWISE STATED WRITING COPYRIGHT HOLDERS /PARTIES PROVIDE PROGRAM “” WITHOUT WARRANTY KIND, EITHER EXPRESSED IMPLIED, INCLUDING, LIMITED , IMPLIED WARRANTIES MERCHANTABILITY FITNESS PARTICULAR PURPOSE. ENTIRE RISK QUALITY PERFORMANCE PROGRAM . PROGRAM PROVE DEFECTIVE, ASSUME COST NECESSARY SERVICING, REPAIR CORRECTION.","code":""},{"path":"/LICENSE.html","id":"id_16-limitation-of-liability","dir":"","previous_headings":"TERMS AND CONDITIONS","what":"16. Limitation of Liability","title":"GNU General Public License","text":"EVENT UNLESS REQUIRED APPLICABLE LAW AGREED WRITING COPYRIGHT HOLDER, PARTY MODIFIES /CONVEYS PROGRAM PERMITTED , LIABLE DAMAGES, INCLUDING GENERAL, SPECIAL, INCIDENTAL CONSEQUENTIAL DAMAGES ARISING USE INABILITY USE PROGRAM (INCLUDING LIMITED LOSS DATA DATA RENDERED INACCURATE LOSSES SUSTAINED THIRD PARTIES FAILURE PROGRAM OPERATE PROGRAMS), EVEN HOLDER PARTY ADVISED POSSIBILITY DAMAGES.","code":""},{"path":"/LICENSE.html","id":"id_17-interpretation-of-sections-15-and-16","dir":"","previous_headings":"TERMS AND CONDITIONS","what":"17. Interpretation of Sections 15 and 16","title":"GNU General Public License","text":"disclaimer warranty limitation liability provided given local legal effect according terms, reviewing courts shall apply local law closely approximates absolute waiver civil liability connection Program, unless warranty assumption liability accompanies copy Program return fee. END TERMS CONDITIONS","code":""},{"path":"/LICENSE.html","id":"how-to-apply-these-terms-to-your-new-programs","dir":"","previous_headings":"","what":"How to Apply These Terms to Your New Programs","title":"GNU General Public License","text":"develop new program, want greatest possible use public, best way achieve make free software everyone can redistribute change terms. , attach following notices program. safest attach start source file effectively state exclusion warranty; file least “copyright” line pointer full notice found. Also add information contact electronic paper mail. program terminal interaction, make output short notice like starts interactive mode: hypothetical commands show w show c show appropriate parts General Public License. course, program’s commands might different; GUI interface, use “box”. also get employer (work programmer) school, , sign “copyright disclaimer” program, necessary. information , apply follow GNU GPL, see <http://www.gnu.org/licenses/>. GNU General Public License permit incorporating program proprietary programs. program subroutine library, may consider useful permit linking proprietary applications library. want , use GNU Lesser General Public License instead License. first, please read <http://www.gnu.org/philosophy/--lgpl.html>.","code":"<one line to give the program's name and a brief idea of what it does.> Copyright (C) <year>  <name of author>  This program is free software: you can redistribute it and/or modify it under the terms of the GNU General Public License as published by the Free Software Foundation, either version 3 of the License, or (at your option) any later version.  This program is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License for more details.  You should have received a copy of the GNU General Public License along with this program.  If not, see <http://www.gnu.org/licenses/>. <program>  Copyright (C) <year>  <name of author> This program comes with ABSOLUTELY NO WARRANTY; for details type 'show w'. This is free software, and you are welcome to redistribute it under certain conditions; type 'show c' for details."},{"path":"/reference/analytic_filter.html","id":null,"dir":"Reference","previous_headings":"","what":"analytic_filter — analytic_filter","title":"analytic_filter — analytic_filter","text":"Fit model given observed value model parameters.","code":""},{"path":"/reference/analytic_filter.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"analytic_filter — analytic_filter","text":"","code":"analytic_filter(   outcomes,   a1 = 0,   R1 = 1,   FF,   FF.labs,   G,   G.labs,   D,   h,   H,   p.monit = NA,   monitoring = FALSE )"},{"path":"/reference/analytic_filter.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"analytic_filter — analytic_filter","text":"outcomes list: observed data. contain objects class dlm_distr. a1 numeric: prior mean latent vector. R1 matrix: prior covariance matrix latent vector. FF array: 3D-array containing planning matrix time. dimension n x k x t, n number latent states, k number linear predictors model t time series length. FF.labs matrix: character matrix containing label associated value FF. G array: 3D-array containing evolution matrix time. dimension n x n x t, n number latent states t time series length. G.labs matrix: character matrix containing label associated value G. D array: 3D-array containing discount factor matrix time. dimension n x n x t, n number latent states t time series length. h matrix: drift added temporal evolution (can interpreted mean random noise time). dimension n x t, t length series n number latent states. H array: 3D-array containing covariance matrix noise time. dimension D. p.monit numeric (optional): prior probability changes latent space variables part dynamic. monitoring numeric: vector flags indicating latent states monitored.","code":""},{"path":"/reference/analytic_filter.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"analytic_filter — analytic_filter","text":"list containing following values: mt matrix: filtered mean latent states time. Dimensions n x t. Ct array: 3D-array containing filtered covariance matrix latent states time. Dimensions n x n x t. matrix: one-step-ahead mean latent states time. Dimensions n x t. Rt array: 3D-array containing one-step-ahead covariance matrix latent states time. Dimensions n x n x t. ft matrix: one-step-ahead mean linear predictors time. Dimensions k x t. Qt array: 3D-array containing one-step-ahead covariance matrix linear predictors time. Dimensions k x k x t. ft.star matrix: filtered mean linear predictors time. Dimensions k x t. Qt.star array: 3D-array containing linear predictors matrix latent state time. Dimensions k x k x t. FF array: argument (values). G matrix: argument (values). G.labs matrix: argument (values). D array: argument (values). h array: argument (values). H array: argument (values). W array: 3D-array containing effective covariance matrix noise time, .e., considering H D. dimension H D. monitoring numeric: argument (values). outcomes list: argument outcomes (values). pred.names numeric: names linear predictors.","code":""},{"path":"/reference/analytic_filter.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"analytic_filter — analytic_filter","text":"models covered package, always use approach described Alves et al. (2024) , including, particular, filtering algorithm presented work. details implementation see dos Santos et al. (2024) . details algorithm implemented see Alves et al. (2024) , Petris et al. (2009) , chapter 2, West Harrison (1997) , chapter 4, Kalman (1960) .","code":""},{"path":"/reference/analytic_filter.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"analytic_filter — analytic_filter","text":"Mariane Branco Alves, Helio S. Migon, Raíra Marotta, Junior, Silvaneo Vieira dos Santos (2024). “k-parametric Dynamic Generalized Linear Models: sequential approach via Information Geometry.” 2201.05387. Junior, Silvaneo Vieira dos Santos, Mariane Branco Alves, Helio S. Migon (2024). “kDGLM: R package Bayesian analysis Dynamic Generialized Linear Models.” Rudolph Emil Kalman (1960). “New Approach Linear Filtering Prediction Problems.” Transactions ASME--Journal Basic Engineering, 82(Series D), 35--45. Giovanni Petris, Sonia Petrone, Patrizia Campagnoli (2009). Dynamic Linear Models R,  useR! Springer-Verlag, New York. Mike West, Jeff Harrison (1997). Bayesian Forecasting Dynamic Models (Springer Series Statistics). Springer-Verlag. ISBN 0387947256.","code":""},{"path":[]},{"path":"/reference/array_collapse_left.html","id":null,"dir":"Reference","previous_headings":"","what":"array_collapse_left — array_collapse_left","title":"array_collapse_left — array_collapse_left","text":"Calculates matrix product array vector.","code":""},{"path":"/reference/array_collapse_left.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"array_collapse_left — array_collapse_left","text":"","code":"array_collapse_left(A, B)"},{"path":"/reference/array_collapse_left.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"array_collapse_left — array_collapse_left","text":"3-D array shapes n x m x k. B matrix shapes m x 1.","code":""},{"path":"/reference/array_collapse_left.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"array_collapse_left — array_collapse_left","text":"array shapes n x m x k vector B shape m, operations returns matrix C, shapes n x k, C[,] = [,,]","code":""},{"path":"/reference/array_collapse_right.html","id":null,"dir":"Reference","previous_headings":"","what":"array_collapse_right — array_collapse_right","title":"array_collapse_right — array_collapse_right","text":"Calculates matrix product array vector.","code":""},{"path":"/reference/array_collapse_right.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"array_collapse_right — array_collapse_right","text":"","code":"array_collapse_right(A, B)"},{"path":"/reference/array_collapse_right.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"array_collapse_right — array_collapse_right","text":"3-D array shapes n x m x k. B matrix shapes 1 x n.","code":""},{"path":"/reference/array_collapse_right.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"array_collapse_right — array_collapse_right","text":"array shapes m x n x k vector B shape m, operations returns matrix C, shapes n x k, C[,] = B","code":""},{"path":"/reference/array_mult_left.html","id":null,"dir":"Reference","previous_headings":"","what":"array_mult_left — array_mult_left","title":"array_mult_left — array_mult_left","text":"Calculates matrix product array matrix.","code":""},{"path":"/reference/array_mult_left.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"array_mult_left — array_mult_left","text":"","code":"array_mult_left(A, B)"},{"path":"/reference/array_mult_left.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"array_mult_left — array_mult_left","text":"3-D array shapes n x m x k. B matrix shapes m x l.","code":""},{"path":"/reference/array_mult_left.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"array_mult_left — array_mult_left","text":"array shapes n x m x k matrix B shape m x l, operations returns array C, shapes n x l x k, C[,,] = [,,]","code":""},{"path":"/reference/array_mult_right.html","id":null,"dir":"Reference","previous_headings":"","what":"array_mult_right — array_mult_right","title":"array_mult_right — array_mult_right","text":"Calculates matrix product array matrix.","code":""},{"path":"/reference/array_mult_right.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"array_mult_right — array_mult_right","text":"","code":"array_mult_right(A, B)"},{"path":"/reference/array_mult_right.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"array_mult_right — array_mult_right","text":"3-D array shapes n x m x k. B matrix shapes l x n.","code":""},{"path":"/reference/array_mult_right.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"array_mult_right — array_mult_right","text":"array shapes m x n x k matrix B shape l x m, operations returns array C, shapes l x n x k, C[,,] = B","code":""},{"path":"/reference/array_transp.html","id":null,"dir":"Reference","previous_headings":"","what":"array_transp — array_transp","title":"array_transp — array_transp","text":"Calculates element-wise transposition array.","code":""},{"path":"/reference/array_transp.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"array_transp — array_transp","text":"","code":"array_transp(A)"},{"path":"/reference/array_transp.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"array_transp — array_transp","text":"3-D array.","code":""},{"path":"/reference/array_transp.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"array_transp — array_transp","text":"array shapes n x m x k, operations returns array C, shapes m x n x k, C[,,] = t([,,]).","code":""},{"path":"/reference/base_block.html","id":null,"dir":"Reference","previous_headings":"","what":"Basic structural blocks — base_block","title":"Basic structural blocks — base_block","text":"Creates basic structure dlm block desired order.","code":""},{"path":"/reference/base_block.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Basic structural blocks — base_block","text":"","code":"base_block(..., order, name, D, h, H, a1, R1, monitoring)"},{"path":"/reference/base_block.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Basic structural blocks — base_block","text":"... Named values planning matrix. order integer: order structure. Must positive name character: optional argument providing name block. Can useful identify models meaningful labels, also, name used used auxiliary functions. D array, matrix, vector scalar: values discount factors associated latent states time. D array, dimensions n x n x t, n order polynomial block t length outcomes. D matrix, dimensions n x n discount matrix used observations. D vector, size t interpreted discount factor observed time (discount variable). D scalar, discount used latent states times. h matrix, vector scalar: drift add temporal evolution (can interpreted mean random noise time). matrix, dimension n x t, n number latent states (.e., order) t length series. vector, size t, value applied first latent state (one affects linear predictors) respective time. scalar, passed value used first latent state time. H array, matrix, vector scalar: values covariance matrix noise factor time. H array, dimensions n x n x t, n order polynomial block t length series. H matrix, dimensions n x n values used time. H vector scalar, discount factor matrix created diagonal matrix values H diagonal. a1 vector scalar: prior mean latent states associated block time 1. a1 vector, dimension equal order polynomial block. a1 scalar, value used latent states. R1 matrix, vector scalar: prior covariance matrix latent states associated block time 1. R1 matrix, dimensions n x n. R1 vector scalar, covariance matrix created diagonal matrix values R1 diagonal. monitoring vector: vector flags indicating variables monitored (automated monitoring used). size n. default first order component structure monitored.","code":""},{"path":"/reference/base_ribbon.html","id":null,"dir":"Reference","previous_headings":"","what":"base_ribbon — base_ribbon","title":"base_ribbon — base_ribbon","text":"Makes ribbon plot using R base functions.","code":""},{"path":"/reference/base_ribbon.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"base_ribbon — base_ribbon","text":"","code":"base_ribbon(x, ymin, ymax, ...)"},{"path":"/reference/base_ribbon.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"base_ribbon — base_ribbon","text":"x numeric: sequence values x-axis. ymin numeric: sequence values lower bound ribbon. ymax numeric: sequence values upper bound ribbon. ... Extra arguments polygon function.","code":""},{"path":"/reference/bdiag.html","id":null,"dir":"Reference","previous_headings":"","what":"bdiag — bdiag","title":"bdiag — bdiag","text":"Creates block diagonal matrix matrix passed argument.","code":""},{"path":"/reference/bdiag.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"bdiag — bdiag","text":"","code":"bdiag(...)"},{"path":"/reference/bdiag.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"bdiag — bdiag","text":"... list matrices used.","code":""},{"path":"/reference/bdiag.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"bdiag — bdiag","text":"block diagonal matrix whose diagonal elements equal matrices passed arguments.","code":""},{"path":"/reference/block_mult.html","id":null,"dir":"Reference","previous_headings":"","what":"Auxiliary function to replicate blocks — block_mult","title":"Auxiliary function to replicate blocks — block_mult","text":"auxiliary function replicate blocks.","code":""},{"path":"/reference/block_mult.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Auxiliary function to replicate blocks — block_mult","text":"","code":"block_mult(block, k)"},{"path":"/reference/block_mult.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Auxiliary function to replicate blocks — block_mult","text":"block dlm_block: block replicated k Integer: number blocks generate.","code":""},{"path":"/reference/block_mult.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Auxiliary function to replicate blocks — block_mult","text":"combined replicated blocks dlm_block.","code":""},{"path":[]},{"path":"/reference/block_mult.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Auxiliary function to replicate blocks — block_mult","text":"","code":"# Long way level <- polynomial_block(alpha = 1, order = 1)  final.block <- block_mult(level, 5)  # Short way final.block <- 5 * polynomial_block(alpha = 1, order = 1)"},{"path":"/reference/block_rename.html","id":null,"dir":"Reference","previous_headings":"","what":"block_rename — block_rename","title":"block_rename — block_rename","text":"block_rename","code":""},{"path":"/reference/block_rename.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"block_rename — block_rename","text":"","code":"block_rename(block, pred.names)"},{"path":"/reference/block_rename.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"block_rename — block_rename","text":"block dlm_block object. pred.names vector string names linear predictor block.","code":""},{"path":"/reference/block_rename.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"block_rename — block_rename","text":"dlm_block linear predictors renamed values passed names.","code":""},{"path":[]},{"path":"/reference/block_rename.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"block_rename — block_rename","text":"","code":"base.block <- polynomial_block(   eta = 1,   order = 1,   name = \"Poly\",   D = 0.95 )  final.block <- block_rename(2 * base.block, c(\"mu\", \"sigma\"))"},{"path":"/reference/block_superpos.html","id":null,"dir":"Reference","previous_headings":"","what":"Auxiliary function for block superposition — block_superpos","title":"Auxiliary function for block superposition — block_superpos","text":"auxiliary function block superposition.","code":""},{"path":"/reference/block_superpos.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Auxiliary function for block superposition — block_superpos","text":"","code":"block_superpos(...)"},{"path":"/reference/block_superpos.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Auxiliary function for block superposition — block_superpos","text":"... dlm_block: sequence block combine.","code":""},{"path":"/reference/block_superpos.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Auxiliary function for block superposition — block_superpos","text":"combined blocks dlm_block.","code":""},{"path":"/reference/block_superpos.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Auxiliary function for block superposition — block_superpos","text":"Additional details can found West Harrison (1997) , section 6.2.","code":""},{"path":"/reference/block_superpos.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Auxiliary function for block superposition — block_superpos","text":"Mike West, Jeff Harrison (1997). Bayesian Forecasting Dynamic Models (Springer Series Statistics). Springer-Verlag. ISBN 0387947256.","code":""},{"path":[]},{"path":"/reference/block_superpos.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Auxiliary function for block superposition — block_superpos","text":"","code":"# Long way level.1 <- polynomial_block(alpha1 = 1, order = 1) level.2 <- polynomial_block(alpha2 = 1, order = 2) season.2 <- harmonic_block(alpha2 = 1, period = 20)  final.block <- block_superpos(level.1, level.2, season.2)  # Short way final.block <- polynomial_block(alpha1 = 1, order = 1) +   polynomial_block(alpha2 = 1, order = 2) +   harmonic_block(alpha2 = 1, period = 20)"},{"path":"/reference/CAR_prior.html","id":null,"dir":"Reference","previous_headings":"","what":"CAR prior — CAR_prior","title":"CAR prior — CAR_prior","text":"Defines prior structural block Conditional Autoregressive (CAR) prior.","code":""},{"path":"/reference/CAR_prior.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"CAR prior — CAR_prior","text":"","code":"CAR_prior(block, adj.matrix, scale, rho, var.index = 1:block$n)"},{"path":"/reference/CAR_prior.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"CAR prior — CAR_prior","text":"block dlm_block object: structural block. adj.matrix matrix: adjacency matrix. scale numeric: tau parameter CAR model (see references). rho numeric: rho parameter CAR model (see references). var.index integer: index variables set prior.","code":""},{"path":"/reference/CAR_prior.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"CAR prior — CAR_prior","text":"dlm_block object desired prior.","code":""},{"path":"/reference/CAR_prior.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"CAR prior — CAR_prior","text":"filtering algorithm used package requires proper prior latent space. , implementation CAR prior imposes zero-sum constraint regional effects. discount factor must variables whose prior modified. revision CAR prior, see Schmidt Nobre (2018) . details implementation see dos Santos et al. (2024) .","code":""},{"path":"/reference/CAR_prior.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"CAR prior — CAR_prior","text":"Junior, Silvaneo Vieira dos Santos, Mariane Branco Alves, Helio S. Migon (2024). “kDGLM: R package Bayesian analysis Dynamic Generialized Linear Models.” Alexandra M. Schmidt, Widemberg S. Nobre (2018). “Conditional Autoregressive (CAR) Model.” Wiley StatsRef: Statistics Reference Online, chapter Conditional Autoregressive (CAR) Model, 1-11. John Wiley & Sons, Ltd. ISBN 9781118445112, doi:10.1002/9781118445112.stat08048 , https://onlinelibrary.wiley.com/doi/pdf/10.1002/9781118445112.stat08048, https://onlinelibrary.wiley.com/doi/abs/10.1002/9781118445112.stat08048.","code":""},{"path":[]},{"path":"/reference/CAR_prior.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"CAR prior — CAR_prior","text":"","code":"# Creating an arbitrary adjacency matrix adj.matrix <- matrix(   c(     0, 1, 1, 0, 0,     1, 0, 1, 0, 0,     1, 1, 0, 0, 0,     0, 0, 0, 0, 1,     0, 0, 0, 1, 0   ),   5, 5,   byrow = TRUE )  polynomial_block(mu = 1, D = 0.95) |>   block_mult(5) |>   CAR_prior(scale = 9, rho = 1, adj.matrix = adj.matrix) #> Mixed DLM block. #> latent states:  #>     Var.Poly.1: Level (1 variable(s)) #>     Var.Poly.2: Level (1 variable(s)) #>     Var.Poly.3: Level (1 variable(s)) #>     Var.Poly.4: Level (1 variable(s)) #>     Var.Poly.5: Level (1 variable(s)) #>  #> Linear predictors:  #>     mu.1 #>     mu.2 #>     mu.3 #>     mu.4 #>     mu.5 #>  #> Status: defined #> Serie length: 1 #> Interventions at:  #> Number of latent states: 5 #> Number of linear predictors: 5"},{"path":"/reference/check.block.status.html","id":null,"dir":"Reference","previous_headings":"","what":"check.block.status — check.block.status","title":"check.block.status — check.block.status","text":"Checks block defined.","code":""},{"path":"/reference/check.block.status.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"check.block.status — check.block.status","text":"","code":"check.block.status(block)"},{"path":"/reference/check.block.status.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"check.block.status — check.block.status","text":"block dlm_block object.","code":""},{"path":"/reference/check.block.status.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"check.block.status — check.block.status","text":"character (\"defined\" \"undefined\") indicating parameters block defined.","code":""},{"path":"/reference/chickenPox.html","id":null,"dir":"Reference","previous_headings":"","what":"Hospital admissions by chicken pox in Brazil — chickenPox","title":"Hospital admissions by chicken pox in Brazil — chickenPox","text":"Monthly hospital admissions chicken pox Brazil January 2010 December 2019.","code":""},{"path":"/reference/chickenPox.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Hospital admissions by chicken pox in Brazil — chickenPox","text":"","code":"chickenPox"},{"path":"/reference/chickenPox.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Hospital admissions by chicken pox in Brazil — chickenPox","text":"data frame 120 rows 6 columns: date date observations. < 5 year, 5 9 years, 10 14 years, 15 49 years, 50 years number admissions age group.","code":""},{"path":"/reference/chickenPox.html","id":"source","dir":"Reference","previous_headings":"","what":"Source","title":"Hospital admissions by chicken pox in Brazil — chickenPox","text":"https://datasus.saude.gov.br/informacoes-de-saude-tabnet/","code":""},{"path":"/reference/coef.fitted_dlm.html","id":null,"dir":"Reference","previous_headings":"","what":"coef.fitted_dlm — coef.fitted_dlm","title":"coef.fitted_dlm — coef.fitted_dlm","text":"Evaluates predictive values observed values used fit model latent states. Predictions can made smoothed values, filtered values h-steps ahead.","code":""},{"path":"/reference/coef.fitted_dlm.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"coef.fitted_dlm — coef.fitted_dlm","text":"","code":"# S3 method for fitted_dlm coef(   object,   t.eval = seq_len(object$t),   lag = -1,   pred.cred = 0.95,   eval.pred = FALSE,   eval.metric = FALSE,   ... )"},{"path":"/reference/coef.fitted_dlm.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"coef.fitted_dlm — coef.fitted_dlm","text":"object fitted_dlm: fitted model use evaluation. t.eval numeric: vector positive integers indicating time index extract predictions. default extract evaluate model observed times. lag integer: relative offset forecast. Values time t calculated based filtered values time t-h. lag negative, smoothed distribution latent states used. pred.cred numeric: credibility level C... eval.pred boolean: flag indicating predictions calculated. eval.metric boolean: flag indicating model density (f(M|y)) calculated. used lag<0. ... Extra arguments passed coef method.","code":""},{"path":"/reference/coef.fitted_dlm.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"coef.fitted_dlm — coef.fitted_dlm","text":"list containing: data data.frame: table model evaluated observed time. theta.mean matrix: mean latent states time. Dimensions n x t, t size t.eval n number latent states. theta.cov array: 3D-array containing covariance matrix latent states time. Dimensions n x n x t, t size t.eval n number latent states. lambda.mean matrix: mean linear predictor time. Dimensions k x t, t size t.eval k number linear predictors. lambda.cov array: 3D-array containing covariance matrix linear predictor time. Dimensions k x k x t, t size t.eval k number linear predictors. log.like, mae, mase, rae, mse, interval.score: metric value time. conj.param list: list containing, outcome, data.frame parameter conjugated distribution time.","code":""},{"path":[]},{"path":"/reference/coef.fitted_dlm.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"coef.fitted_dlm — coef.fitted_dlm","text":"","code":"# Poisson case data <- c(AirPassengers)  level <- polynomial_block(rate = 1, order = 2, D = 0.95) season <- harmonic_block(rate = 1, order = 2, period = 12, D = 0.975)  outcome <- Poisson(lambda = \"rate\", data = data)  fitted.data <- fit_model(level, season,   AirPassengers = outcome )  var.vals <- coef(fitted.data)"},{"path":"/reference/coefficients.fitted_dlm.html","id":null,"dir":"Reference","previous_headings":"","what":"coefficients.fitted_dlm — coefficients.fitted_dlm","title":"coefficients.fitted_dlm — coefficients.fitted_dlm","text":"method wrapper coef method.","code":""},{"path":"/reference/coefficients.fitted_dlm.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"coefficients.fitted_dlm — coefficients.fitted_dlm","text":"","code":"# S3 method for fitted_dlm coefficients(object, ...)"},{"path":"/reference/coefficients.fitted_dlm.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"coefficients.fitted_dlm — coefficients.fitted_dlm","text":"object fitted_dlm object. ... Arguments passed coef.","code":""},{"path":"/reference/coefficients.fitted_dlm.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"coefficients.fitted_dlm — coefficients.fitted_dlm","text":"list containing: data data.frame: table model evaluated observed time. theta.mean matrix: mean latent states time. Dimensions n x t, t size t.eval n number latent states. theta.cov array: 3D-array containing covariance matrix latent states time. Dimensions n x n x t, t size t.eval n number latent states. lambda.mean matrix: mean linear predictor time. Dimensions k x t, t size t.eval k number linear predictors. lambda.cov array: 3D-array containing covariance matrix linear predictor time. Dimensions k x k x t, t size t.eval k number linear predictors. log.like, mae, mase, rae, mse, interval.score: metric value time. conj.param list: list containing, outcome, data.frame parameter conjugated distribution time.","code":""},{"path":[]},{"path":"/reference/colQuantile.html","id":null,"dir":"Reference","previous_headings":"","what":"colQuantile — colQuantile","title":"colQuantile — colQuantile","text":"function calculates column-wise quantile matrix.","code":""},{"path":"/reference/colQuantile.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"colQuantile — colQuantile","text":"","code":"colQuantile(X, q)"},{"path":"/reference/colQuantile.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"colQuantile — colQuantile","text":"X matrix. q numeric: number 0 1.","code":""},{"path":"/reference/colQuantile.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"colQuantile — colQuantile","text":"numeric: chosen quantile column X.","code":""},{"path":"/reference/convert_Gamma_Normal.html","id":null,"dir":"Reference","previous_headings":"","what":"convert_Gamma_Normal — convert_Gamma_Normal","title":"convert_Gamma_Normal — convert_Gamma_Normal","text":"Calculate parameters Inverse-Gamma best approximates given log-Normal distribution. approximation best sense minimizes KL divergence log-Normal Inverse-Gamma","code":""},{"path":"/reference/convert_Gamma_Normal.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"convert_Gamma_Normal — convert_Gamma_Normal","text":"","code":"convert_Gamma_Normal(ft, Qt, parms)"},{"path":"/reference/convert_Gamma_Normal.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"convert_Gamma_Normal — convert_Gamma_Normal","text":"ft vector: vector representing means normal distribution. Qt matrix: matrix representing covariance matrix normal distribution. parms list: list extra known parameters distribution. used function.","code":""},{"path":"/reference/convert_Gamma_Normal.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"convert_Gamma_Normal — convert_Gamma_Normal","text":"parameters conjugated distribution linear predictor.","code":""},{"path":[]},{"path":"/reference/convert_Multinom_Normal.html","id":null,"dir":"Reference","previous_headings":"","what":"convert_Multinom_Normal — convert_Multinom_Normal","title":"convert_Multinom_Normal — convert_Multinom_Normal","text":"Calculate parameters Dirichlet best approximates given log-Normal distribution. approximation best sense minimizes KL divergence log-Normal Dirichlet.","code":""},{"path":"/reference/convert_Multinom_Normal.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"convert_Multinom_Normal — convert_Multinom_Normal","text":"","code":"convert_Multinom_Normal(ft, Qt, parms = list())"},{"path":"/reference/convert_Multinom_Normal.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"convert_Multinom_Normal — convert_Multinom_Normal","text":"ft vector: vector representing means normal distribution. Qt matrix: matrix representing covariance matrix normal distribution. parms list: list extra known parameters distribution. used kernel.","code":""},{"path":"/reference/convert_Multinom_Normal.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"convert_Multinom_Normal — convert_Multinom_Normal","text":"parameters conjugated distribution linear predictor.","code":""},{"path":[]},{"path":"/reference/convert_multi_NG_Normal.html","id":null,"dir":"Reference","previous_headings":"","what":"convert_multi_NG_Normal — convert_multi_NG_Normal","title":"convert_multi_NG_Normal — convert_multi_NG_Normal","text":"Calculate parameters Normal-Gamma best approximates given Multivariate Normal distribution. distribution obtained outcome marginal. approximation best sense minimizes KL divergence Normal Normal-Gamma. approach, suppose first entry multivariate normal represents mean observed data second represent log variance.","code":""},{"path":"/reference/convert_multi_NG_Normal.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"convert_multi_NG_Normal — convert_multi_NG_Normal","text":"","code":"convert_multi_NG_Normal(ft, Qt, parms)"},{"path":"/reference/convert_multi_NG_Normal.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"convert_multi_NG_Normal — convert_multi_NG_Normal","text":"ft numeric: vector representing means normal distribution. Qt matrix: matrix representing covariance matrix normal distribution. parms list: list extra known parameters distribution. used kernel.","code":""},{"path":"/reference/convert_multi_NG_Normal.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"convert_multi_NG_Normal — convert_multi_NG_Normal","text":"parameters conjugated distribution linear predictor.","code":""},{"path":[]},{"path":"/reference/convert_Normal_Gamma.html","id":null,"dir":"Reference","previous_headings":"","what":"convert_Normal_Gamma — convert_Normal_Gamma","title":"convert_Normal_Gamma — convert_Normal_Gamma","text":"Calculates parameters log-Normal best approximates given Inverse-Gamma distribution. approximation best sense minimizes KL divergence Inverse-Gamma log-Normal","code":""},{"path":"/reference/convert_Normal_Gamma.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"convert_Normal_Gamma — convert_Normal_Gamma","text":"","code":"convert_Normal_Gamma(conj.param, parms)"},{"path":"/reference/convert_Normal_Gamma.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"convert_Normal_Gamma — convert_Normal_Gamma","text":"conj.param list: vector containing parameters Inverse-Gamma (alpha,beta). parms list: list extra known parameters distribution. used function.","code":""},{"path":"/reference/convert_Normal_Gamma.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"convert_Normal_Gamma — convert_Normal_Gamma","text":"parameters Normal distribution linear predictor.","code":""},{"path":[]},{"path":"/reference/convert_Normal_Multinom.html","id":null,"dir":"Reference","previous_headings":"","what":"convert_Normal_Multinom — convert_Normal_Multinom","title":"convert_Normal_Multinom — convert_Normal_Multinom","text":"Calculate parameters log-Normal best approximates given Dirichlet distribution. approximation best sense minimizes KL divergence Dirichlet log-Normal","code":""},{"path":"/reference/convert_Normal_Multinom.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"convert_Normal_Multinom — convert_Normal_Multinom","text":"","code":"convert_Normal_Multinom(conj.param, parms = list())"},{"path":"/reference/convert_Normal_Multinom.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"convert_Normal_Multinom — convert_Normal_Multinom","text":"conj.param list: vector containing concentration parameters Dirichlet. parms list: list extra known parameters distribution. used kernel.","code":""},{"path":"/reference/convert_Normal_Multinom.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"convert_Normal_Multinom — convert_Normal_Multinom","text":"parameters Normal distribution linear predictor.","code":""},{"path":[]},{"path":"/reference/convert_Normal_Poisson.html","id":null,"dir":"Reference","previous_headings":"","what":"convert_Normal_Poisson — convert_Normal_Poisson","title":"convert_Normal_Poisson — convert_Normal_Poisson","text":"Calculate parameters log-Normal best approximates given Gamma distribution. approximation best sense minimizes KL divergence Gamma log-Normal","code":""},{"path":"/reference/convert_Normal_Poisson.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"convert_Normal_Poisson — convert_Normal_Poisson","text":"","code":"convert_Normal_Poisson(conj.param, parms)"},{"path":"/reference/convert_Normal_Poisson.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"convert_Normal_Poisson — convert_Normal_Poisson","text":"conj.param list: vector containing parameters Gamma (alpha,beta). parms list: list extra known parameters distribution. used kernel.","code":""},{"path":"/reference/convert_Normal_Poisson.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"convert_Normal_Poisson — convert_Normal_Poisson","text":"parameters Normal distribution linear predictor.","code":""},{"path":[]},{"path":"/reference/convert_Poisson_Normal.html","id":null,"dir":"Reference","previous_headings":"","what":"convert_Poisson_Normal — convert_Poisson_Normal","title":"convert_Poisson_Normal — convert_Poisson_Normal","text":"Calculate parameters Gamma best approximates given log-Normal distribution. approximation best sense minimizes KL divergence log-Normal Gamma","code":""},{"path":"/reference/convert_Poisson_Normal.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"convert_Poisson_Normal — convert_Poisson_Normal","text":"","code":"convert_Poisson_Normal(ft, Qt, parms)"},{"path":"/reference/convert_Poisson_Normal.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"convert_Poisson_Normal — convert_Poisson_Normal","text":"ft numeric: vector representing means normal distribution. Qt matrix: matrix representing covariance matrix normal distribution. parms list: list extra known parameters distribution. used kernel.","code":""},{"path":"/reference/convert_Poisson_Normal.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"convert_Poisson_Normal — convert_Poisson_Normal","text":"parameters conjugated distribution linear predictor.","code":""},{"path":[]},{"path":"/reference/cornWheat.html","id":null,"dir":"Reference","previous_headings":"","what":"Corn and wheat prices from 1986 to 2014 — cornWheat","title":"Corn and wheat prices from 1986 to 2014 — cornWheat","text":"prices (U.S. Dollars) per bushel log returns corn wheat 1986-01-03 2014-10-10. observation corresponds price day, days present dataset.","code":""},{"path":"/reference/cornWheat.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Corn and wheat prices from 1986 to 2014 — cornWheat","text":"","code":"cornWheat"},{"path":"/reference/cornWheat.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Corn and wheat prices from 1986 to 2014 — cornWheat","text":"data frame 7,253 rows 5 columns: date date observation. corn.price, wheat.price price (U.S. Dollars) per bushel corn wheat, respectively. corn.log.return, wheat.log.return log returns corn wheat, respectively.","code":""},{"path":"/reference/cornWheat.html","id":"source","dir":"Reference","previous_headings":"","what":"Source","title":"Corn and wheat prices from 1986 to 2014 — cornWheat","text":"https://www.macrotrends.net/charts/commodities","code":""},{"path":"/reference/create_G.html","id":null,"dir":"Reference","previous_headings":"","what":"create_G — create_G","title":"create_G — create_G","text":"Creates matrix G G","code":""},{"path":"/reference/create_G.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"create_G — create_G","text":"","code":"create_G(S0, S1)"},{"path":"/reference/create_G.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"create_G — create_G","text":"S0 covariance matrix S1 Another covariance matrix","code":""},{"path":"/reference/dmvnorm.html","id":null,"dir":"Reference","previous_headings":"","what":"dmvnorm — dmvnorm","title":"dmvnorm — dmvnorm","text":"Calculates log density multivariate normal distribution mean mu covariance matrix Sigma.","code":""},{"path":"/reference/dmvnorm.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"dmvnorm — dmvnorm","text":"","code":"dmvnorm(x, mu, Sigma)"},{"path":"/reference/dmvnorm.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"dmvnorm — dmvnorm","text":"x Vector: value calculate density. mu Vector: mean vector Sigma Matrix: Covariance matrix.","code":""},{"path":"/reference/evaluate_max.html","id":null,"dir":"Reference","previous_headings":"","what":"evaluate_max — evaluate_max","title":"evaluate_max — evaluate_max","text":"Auxiliary function calculate axis limits gradation plots.","code":""},{"path":"/reference/evaluate_max.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"evaluate_max — evaluate_max","text":"","code":"evaluate_max(pre.max)"},{"path":"/reference/evaluate_max.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"evaluate_max — evaluate_max","text":"pre.max numeric: vector/matrix calculate axis limits gradation.","code":""},{"path":"/reference/evaluate_max.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"evaluate_max — evaluate_max","text":"list containing gradation axis, number ticks axis maximum value.","code":""},{"path":"/reference/eval_dlm_log_like.html","id":null,"dir":"Reference","previous_headings":"","what":"Auxiliary function for evaluating the prior density of a DLM — eval_dlm_log_like","title":"Auxiliary function for evaluating the prior density of a DLM — eval_dlm_log_like","text":"Evaluates prior density set parameters theta DLM. structure DLM taken fitted_dlm object passed input.","code":""},{"path":"/reference/eval_dlm_log_like.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Auxiliary function for evaluating the prior density of a DLM — eval_dlm_log_like","text":"","code":"eval_dlm_log_like(theta, model, lin.pred = FALSE)"},{"path":"/reference/eval_dlm_log_like.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Auxiliary function for evaluating the prior density of a DLM — eval_dlm_log_like","text":"theta Matrix: matrix representing set parameter evaluate density. size n x t, n number latent states t length time series; model fitted_dlm: fitted_dlm object. lin.pred boolean: flag indicating theta represents linear predictors.","code":""},{"path":"/reference/eval_dlm_log_like.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Auxiliary function for evaluating the prior density of a DLM — eval_dlm_log_like","text":"scalar representing log likelihood evaluated theta.","code":""},{"path":"/reference/eval_dlm_log_like.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Auxiliary function for evaluating the prior density of a DLM — eval_dlm_log_like","text":"","code":"data <- c(AirPassengers)  level <- polynomial_block(rate = 1, order = 2, D = 0.95) season <- harmonic_block(rate = 1, order = 2, period = 12, D = 0.975)  outcome <- Poisson(lambda = \"rate\", data = data)  fitted.data <- fit_model(level, season,   AirPassengers = outcome ) eval_dlm_log_like(fitted.data$mts, fitted.data) #> [1] -563.1491"},{"path":"/reference/eval_dlm_norm_const.html","id":null,"dir":"Reference","previous_headings":"","what":"Auxiliary function for evaluating normalizing constant for the posterior of a fitted DLM. — eval_dlm_norm_const","title":"Auxiliary function for evaluating normalizing constant for the posterior of a fitted DLM. — eval_dlm_norm_const","text":"Evaluates normalizing constant posterior fitted DLM.","code":""},{"path":"/reference/eval_dlm_norm_const.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Auxiliary function for evaluating normalizing constant for the posterior of a fitted DLM. — eval_dlm_norm_const","text":"","code":"eval_dlm_norm_const(model, lin.pred = model$n > 2 * model$k)"},{"path":"/reference/eval_dlm_norm_const.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Auxiliary function for evaluating normalizing constant for the posterior of a fitted DLM. — eval_dlm_norm_const","text":"model fitted_dlm: fitted_dlm object. lin.pred boolean: flag indicating normalizing constant calculated using linear predictors.","code":""},{"path":"/reference/eval_dlm_norm_const.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Auxiliary function for evaluating normalizing constant for the posterior of a fitted DLM. — eval_dlm_norm_const","text":"scalar representing normalizing constant posterior fitted DLM.","code":""},{"path":[]},{"path":"/reference/eval_dlm_norm_const.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Auxiliary function for evaluating normalizing constant for the posterior of a fitted DLM. — eval_dlm_norm_const","text":"","code":"data <- c(AirPassengers)  level <- polynomial_block(rate = 1, order = 2, D = 0.95) season <- harmonic_block(rate = 1, order = 2, period = 12, D = 0.975)  outcome <- Poisson(lambda = \"rate\", data = data)  fitted.data <- fit_model(level, season,   AirPassengers = outcome ) eval_dlm_norm_const(fitted.data) #> [1] -1316.08"},{"path":"/reference/eval_dlm_post.html","id":null,"dir":"Reference","previous_headings":"","what":"Auxiliary function for evaluating the posterior density of a DLM — eval_dlm_post","title":"Auxiliary function for evaluating the posterior density of a DLM — eval_dlm_post","text":"Evaluates density set parameters theta DLM. structure DLM taken fitted_dlm object passed input.","code":""},{"path":"/reference/eval_dlm_post.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Auxiliary function for evaluating the posterior density of a DLM — eval_dlm_post","text":"","code":"eval_dlm_post(theta, model, lin.pred = FALSE)"},{"path":"/reference/eval_dlm_post.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Auxiliary function for evaluating the posterior density of a DLM — eval_dlm_post","text":"theta Matrix: matrix representing set parameter evaluate density. size n x t, n number latent states t length time series; model fitted_dlm: fitted_dlm object. lin.pred boolean: flag indicating theta represents linear predictors.","code":""},{"path":"/reference/eval_dlm_post.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Auxiliary function for evaluating the posterior density of a DLM — eval_dlm_post","text":"scalar representing log density evaluated theta.","code":""},{"path":"/reference/eval_dlm_post.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Auxiliary function for evaluating the posterior density of a DLM — eval_dlm_post","text":"","code":"data <- c(AirPassengers)  level <- polynomial_block(rate = 1, order = 2, D = 0.95) season <- harmonic_block(rate = 1, order = 2, period = 12, D = 0.975)  outcome <- Poisson(lambda = \"rate\", data = data)  fitted.data <- fit_model(level, season,   AirPassengers = outcome ) eval_dlm_post(fitted.data$mts, fitted.data) #> [1] 3720.929"},{"path":"/reference/eval_dlm_prior.html","id":null,"dir":"Reference","previous_headings":"","what":"Auxiliary function for evaluating the prior density of a DLM — eval_dlm_prior","title":"Auxiliary function for evaluating the prior density of a DLM — eval_dlm_prior","text":"Evaluates prior density set parameters theta DLM. structure DLM taken fitted_dlm object passed input.","code":""},{"path":"/reference/eval_dlm_prior.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Auxiliary function for evaluating the prior density of a DLM — eval_dlm_prior","text":"","code":"eval_dlm_prior(theta, model, lin.pred = FALSE)"},{"path":"/reference/eval_dlm_prior.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Auxiliary function for evaluating the prior density of a DLM — eval_dlm_prior","text":"theta matrix: matrix representing set parameter evaluate density. size n x t, n number latent states t length time series; model fitted_dlm object: fitted_dlm object. lin.pred boolean: flag indicating theta represents linear predictors.","code":""},{"path":"/reference/eval_dlm_prior.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Auxiliary function for evaluating the prior density of a DLM — eval_dlm_prior","text":"scalar representing log density evaluated theta.","code":""},{"path":"/reference/eval_dlm_prior.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Auxiliary function for evaluating the prior density of a DLM — eval_dlm_prior","text":"","code":"data <- c(AirPassengers)  level <- polynomial_block(rate = 1, order = 2, D = 0.95) season <- harmonic_block(rate = 1, order = 2, period = 12, D = 0.975)  outcome <- Poisson(lambda = \"rate\", data = data)  fitted.data <- fit_model(level, season,   AirPassengers = outcome ) eval_dlm_prior(fitted.data$mts, fitted.data) #> [1] 3626.905"},{"path":"/reference/fit_model.html","id":null,"dir":"Reference","previous_headings":"","what":"Fitting kDGLM models — fit_model","title":"Fitting kDGLM models — fit_model","text":"Fit model given structure observed data. function can used supported family (see vignette).","code":""},{"path":"/reference/fit_model.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Fitting kDGLM models — fit_model","text":"","code":"fit_model(   ...,   smooth = TRUE,   p.monit = NA,   condition = \"TRUE\",   metric = \"log.like\",   lag = 1,   pred.cred = 0.95,   metric.cutoff = NA,   save.models = FALSE,   silent = FALSE )"},{"path":"/reference/fit_model.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Fitting kDGLM models — fit_model","text":"... dlm_block dlm_distr objects named values: structural blocks model (dlm_block objects), alongside model outcomes (dlm_distr object). least one block undefined, user must also provide value argument (see last example). smooth boolean: flag indicating smoothed distribution latent states calculated. p.monit numeric (optional): prior probability changes latent space variables part dynamic. used performing sensitivity analysis. condition character: character defining combinations undefined hyper parameter tested. See example details. used performing sensitivity analysis. metric character: name metric use model selection. One log-likelihood one-step-ahead prediction (\"log.like\"), Mean Absolute Scaled Error (\"mase\") (Hyndman Koehler 2006)  Interval Score (\"interval.score\") (Bracher et al. 2021) .  used performing sensitivity analysis. lag integer: number steps ahead used prediction calculating metrics. lag<0, predictions made using smoothed distribution latent states.  used performing sensitivity analysis. pred.cred numeric: number 0 1 (included) indicating credibility interval predictions. within valid range values, 0.95 used. used performing sensitivity analysis. metric.cutoff integer: number observations ignore calculating metrics. Default 1/10 number observations (rounded ). used performing sensitivity analysis. save.models boolean: flag indicating evaluated models saved. FALSE, best model (according chosen metric) saved. used performing sensitivity analysis. silent boolean: flag indicating progress bar printed. used performing sensitivity analysis.","code":""},{"path":"/reference/fit_model.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Fitting kDGLM models — fit_model","text":"fitted_dlm object.","code":""},{"path":"/reference/fit_model.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Fitting kDGLM models — fit_model","text":"main function kDGLM package, used fit models. details implementation see  dos Santos et al. (2024) . details methodology see  Alves et al. (2024) . details Dynamic Linear Models see  West Harrison (1997)  Petris et al. (2009) .","code":""},{"path":[]},{"path":"/reference/fit_model.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Fitting kDGLM models — fit_model","text":"","code":"# Poisson case data <- c(AirPassengers)  level <- polynomial_block(rate = 1, order = 2, D = 0.95) season <- harmonic_block(rate = 1, order = 2, period = 12, D = 0.975)  outcome <- Poisson(lambda = \"rate\", data = data)  fitted.data <- fit_model(level, season,   AirPassengers = outcome ) summary(fitted.data) #> Fitted DGLM with 1 outcomes. #>  #> distributions: #>     AirPassengers: Poisson #>  #> --- #> No static coeficients. #> --- #> See the coef.fitted_dlm for the coeficients with temporal dynamic. #>  #> One-step-ahead prediction #> Log-likelihood        : -580.2514 #> Interval Score        : 129.48462 #> Mean Abs. Scaled Error:   0.47013 #> ---  plot(fitted.data, plot.pkg = \"base\")   ##################################################################  # Multinomial case structure <- (   polynomial_block(p = 1, order = 2, D = 0.95) +     harmonic_block(p = 1, period = 12, D = 0.975) +     noise_block(p = 1, R1 = 0.1) +     regression_block(p = chickenPox$date >= as.Date(\"2013-09-01\"))   # Vaccine was introduced in September of 2013 ) * 4  outcome <- Multinom(p = structure$pred.names, data = chickenPox[, c(2, 3, 4, 6, 5)]) fitted.data <- fit_model(structure, chickenPox = outcome) summary(fitted.data) #> Fitted DGLM with 1 outcomes. #>  #> distributions: #>     chickenPox: Multinomial #>  #> Static coeficients (smoothed): #>                  Estimate Std. Error   t value Pr(>|t|) #> Var.Reg.1         0.38672    0.25101  1.54061    0.123    #> Var.Reg.2         0.46804    0.26503  1.76600    0.077    #> Var.Reg.3         0.48480    0.28504  1.70080    0.089    #> Var.Reg.4        -0.26821    0.24810 -1.08105    0.280    #> --- #> Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1 #>  #> --- #> See the coef.fitted_dlm for the coeficients with temporal dynamic. #>  #> One-step-ahead prediction #> Log-likelihood        : -1962.023 #> Interval Score        : 167.73519 #> Mean Abs. Scaled Error:   0.77385 #> --- plot(fitted.data, plot.pkg = \"base\")   ##################################################################  # Univariate Normal case structure <- polynomial_block(mu = 1, D = 0.95) +   polynomial_block(V = 1, D = 0.95)  outcome <- Normal(mu = \"mu\", V = \"V\", data = cornWheat$corn.log.return[1:500]) fitted.data <- fit_model(structure, corn = outcome) summary(fitted.data) #> Fitted DGLM with 1 outcomes. #>  #> distributions: #>     corn: Normal #>  #> --- #> No static coeficients. #> --- #> See the coef.fitted_dlm for the coeficients with temporal dynamic. #>  #> One-step-ahead prediction #> Log-likelihood        : 1277.54 #> Interval Score        : 0.07564 #> Mean Abs. Scaled Error: 0.76327 #> --- plot(fitted.data, plot.pkg = \"base\")   ##################################################################  # Bivariate Normal case structure <- (polynomial_block(mu = 1, D = 0.95) +   polynomial_block(V = 1, D = 0.95)) * 2 +   polynomial_block(rho = 1, D = 0.95)  outcome <- Normal(   mu = c(\"mu.1\", \"mu.2\"),   V = matrix(c(\"V.1\", \"rho\", \"rho\", \"V.2\"), 2, 2),   data = cornWheat[1:500, c(4, 5)] ) fitted.data <- fit_model(structure, cornWheat = outcome) summary(fitted.data) #> Fitted DGLM with 1 outcomes. #>  #> distributions: #>     cornWheat: Normal #>  #> --- #> No static coeficients. #> --- #> See the coef.fitted_dlm for the coeficients with temporal dynamic. #>  #> One-step-ahead prediction #> Log-likelihood        : 2557.802 #> Interval Score        : 0.07505 #> Mean Abs. Scaled Error: 0.74750 #> --- plot(fitted.data, plot.pkg = \"base\")   ##################################################################  # Gamma case structure <- polynomial_block(mu = 1, D = 0.95)  outcome <- Gamma(phi = 0.5, mu = \"mu\", data = cornWheat$corn.log.return[1:500]**2) fitted.data <- fit_model(structure, corn = outcome) summary(fitted.data) #> Fitted DGLM with 1 outcomes. #>  #> distributions: #>     corn: Gamma #>  #> --- #> No static coeficients. #> --- #> See the coef.fitted_dlm for the coeficients with temporal dynamic. #>  #> One-step-ahead prediction #> Log-likelihood        : -Inf #> Interval Score        : 0.00199 #> Mean Abs. Scaled Error: 0.93924 #> --- plot(fitted.data, plot.pkg = \"base\")   ################################################################## # \\donttest{ # Sensitivity analysis data <- c(AirPassengers)  level <- polynomial_block(rate = 1, order = 2, D = \"D.level\") season <- harmonic_block(rate = \"sazo.effect\", order = 2, period = 12, D = \"D.sazo\")  outcome <- Poisson(lambda = \"rate\", data = data)  fit_model(level, season, outcome,   sazo.effect = c(0, 1),   D.level = c(seq.int(0.8, 1, l = 11)),   D.sazo = c(seq.int(0.95, 1, l = 11)),   condition = \"sazo.effect==1 | D.sazo==1\" ) #>  [==================================================] - 99.24% - ETA - NA #> Error in rep(\" \", 50 - n.bar): invalid 'times' argument # }"},{"path":"/reference/fit_model_single.html","id":null,"dir":"Reference","previous_headings":"","what":"Fitting one kDGLM models — fit_model_single","title":"Fitting one kDGLM models — fit_model_single","text":"Fits one model given structure observed data. function can used supported family (see vignette).","code":""},{"path":"/reference/fit_model_single.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Fitting one kDGLM models — fit_model_single","text":"","code":"fit_model_single(structure, outcomes, smooth = TRUE, p.monit = NA)"},{"path":"/reference/fit_model_single.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Fitting one kDGLM models — fit_model_single","text":"structure dlm_block: structural blocks model. block must completely defined. outcomes dlm_distr list dlm_distr objects: model outcomes. smooth boolean: flag indicating smoothed distribution latent states calculated. p.monit numeric (optional): prior probability changes latent space variables part dynamic.","code":""},{"path":"/reference/fit_model_single.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Fitting one kDGLM models — fit_model_single","text":"fitted_dlm object.","code":""},{"path":"/reference/forecast.fitted_dlm.html","id":null,"dir":"Reference","previous_headings":"","what":"Auxiliary function for forecasting — forecast.fitted_dlm","title":"Auxiliary function for forecasting — forecast.fitted_dlm","text":"Auxiliary function forecasting","code":""},{"path":"/reference/forecast.fitted_dlm.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Auxiliary function for forecasting — forecast.fitted_dlm","text":"","code":"# S3 method for fitted_dlm forecast(   object,   t = 1,   plot = ifelse(requireNamespace(\"plotly\", quietly = TRUE), \"plotly\",     ifelse(requireNamespace(\"ggplot2\", quietly = TRUE), \"ggplot2\", \"base\")),   pred.cred = 0.95,   ... )"},{"path":"/reference/forecast.fitted_dlm.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Auxiliary function for forecasting — forecast.fitted_dlm","text":"object fitted_dlm object: fitted model use predictions. t numeric: Time window prediction. plot boolean character: flag indicating plot produced. one FALSE, TRUE, 'base', 'ggplot2' 'plotly'. pred.cred numeric: credibility level C... ... Extra variables necessary prediction (covariates, etc.).","code":""},{"path":"/reference/forecast.fitted_dlm.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Auxiliary function for forecasting — forecast.fitted_dlm","text":"list containing: data data.frame: data frame contain mean, variance credibility intervals outcomes, including observed data predictions future observations. forecast data.frame: data, restricted predictions future observations. outcomes list: named list containing predictions outcome. element list list containing predictions (mean, variance credibility intervals), distribution linear predictor parameter observational model parameters predictive distribution (available). theta.mean matrix: matrix values latent states time. Dimensions n x t, n number latent states theta.cov array: 3D-array covariance latent states time. Dimensions n x n x t, n number latent predictors. lambda.mean matrix: matrix values linear predictors time. Dimensions k x t, k number linear predictors lambda.cov array: 3D-array covariance linear predictors time. Dimensions k x k x t, k number linear predictors. plot (chosen): plotly ggplot object. list containing: data data.frame: table model evaluated observed time, plus forecasted period. forecast data.frame: table model evaluated forecasted period. outcomes list: list containing parameters predictive distribution outcome forecasted period. theta.mean matrix: mean latent states forecasted time. Dimensions n x t.forecast, t.forecast size forecast windows n number latent states. theta.cov array: 3D-array containing covariance matrix latent states  forecasted time. Dimensions n x n x t.forecast, t.forecast size forecast windows n number latent states. lambda.mean matrix: mean linear predictor forecasted time. Dimensions k x t.forecast, t.forecast size forecast windows k number linear predictors. lambda.cov array: 3D-array containing covariance matrix linear predictor forecasted time. Dimensions k x k x t.forecast, t.forecast size forecast windows k number linear predictors.","code":""},{"path":"/reference/forecast.fitted_dlm.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Auxiliary function for forecasting — forecast.fitted_dlm","text":"covariate necessary forecasting, passed named argument. name must follow structure: <block name>.Covariate<.index>. one covariate associated block index omitted. pulse necessary forecasting, passed named argument. name must follow structure: <block name>.Pulse<.index>. one pulse associated block index omitted. user may pass observed values prediction windows (optional). See example. special case, model Multinomial outcome, user may pass N parameter instead observations. offset necessary forecasting, passed syntax observed data. See example.","code":""},{"path":[]},{"path":"/reference/forecast.fitted_dlm.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Auxiliary function for forecasting — forecast.fitted_dlm","text":"","code":"structure <-   polynomial_block(p = 1, order = 2, D = 0.95) +   harmonic_block(p = 1, period = 12, D = 0.975) +   noise_block(p = 1, R1 = 0.1) +   regression_block(     p = chickenPox$date >= as.Date(\"2013-09-1\"),     # Vaccine was introduced in September of 2013     name = \"Vaccine\"   )  outcome <- Multinom(p = c(\"p.1\", \"p.2\"), data = chickenPox[, c(2, 3, 5)]) fitted.data <- fit_model(structure * 2,   chickenPox = outcome )  forecast(fitted.data, 24,   chickenPox = list(Total = rep(175, 24)), # Optional   Vaccine.1.Covariate = rep(TRUE, 24),   Vaccine.2.Covariate = rep(TRUE, 24) ) #> Scale for y is already present. #> Adding another scale for y, which will replace the existing scale. #> $data #>     Time                   Serie Observation Prediction  Variance C.I.lower #> 1      1     chickenPox.< 5 year         218  213.56974 1944.8860       127 #> 2      2     chickenPox.< 5 year         215  214.00177 1360.3010       142 #> 3      3     chickenPox.< 5 year         256  250.66942 1675.6397       170 #> 4      4     chickenPox.< 5 year         271  265.06469 1562.4174       186 #> 5      5     chickenPox.< 5 year         348  336.74105 2074.3296       244 #> 6      6     chickenPox.< 5 year         333  322.77968 1687.9260       239 #> 7      7     chickenPox.< 5 year         397  387.58815 2287.1740       290 #> 8      8     chickenPox.< 5 year         459  478.80415 3251.8539       362 #> 9      9     chickenPox.< 5 year         811  775.68707 6277.8685       611 #> 10    10     chickenPox.< 5 year         932  896.40928 8250.1825       708 #> 11    11     chickenPox.< 5 year         730  698.85927 5911.6826       541 #> 12    12     chickenPox.< 5 year         460  455.27873 3354.9501       338 #> 13    13     chickenPox.< 5 year         214  227.74120 1116.6561       162 #> 14    14     chickenPox.< 5 year         133  148.73901  562.4871       102 #> 15    15     chickenPox.< 5 year         162  156.09889  612.3608       108 #> 16    16     chickenPox.< 5 year         227  197.27490  890.1128       139 #> 17    17     chickenPox.< 5 year         231  213.21307  956.3178       152 #> 18    18     chickenPox.< 5 year         179  196.88730  742.3365       143 #> 19    19     chickenPox.< 5 year         256  262.68672 1087.5723       196 #> 20    20     chickenPox.< 5 year         343  333.38235 1469.9184       256 #> 21    21     chickenPox.< 5 year         403  428.46452 2198.4787       333 #> 22    22     chickenPox.< 5 year         544  515.88506 3055.9950       403 #> 23    23     chickenPox.< 5 year         518  483.16453 2858.2936       374 #> 24    24     chickenPox.< 5 year         446  423.31318 2538.7060       322 #> 25    25     chickenPox.< 5 year         248  253.52498 1125.8304       187 #> 26    26     chickenPox.< 5 year         126  134.89325  400.4484        96 #> 27    27     chickenPox.< 5 year         113  143.58286  486.8892       101 #> 28    28     chickenPox.< 5 year         152  140.82415  458.8652        99 #> 29    29     chickenPox.< 5 year         157  154.45380  492.0809       111 #> 30    30     chickenPox.< 5 year         181  177.76916  537.7032       132 #> 31    31     chickenPox.< 5 year         222  226.94000  697.2585       174 #> 32    32     chickenPox.< 5 year         292  284.92774  905.0167       224 #> 33    33     chickenPox.< 5 year         521  489.54092 2337.6367       391 #> 34    34     chickenPox.< 5 year         587  574.53647 3233.9224       458 #> 35    35     chickenPox.< 5 year         495  456.20134 2279.2700       359 #> 36    36     chickenPox.< 5 year         363  322.96270 1376.3427       248 #> 37    37     chickenPox.< 5 year         157  185.38548  580.0217       137 #> 38    38     chickenPox.< 5 year         102  118.02545  292.8830        84 #> 39    39     chickenPox.< 5 year         132  136.74766  413.3607        97 #> 40    40     chickenPox.< 5 year         155  144.03607  454.3267       102 #> 41    41     chickenPox.< 5 year         217  211.17818  864.9089       153 #> 42    42     chickenPox.< 5 year         364  326.42901 1749.6136       244 #> 43    43     chickenPox.< 5 year         333  322.01557 1505.9702       244 #> 44    44     chickenPox.< 5 year         308  318.64367 1374.7130       244 #> 45    45     chickenPox.< 5 year         535  534.19956 3076.1298       421 #> 46    46     chickenPox.< 5 year         705  682.39558 4940.4660       539 #> 47    47     chickenPox.< 5 year         623  569.46819 3723.4364       445 #> 48    48     chickenPox.< 5 year         542  464.81368 2866.8987       357 #> 49    49     chickenPox.< 5 year         295  277.10907 1267.9996       206 #> 50    50     chickenPox.< 5 year         108  124.79874  335.7050        89 #> 51    51     chickenPox.< 5 year          85  108.42661  289.9193        75 #> 52    52     chickenPox.< 5 year         122  124.89530  383.6504        87 #> 53    53     chickenPox.< 5 year         145  159.13240  572.7219       112 #> 54    54     chickenPox.< 5 year         208  187.37599  695.5368       135 #> 55    55     chickenPox.< 5 year         191  201.93811  723.6880       149 #> 56    56     chickenPox.< 5 year         191  195.93937  634.1869       146 #> 57    57     chickenPox.< 5 year         289  291.05078 1297.0990       219 #> 58    58     chickenPox.< 5 year         374  358.52661 1984.8137       269 #> 59    59     chickenPox.< 5 year         305  285.26500 1375.5849       211 #> 60    60     chickenPox.< 5 year         297  262.80329 1306.5271       191 #> 61    61     chickenPox.< 5 year         156  156.70840  559.5527       111 #> 62    62     chickenPox.< 5 year          64   77.28622  171.4541        52 #> 63    63     chickenPox.< 5 year          97   98.03901  277.0873        66 #> 64    64     chickenPox.< 5 year         119   97.65991  275.6222        66 #> 65    65     chickenPox.< 5 year          96  100.83344  289.2801        68 #> 66    66     chickenPox.< 5 year         108  113.75408  343.7215        78 #> 67    67     chickenPox.< 5 year         127  141.24812  484.9784        98 #> 68    68     chickenPox.< 5 year         143  147.09456  500.8693       103 #> 69    69     chickenPox.< 5 year         191  185.07468  764.9394       131 #> 70    70     chickenPox.< 5 year         195  192.06278  849.4044       135 #> 71    71     chickenPox.< 5 year         153  147.21681  545.8692       102 #> 72    72     chickenPox.< 5 year         134  128.46826  453.9837        87 #> 73    73     chickenPox.< 5 year          79   92.58644  268.2073        61 #> 74    74     chickenPox.< 5 year          76   72.12331  178.7961        47 #> 75    75     chickenPox.< 5 year          88   81.13450  224.7404        53 #> 76    76     chickenPox.< 5 year          76   79.53448  215.1652        52 #> 77    77     chickenPox.< 5 year          84   91.31704  265.2800        60 #> 78    78     chickenPox.< 5 year          94   89.40094  241.5017        60 #> 79    79     chickenPox.< 5 year         126  123.78420  421.6119        84 #> 80    80     chickenPox.< 5 year         135  134.14956  487.2676        91 #> 81    81     chickenPox.< 5 year         152  149.08468  607.8418       101 #> 82    82     chickenPox.< 5 year         193  192.93190 1031.5099       131 #> 83    83     chickenPox.< 5 year         151  146.79368  642.2902        98 #> 84    84     chickenPox.< 5 year         146  133.67929  558.6623        89 #> 85    85     chickenPox.< 5 year         105  108.34111  390.2422        71 #> 86    86     chickenPox.< 5 year          72   76.92751  213.2169        49 #> 87    87     chickenPox.< 5 year          90   93.75019  303.3861        61 #> 88    88     chickenPox.< 5 year          77   73.56937  192.1087        47 #> 89    89     chickenPox.< 5 year          90   86.41401  248.4576        56 #> 90    90     chickenPox.< 5 year          87   94.25762  282.1017        62 #> 91    91     chickenPox.< 5 year         110  105.92999  342.7935        71 #> 92    92     chickenPox.< 5 year         134  129.83282  506.9293        87 #> 93    93     chickenPox.< 5 year         132  134.28783  562.2911        89 #> 94    94     chickenPox.< 5 year         151  150.04932  724.3239        99 #> 95    95     chickenPox.< 5 year         138  128.53728  561.1646        84 #> 96    96     chickenPox.< 5 year         104  104.28359  389.3101        67 #> 97    97     chickenPox.< 5 year          67   91.44475  308.2993        58 #> 98    98     chickenPox.< 5 year          58   64.34194  161.5043        40 #> 99    99     chickenPox.< 5 year          94   85.10786  254.1365        55 #> 100  100     chickenPox.< 5 year          79   72.60289  184.3695        47 #> 101  101     chickenPox.< 5 year          93   93.45190  278.0868        62 #> 102  102     chickenPox.< 5 year          84   76.15672  187.1512        50 #> 103  103     chickenPox.< 5 year          96   99.99475  304.1102        67 #> 104  104     chickenPox.< 5 year          82   83.92861  226.5444        55 #> 105  105     chickenPox.< 5 year          80   88.93602  260.4904        58 #> 106  106     chickenPox.< 5 year          92   91.21889  283.4215        59 #> 107  107     chickenPox.< 5 year          77   80.61587  232.7325        52 #> 108  108     chickenPox.< 5 year          79   81.15405  236.0541        52 #> 109  109     chickenPox.< 5 year          73   72.56088  189.9907        47 #> 110  110     chickenPox.< 5 year          54   63.60043  146.3446        41 #> 111  111     chickenPox.< 5 year         133  100.45350  312.1120        67 #> 112  112     chickenPox.< 5 year         162  102.69799  319.2682        69 #> 113  113     chickenPox.< 5 year         102   85.18424  234.5429        56 #> 114  114     chickenPox.< 5 year          70   74.47020  191.4051        48 #> 115  115     chickenPox.< 5 year          79   80.13631  229.4112        52 #> 116  116     chickenPox.< 5 year          59   74.59278  218.5768        47 #> 117  117     chickenPox.< 5 year          49   68.03241  200.5202        42 #> 118  118     chickenPox.< 5 year          63   64.14745  192.6557        38 #> 119  119     chickenPox.< 5 year          63   66.60609  219.2651        39 #> 120  120     chickenPox.< 5 year          48   51.25208  146.9337        29 #> 121    1 chickenPox.5 to 9 years          64   65.10525 1944.8860        16 #> 122    2 chickenPox.5 to 9 years          43   51.61887 1360.3010        14 #> 123    3 chickenPox.5 to 9 years          60   60.18322 1675.6397        17 #> 124    4 chickenPox.5 to 9 years          47   53.97332 1562.4174        14 #> 125    5 chickenPox.5 to 9 years          66   68.13572 2074.3296        20 #>     C.I.upper type #> 1         298  Fit #> 2         285  Fit #> 3         329  Fit #> 4         340  Fit #> 5         422  Fit #> 6         399  Fit #> 7         476  Fit #> 8         584  Fit #> 9         920  Fit #> 10       1062  Fit #> 11        840  Fit #> 12        564  Fit #> 13        292  Fit #> 14        195  Fit #> 15        204  Fit #> 16        255  Fit #> 17        273  Fit #> 18        249  Fit #> 19        325  Fit #> 20        405  Fit #> 21        516  Fit #> 22        618  Fit #> 23        583  Fit #> 24        518  Fit #> 25        318  Fit #> 26        174  Fit #> 27        187  Fit #> 28        183  Fit #> 29        197  Fit #> 30        222  Fit #> 31        277  Fit #> 32        341  Fit #> 33        579  Fit #> 34        680  Fit #> 35        545  Fit #> 36        393  Fit #> 37        231  Fit #> 38        151  Fit #> 39        176  Fit #> 40        186  Fit #> 41        268  Fit #> 42        407  Fit #> 43        396  Fit #> 44        388  Fit #> 45        637  Fit #> 46        813  Fit #> 47        683  Fit #> 48        566  Fit #> 49        345  Fit #> 50        160  Fit #> 51        142  Fit #> 52        163  Fit #> 53        206  Fit #> 54        238  Fit #> 55        254  Fit #> 56        244  Fit #> 57        359  Fit #> 58        443  Fit #> 59        356  Fit #> 60        332  Fit #> 61        203  Fit #> 62        103  Fit #> 63        131  Fit #> 64        131  Fit #> 65        134  Fit #> 66        150  Fit #> 67        184  Fit #> 68        191  Fit #> 69        239  Fit #> 70        249  Fit #> 71        193  Fit #> 72        170  Fit #> 73        125  Fit #> 74         99  Fit #> 75        111  Fit #> 76        109  Fit #> 77        124  Fit #> 78        120  Fit #> 79        164  Fit #> 80        178  Fit #> 81        198  Fit #> 82        256  Fit #> 83        197  Fit #> 84        181  Fit #> 85        148  Fit #> 86        106  Fit #> 87        129  Fit #> 88        101  Fit #> 89        118  Fit #> 90        128  Fit #> 91        143  Fit #> 92        175  Fit #> 93        182  Fit #> 94        204  Fit #> 95        176  Fit #> 96        144  Fit #> 97        127  Fit #> 98         90  Fit #> 99        117  Fit #> 100       100  Fit #> 101       127  Fit #> 102       104  Fit #> 103       135  Fit #> 104       114  Fit #> 105       121  Fit #> 106       125  Fit #> 107       111  Fit #> 108       112  Fit #> 109       100  Fit #> 110        88  Fit #> 111       136  Fit #> 112       139  Fit #> 113       116  Fit #> 114       102  Fit #> 115       111  Fit #> 116       105  Fit #> 117        97  Fit #> 118        93  Fit #> 119        97  Fit #> 120        76  Fit #> 121       140  Fit #> 122       108  Fit #> 123       124  Fit #> 124       114  Fit #> 125       139  Fit #>  [ reached 'max' / getOption(\"max.print\") -- omitted 307 rows ] #>  #> $forecast #>    Time                     Serie Observation Variance Prediction C.I.lower #> 1   121       chickenPox.< 5 year          NA 149.4347   49.63073        27 #> 2   122       chickenPox.< 5 year          NA 149.4347   48.42213        26 #> 3   123       chickenPox.< 5 year          NA 149.4347   47.78840        25 #> 4   124       chickenPox.< 5 year          NA 149.4347   47.79864        25 #> 5   125       chickenPox.< 5 year          NA 149.4347   48.32058        24 #> 6   126       chickenPox.< 5 year          NA 149.4347   49.00718        24 #> 7   127       chickenPox.< 5 year          NA 149.4347   49.40287        24 #> 8   128       chickenPox.< 5 year          NA 149.4347   49.14310        23 #> 9   129       chickenPox.< 5 year          NA 149.4347   48.13517        21 #> 10  130       chickenPox.< 5 year          NA 149.4347   46.56745        19 #> 11  131       chickenPox.< 5 year          NA 149.4347   44.74058        17 #> 12  132       chickenPox.< 5 year          NA 149.4347   42.90972        16 #> 13  133       chickenPox.< 5 year          NA 149.4347   41.27574        15 #> 14  134       chickenPox.< 5 year          NA 149.4347   40.03981        13 #> 15  135       chickenPox.< 5 year          NA 149.4347   39.38220        13 #> 16  136       chickenPox.< 5 year          NA 149.4347   39.37087        12 #> 17  137       chickenPox.< 5 year          NA 149.4347   39.88988        12 #> 18  138       chickenPox.< 5 year          NA 149.4347   40.63895        12 #> 19  139       chickenPox.< 5 year          NA 149.4347   41.21720        11 #> 20  140       chickenPox.< 5 year          NA 149.4347   41.27810        10 #> 21  141       chickenPox.< 5 year          NA 149.4347   40.67993         9 #> 22  142       chickenPox.< 5 year          NA 149.4347   39.51596         8 #> 23  143       chickenPox.< 5 year          NA 149.4347   38.00802         7 #> 24  144       chickenPox.< 5 year          NA 149.4347   36.39376         6 #> 25  121   chickenPox.5 to 9 years          NA 149.4347   21.84474         7 #> 26  122   chickenPox.5 to 9 years          NA 149.4347   18.81722         5 #> 27  123   chickenPox.5 to 9 years          NA 149.4347   16.63545         4 #> 28  124   chickenPox.5 to 9 years          NA 149.4347   15.57295         3 #> 29  125   chickenPox.5 to 9 years          NA 149.4347   15.65854         3 #> 30  126   chickenPox.5 to 9 years          NA 149.4347   16.81260         3 #> 31  127   chickenPox.5 to 9 years          NA 149.4347   18.83476         4 #> 32  128   chickenPox.5 to 9 years          NA 149.4347   21.28412         5 #> 33  129   chickenPox.5 to 9 years          NA 149.4347   23.42408         5 #> 34  130   chickenPox.5 to 9 years          NA 149.4347   24.43135         5 #> 35  131   chickenPox.5 to 9 years          NA 149.4347   23.83661         5 #> 36  132   chickenPox.5 to 9 years          NA 149.4347   21.84320         4 #> 37  133   chickenPox.5 to 9 years          NA 149.4347   19.20289         3 #> 38  134   chickenPox.5 to 9 years          NA 149.4347   16.75421         2 #> 39  135   chickenPox.5 to 9 years          NA 149.4347   15.04688         1 #> 40  136   chickenPox.5 to 9 years          NA 149.4347   14.29210         1 #> 41  137   chickenPox.5 to 9 years          NA 149.4347   14.50365         1 #> 42  138   chickenPox.5 to 9 years          NA 149.4347   15.60631         1 #> 43  139   chickenPox.5 to 9 years          NA 149.4347   17.42073         1 #> 44  140   chickenPox.5 to 9 years          NA 149.4347   19.56488         1 #> 45  141   chickenPox.5 to 9 years          NA 149.4347   21.41461         1 #> 46  142   chickenPox.5 to 9 years          NA 149.4347   22.28607         1 #> 47  143   chickenPox.5 to 9 years          NA 149.4347   21.80527         1 #> 48  144   chickenPox.5 to 9 years          NA 149.4347   20.16313         1 #> 49  121 chickenPox.15 to 49 years          NA 149.4347   96.52452        70 #> 50  122 chickenPox.15 to 49 years          NA 149.4347  100.76065        74 #> 51  123 chickenPox.15 to 49 years          NA 149.4347  103.57615        76 #> 52  124 chickenPox.15 to 49 years          NA 149.4347  104.62841        77 #> 53  125 chickenPox.15 to 49 years          NA 149.4347  104.02089        75 #> 54  126 chickenPox.15 to 49 years          NA 149.4347  102.18022        72 #> 55  127 chickenPox.15 to 49 years          NA 149.4347   99.76237        69 #> 56  128 chickenPox.15 to 49 years          NA 149.4347   97.57278        65 #> 57  129 chickenPox.15 to 49 years          NA 149.4347   96.44075        63 #> 58  130 chickenPox.15 to 49 years          NA 149.4347   97.00120        62 #> 59  131 chickenPox.15 to 49 years          NA 149.4347   99.42281        64 #> 60  132 chickenPox.15 to 49 years          NA 149.4347  103.24708        67 #> 61  133 chickenPox.15 to 49 years          NA 149.4347  107.52137        71 #> 62  134 chickenPox.15 to 49 years          NA 149.4347  111.20599        75 #> 63  135 chickenPox.15 to 49 years          NA 149.4347  113.57093        76 #> 64  136 chickenPox.15 to 49 years          NA 149.4347  114.33703        76 #> 65  137 chickenPox.15 to 49 years          NA 149.4347  113.60648        74 #> 66  138 chickenPox.15 to 49 years          NA 149.4347  111.75474        71 #> 67  139 chickenPox.15 to 49 years          NA 149.4347  109.36207        66 #> 68  140 chickenPox.15 to 49 years          NA 149.4347  107.15702        62 #> 69  141 chickenPox.15 to 49 years          NA 149.4347  105.90546        60 #> 70  142 chickenPox.15 to 49 years          NA 149.4347  106.19797        59 #> 71  143 chickenPox.15 to 49 years          NA 149.4347  108.18671        60 #> 72  144 chickenPox.15 to 49 years          NA 149.4347  111.44311        63 #>    C.I.upper #> 1         75 #> 2         74 #> 3         74 #> 4         75 #> 5         76 #> 6         78 #> 7         80 #> 8         80 #> 9         81 #> 10        80 #> 11        79 #> 12        77 #> 13        76 #> 14        75 #> 15        75 #> 16        75 #> 17        77 #> 18        80 #> 19        82 #> 20        84 #> 21        85 #> 22        85 #> 23        84 #> 24        82 #> 25        42 #> 26        38 #> 27        36 #> 28        35 #> 29        36 #> 30        38 #> 31        42 #> 32        46 #> 33        50 #> 34        53 #> 35        53 #> 36        50 #> 37        47 #> 38        44 #> 39        42 #> 40        41 #> 41        43 #> 42        46 #> 43        50 #> 44        55 #> 45        59 #> 46        62 #> 47        62 #> 48        60 #> 49       122 #> 50       126 #> 51       129 #> 52       131 #> 53       131 #> 54       130 #> 55       129 #> 56       128 #> 57       128 #> 58       129 #> 59       132 #> 60       136 #> 61       140 #> 62       143 #> 63       145 #> 64       146 #> 65       147 #> 66       146 #> 67       146 #> 68       145 #> 69       146 #> 70       147 #> 71       149 #> 72       151 #>  #> $outcomes #> $outcomes$chickenPox #> $outcomes$chickenPox$conj.param #>       alpha_1  alpha_2   alpha_3 #> 121 14.776264 6.503706 28.737675 #> 122 13.732912 5.336718 28.576545 #> 123 12.827580 4.465362 27.802380 #> 124 12.015628 3.914730 26.301504 #> 125 11.245151 3.644050 24.207711 #> 126 10.459954 3.588434 21.809055 #> 127  9.622953 3.668735 19.432245 #> 128  8.745467 3.787705 17.363973 #> 129  7.886815 3.837972 15.801552 #> 130  7.117000 3.733894 14.824896 #> 131  6.478673 3.451667 14.396949 #> 132  5.975437 3.041797 14.377776 #> 133  5.580470 2.596226 14.536864 #> 134  5.254112 2.198524 14.592696 #> 135  4.962072 1.895874 14.309693 #> 136  4.683021 1.699992 13.599970 #> 137  4.403397 1.601041 12.540888 #> 138  4.111537 1.578927 11.306488 #> 139  3.801517 1.606737 10.086608 #> 140  3.482312 1.650537  9.040004 #> 141  3.178261 1.673091  8.274233 #> 142  2.916131 1.644629  7.837015 #> 143  2.710720 1.555145  7.715842 #> 144  2.559856 1.418230  7.838660 #>  #> $outcomes$chickenPox$ft #>            [,1]       [,2]       [,3]       [,4]       [,5]       [,6] #> [1,] -0.6819068 -0.7520426 -0.7949168 -0.8064766 -0.7910596 -0.7602321 #> [2,] -1.5471819 -1.7569829 -1.9268112 -2.0188749 -2.0162187 -1.9272676 #>            [,7]       [,8]       [,9]      [,10]      [,11]     [,12]     [,13] #> [1,] -0.7296896 -0.7150511 -0.7276742 -0.7716119 -0.8425262 -0.928851 -1.014891 #> [2,] -1.7835693 -1.6313410 -1.5190853 -1.4845943 -1.5448231 -1.691347 -1.892618 #>          [,14]     [,15]     [,16]     [,17]     [,18]     [,19]     [,20] #> [1,] -1.085027 -1.127901 -1.139461 -1.124044 -1.093216 -1.062674 -1.048035 #> [2,] -2.102419 -2.272247 -2.364311 -2.361654 -2.272703 -2.129005 -1.976777 #>          [,21]     [,22]     [,23]     [,24] #> [1,] -1.060658 -1.104596 -1.175510 -1.261835 #> [2,] -1.864521 -1.830030 -1.890259 -2.036783 #>  #> $outcomes$chickenPox$Qt #> , , 1 #>  #>             [,1]        [,2] #> [1,] 0.126574059 0.002780609 #> [2,] 0.002780609 0.131677338 #>  #> , , 2 #>  #>             [,1]        [,2] #> [1,] 0.140113999 0.003076489 #> [2,] 0.003076489 0.147655162 #>  #> , , 3 #>  #>             [,1]        [,2] #> [1,] 0.154158661 0.003318991 #> [2,] 0.003318991 0.164206083 #>  #> , , 4 #>  #>           [,1]      [,2] #> [1,] 0.1677064 0.0034983 #> [2,] 0.0034983 0.1800504 #>  #> , , 5 #>  #>             [,1]        [,2] #> [1,] 0.180224168 0.003625945 #> [2,] 0.003625945 0.194479798 #>  #> , , 6 #>  #>            [,1]       [,2] #> [1,] 0.19177331 0.00373013 #> [2,] 0.00373013 0.20756617 #>  #> , , 7 #>  #>             [,1]        [,2] #> [1,] 0.202936715 0.003848195 #> [2,] 0.003848195 0.220082065 #>  #> , , 8 #>  #>             [,1]        [,2] #> [1,] 0.214673490 0.004018534 #> [2,] 0.004018534 0.233273283 #>  #> , , 9 #>  #>             [,1]        [,2] #> [1,] 0.228174208 0.004272023 #> [2,] 0.004272023 0.248616919 #>  #> , , 10 #>  #>             [,1]        [,2] #> [1,] 0.244673580 0.004622896 #> [2,] 0.004622896 0.267573558 #>  #> , , 11 #>  #>             [,1]        [,2] #> [1,] 0.265150698 0.005061447 #> [2,] 0.005061447 0.291265577 #>  #> , , 12 #>  #>             [,1]        [,2] #> [1,] 0.289959108 0.005553042 #> [2,] 0.005553042 0.320090109 #>  #> , , 13 #>  #>             [,1]        [,2] #> [1,] 0.318573350 0.006046547 #> [2,] 0.006046547 0.353433294 #>  #> , , 14 #>  #>             [,1]        [,2] #> [1,] 0.349654318 0.006490469 #> [2,] 0.006490469 0.389713270 #>  #> , , 15 #>  #>             [,1]        [,2] #> [1,] 0.381472833 0.006850211 #> [2,] 0.006850211 0.426840044 #>  #> , , 16 #>  #>             [,1]        [,2] #> [1,] 0.412508942 0.007119014 #> [2,] 0.007119014 0.462927711 #>  #> , , 17 #>  #>           [,1]      [,2] #> [1,] 0.4419450 0.0073189 #> [2,] 0.0073189 0.4969327 #>  #> , , 18 #>  #>             [,1]        [,2] #> [1,] 0.469868017 0.007493187 #> [2,] 0.007493187 0.528952268 #>  #> , , 19 #>  #>             [,1]        [,2] #> [1,] 0.497189435 0.007694902 #> [2,] 0.007694902 0.560138432 #>  #> , , 20 #>  #>             [,1]        [,2] #> [1,] 0.525412243 0.007974499 #> [2,] 0.007974499 0.592368608 #>  #> , , 21 #>  #>             [,1]        [,2] #> [1,] 0.556340237 0.008368047 #> [2,] 0.008368047 0.627834567 #>  #> , , 22 #>  #>             [,1]        [,2] #> [1,] 0.591726449 0.008886725 #> [2,] 0.008886725 0.668603095 #>  #> , , 23 #>  #>             [,1]        [,2] #> [1,] 0.632834496 0.009510335 #> [2,] 0.009510335 0.716131861 #>  #> , , 24 #>  #>            [,1]       [,2] #> [1,] 0.67999242 0.01018913 #> [2,] 0.01018913 0.77079255 #>  #>  #> $outcomes$chickenPox$data #>       [,1] [,2] [,3] #>  [1,]   48   26   94 #>  [2,]   48   26   94 #>  [3,]   48   26   94 #>  [4,]   48   26   94 #>  [5,]   48   26   94 #>  [6,]   48   26   94 #>  [7,]   48   26   94 #>  [8,]   48   26   94 #>  [9,]   48   26   94 #> [10,]   48   26   94 #> [11,]   48   26   94 #> [12,]   48   26   94 #> [13,]   48   26   94 #> [14,]   48   26   94 #> [15,]   48   26   94 #> [16,]   48   26   94 #> [17,]   48   26   94 #> [18,]   48   26   94 #> [19,]   48   26   94 #> [20,]   48   26   94 #> [21,]   48   26   94 #> [22,]   48   26   94 #> [23,]   48   26   94 #> [24,]   48   26   94 #>  #> $outcomes$chickenPox$offset #>       [,1] [,2] [,3] #>  [1,]    1    1    1 #>  [2,]    1    1    1 #>  [3,]    1    1    1 #>  [4,]    1    1    1 #>  [5,]    1    1    1 #>  [6,]    1    1    1 #>  [7,]    1    1    1 #>  [8,]    1    1    1 #>  [9,]    1    1    1 #> [10,]    1    1    1 #> [11,]    1    1    1 #> [12,]    1    1    1 #> [13,]    1    1    1 #> [14,]    1    1    1 #> [15,]    1    1    1 #> [16,]    1    1    1 #> [17,]    1    1    1 #> [18,]    1    1    1 #> [19,]    1    1    1 #> [20,]    1    1    1 #> [21,]    1    1    1 #> [22,]    1    1    1 #> [23,]    1    1    1 #> [24,]    1    1    1 #>  #> $outcomes$chickenPox$pred #>          [,1]      [,2]      [,3]      [,4]      [,5]      [,6]     [,7] #> [1,] 49.63073  48.42213  47.78840  47.79864  48.32058  49.00718 49.40287 #> [2,] 21.84474  18.81722  16.63545  15.57295  15.65854  16.81260 18.83476 #> [3,] 96.52452 100.76065 103.57615 104.62841 104.02089 102.18022 99.76237 #>          [,8]     [,9]    [,10]    [,11]     [,12]     [,13]     [,14] #> [1,] 49.14310 48.13517 46.56745 44.74058  42.90972  41.27574  40.03981 #> [2,] 21.28412 23.42408 24.43135 23.83661  21.84320  19.20289  16.75421 #> [3,] 97.57278 96.44075 97.00120 99.42281 103.24708 107.52137 111.20599 #>          [,15]     [,16]     [,17]     [,18]     [,19]     [,20]     [,21] #> [1,]  39.38220  39.37087  39.88988  40.63895  41.21720  41.27810  40.67993 #> [2,]  15.04688  14.29210  14.50365  15.60631  17.42073  19.56488  21.41461 #> [3,] 113.57093 114.33703 113.60648 111.75474 109.36207 107.15702 105.90546 #>          [,22]     [,23]     [,24] #> [1,]  39.51596  38.00802  36.39376 #> [2,]  22.28607  21.80527  20.16313 #> [3,] 106.19797 108.18671 111.44311 #>  #> $outcomes$chickenPox$var.pred #> , , 1 #>  #>           [,1]      [,2]       [,3] #> [1,]  149.4347 -27.57780 -121.85695 #> [2,]  -27.5778  81.21259  -53.63479 #> [3,] -121.8569 -53.63479  175.49174 #>  #> , , 2 #>  #>           [,1]      [,2]       [,3] #> [1,]  152.7842 -24.04270 -128.74151 #> [2,]  -24.0427  74.07267  -50.02997 #> [3,] -128.7415 -50.02997  178.77149 #>  #> , , 3 #>  #>            [,1]      [,2]      [,3] #> [1,]  158.07990 -21.87584 -136.2041 #> [2,]  -21.87584  69.28934  -47.4135 #> [3,] -136.20406 -47.41350  183.6176 #>  #> , , 4 #>  #>            [,1]      [,2]       [,3] #> [1,]  166.30688 -21.54625 -144.76063 #> [2,]  -21.54625  68.70973  -47.16348 #> [3,] -144.76063 -47.16348  191.92411 #>  #> , , 5 #>  #>            [,1]      [,2]       [,3] #> [1,]  177.78905 -23.26144 -154.52761 #> [2,]  -23.26144  73.33692  -50.07548 #> [3,] -154.52761 -50.07548  204.60309 #>  #> , , 6 #>  #>            [,1]      [,2]       [,3] #> [1,]  191.98733 -27.12606 -164.86127 #> [2,]  -27.12606  83.68403  -56.55797 #> [3,] -164.86127 -56.55797  221.41924 #>  #> , , 7 #>  #>            [,1]      [,2]      [,3] #> [1,]  207.57641 -32.96583 -174.6106 #> [2,]  -32.96583  99.53583  -66.5700 #> [3,] -174.61058 -66.57000  241.1806 #>  #> , , 8 #>  #>            [,1]      [,2]      [,3] #> [1,]  222.68904 -39.87771 -182.8113 #> [2,]  -39.87771 119.05421  -79.1765 #> [3,] -182.81134 -79.17650  261.9878 #>  #> , , 9 #>  #>            [,1]      [,2]       [,3] #> [1,]  235.39879 -46.00183 -189.39696 #> [2,]  -46.00183 138.16834  -92.16651 #> [3,] -189.39696 -92.16651  281.56347 #>  #> , , 10 #>  #>            [,1]       [,2]      [,3] #> [1,]  244.38037  -49.16756 -195.2128 #> [2,]  -49.16756  151.58487 -102.4173 #> [3,] -195.21281 -102.41730  297.6301 #>  #> , , 11 #>  #>            [,1]       [,2]      [,3] #> [1,]  249.26693  -48.20466 -201.0623 #> [2,]  -48.20466  155.32537 -107.1207 #> [3,] -201.06227 -107.12071  308.1830 #>  #> , , 12 #>  #>            [,1]       [,2]      [,3] #> [1,]  250.66840  -43.77158 -206.8968 #> [2,]  -43.77158  149.09243 -105.3208 #> [3,] -206.89682 -105.32085  312.2177 #>  #> , , 13 #>  #>            [,1]      [,2]       [,3] #> [1,]  250.39760 -37.94347 -212.45413 #> [2,]  -37.94347 136.78442  -98.84096 #> [3,] -212.45413 -98.84096  311.29509 #>  #> , , 14 #>  #>            [,1]      [,2]       [,3] #> [1,]  251.49642 -32.92917 -218.56725 #> [2,]  -32.92917 124.38618  -91.45701 #> [3,] -218.56725 -91.45701  310.02426 #>  #> , , 15 #>  #>            [,1]      [,2]       [,3] #> [1,]  257.28776 -30.09986 -227.18791 #> [2,]  -30.09986 116.90225  -86.80239 #> [3,] -227.18791 -86.80239  313.99030 #>  #> , , 16 #>  #>            [,1]      [,2]       [,3] #> [1,]  270.05759 -30.00634 -240.05125 #> [2,]  -30.00634 117.14780  -87.14146 #> [3,] -240.05125 -87.14146  327.19272 #>  #> , , 17 #>  #>            [,1]      [,2]      [,3] #> [1,]  290.32090 -32.86791 -257.4530 #> [2,]  -32.86791 126.47582  -93.6079 #> [3,] -257.45298 -93.60790  351.0609 #>  #> , , 18 #>  #>            [,1]       [,2]      [,3] #> [1,]  316.69079  -38.80601 -277.8848 #> [2,]  -38.80601  145.52028 -106.7143 #> [3,] -277.88477 -106.71427  384.5990 #>  #> , , 19 #>  #>            [,1]       [,2]      [,3] #> [1,]  346.02285  -47.54564 -298.4772 #> [2,]  -47.54564  173.69904 -126.1534 #> [3,] -298.47721 -126.15340  424.6306 #>  #> , , 20 #>  #>            [,1]       [,2]      [,3] #> [1,]  373.83374  -57.71704 -316.1167 #> [2,]  -57.71704  207.54918 -149.8321 #> [3,] -316.11670 -149.83214  465.9488 #>  #> , , 21 #>  #>            [,1]       [,2]      [,3] #> [1,]  395.31303  -66.48971 -328.8233 #> [2,]  -66.48971  239.58794 -173.0982 #> [3,] -328.82332 -173.09823  501.9216 #>  #> , , 22 #>  #>           [,1]      [,2]      [,3] #> [1,]  406.9218  -70.5822 -336.3396 #> [2,]  -70.5822  260.2698 -189.6876 #> [3,] -336.3396 -189.6876  526.0272 #>  #> , , 23 #>  #>            [,1]       [,2]      [,3] #> [1,]  407.73603  -68.39494 -339.3411 #> [2,]  -68.39494  263.07551 -194.6806 #> [3,] -339.34108 -194.68057  534.0217 #>  #> , , 24 #>  #>           [,1]      [,2]      [,3] #> [1,]  399.9876  -61.2813 -338.7063 #> [2,]  -61.2813  248.9337 -187.6524 #> [3,] -338.7063 -187.6524  526.3587 #>  #>  #> $outcomes$chickenPox$icl.pred #>      [,1] [,2] [,3] [,4] [,5] [,6] [,7] [,8] [,9] [,10] [,11] [,12] [,13] [,14] #> [1,]   27   26   25   25   24   24   24   23   21    19    17    16    15    13 #> [2,]    7    5    4    3    3    3    4    5    5     5     5     4     3     2 #> [3,]   70   74   76   77   75   72   69   65   63    62    64    67    71    75 #>      [,15] [,16] [,17] [,18] [,19] [,20] [,21] [,22] [,23] [,24] #> [1,]    13    12    12    12    11    10     9     8     7     6 #> [2,]     1     1     1     1     1     1     1     1     1     1 #> [3,]    76    76    74    71    66    62    60    59    60    63 #>  #> $outcomes$chickenPox$icu.pred #>      [,1] [,2] [,3] [,4] [,5] [,6] [,7] [,8] [,9] [,10] [,11] [,12] [,13] [,14] #> [1,]   75   74   74   75   76   78   80   80   81    80    79    77    76    75 #> [2,]   42   38   36   35   36   38   42   46   50    53    53    50    47    44 #> [3,]  122  126  129  131  131  130  129  128  128   129   132   136   140   143 #>      [,15] [,16] [,17] [,18] [,19] [,20] [,21] [,22] [,23] [,24] #> [1,]    75    75    77    80    82    84    85    85    84    82 #> [2,]    42    41    43    46    50    55    59    62    62    60 #> [3,]   145   146   147   146   146   145   146   147   149   151 #>  #>  #> $outcomes$show #> [1] FALSE #>  #>  #> $theta.mean #>              [,1]        [,2]        [,3]        [,4]        [,5]        [,6] #>  [1,] -1.00169702 -1.02944570 -1.05719437 -1.08494305 -1.11269173 -1.14044040 #>  [2,] -0.02774868 -0.02774868 -0.02774868 -0.02774868 -0.02774868 -0.02774868 #>  [3,] -0.05935463 -0.10174180 -0.11686733 -0.10067836 -0.05751270  0.00106344 #>  [4,] -0.10067836 -0.05751270  0.00106344  0.05935463  0.10174180  0.11686733 #>  [5,]  0.00000000  0.00000000  0.00000000  0.00000000  0.00000000  0.00000000 #>  [6,]  0.37914486  0.37914486  0.37914486  0.37914486  0.37914486  0.37914486 #>  [7,] -2.03920255 -2.06798887 -2.09677519 -2.12556151 -2.15434783 -2.18313415 #>  [8,] -0.02878632 -0.02878632 -0.02878632 -0.02878632 -0.02878632 -0.02878632 #>  [9,]  0.03183478 -0.14917990 -0.29022195 -0.35349926 -0.32205673 -0.20431936 #> [10,] -0.35349926 -0.32205673 -0.20431936 -0.03183478  0.14917990  0.29022195 #> [11,]  0.00000000  0.00000000  0.00000000  0.00000000  0.00000000  0.00000000 #> [12,]  0.46018590  0.46018590  0.46018590  0.46018590  0.46018590  0.46018590 #>              [,7]        [,8]        [,9]       [,10]       [,11]       [,12] #>  [1,] -1.16818908 -1.19593775 -1.22368643 -1.25143510 -1.27918378 -1.30693245 #>  [2,] -0.02774868 -0.02774868 -0.02774868 -0.02774868 -0.02774868 -0.02774868 #>  [3,]  0.05935463  0.10174180  0.11686733  0.10067836  0.05751270 -0.00106344 #>  [4,]  0.10067836  0.05751270 -0.00106344 -0.05935463 -0.10174180 -0.11686733 #>  [5,]  0.00000000  0.00000000  0.00000000  0.00000000  0.00000000  0.00000000 #>  [6,]  0.37914486  0.37914486  0.37914486  0.37914486  0.37914486  0.37914486 #>  [7,] -2.21192047 -2.24070679 -2.26949311 -2.29827943 -2.32706575 -2.35585207 #>  [8,] -0.02878632 -0.02878632 -0.02878632 -0.02878632 -0.02878632 -0.02878632 #>  [9,] -0.03183478  0.14917990  0.29022195  0.35349926  0.32205673  0.20431936 #> [10,]  0.35349926  0.32205673  0.20431936  0.03183478 -0.14917990 -0.29022195 #> [11,]  0.00000000  0.00000000  0.00000000  0.00000000  0.00000000  0.00000000 #> [12,]  0.46018590  0.46018590  0.46018590  0.46018590  0.46018590  0.46018590 #>             [,13]       [,14]       [,15]       [,16]       [,17]       [,18] #>  [1,] -1.33468113 -1.36242981 -1.39017848 -1.41792716 -1.44567583 -1.47342451 #>  [2,] -0.02774868 -0.02774868 -0.02774868 -0.02774868 -0.02774868 -0.02774868 #>  [3,] -0.05935463 -0.10174180 -0.11686733 -0.10067836 -0.05751270  0.00106344 #>  [4,] -0.10067836 -0.05751270  0.00106344  0.05935463  0.10174180  0.11686733 #>  [5,]  0.00000000  0.00000000  0.00000000  0.00000000  0.00000000  0.00000000 #>  [6,]  0.37914486  0.37914486  0.37914486  0.37914486  0.37914486  0.37914486 #>  [7,] -2.38463839 -2.41342471 -2.44221102 -2.47099734 -2.49978366 -2.52856998 #>  [8,] -0.02878632 -0.02878632 -0.02878632 -0.02878632 -0.02878632 -0.02878632 #>  [9,]  0.03183478 -0.14917990 -0.29022195 -0.35349926 -0.32205673 -0.20431936 #> [10,] -0.35349926 -0.32205673 -0.20431936 -0.03183478  0.14917990  0.29022195 #> [11,]  0.00000000  0.00000000  0.00000000  0.00000000  0.00000000  0.00000000 #> [12,]  0.46018590  0.46018590  0.46018590  0.46018590  0.46018590  0.46018590 #>             [,19]       [,20]       [,21]       [,22]       [,23]       [,24] #>  [1,] -1.50117318 -1.52892186 -1.55667053 -1.58441921 -1.61216789 -1.63991656 #>  [2,] -0.02774868 -0.02774868 -0.02774868 -0.02774868 -0.02774868 -0.02774868 #>  [3,]  0.05935463  0.10174180  0.11686733  0.10067836  0.05751270 -0.00106344 #>  [4,]  0.10067836  0.05751270 -0.00106344 -0.05935463 -0.10174180 -0.11686733 #>  [5,]  0.00000000  0.00000000  0.00000000  0.00000000  0.00000000  0.00000000 #>  [6,]  0.37914486  0.37914486  0.37914486  0.37914486  0.37914486  0.37914486 #>  [7,] -2.55735630 -2.58614262 -2.61492894 -2.64371526 -2.67250158 -2.70128790 #>  [8,] -0.02878632 -0.02878632 -0.02878632 -0.02878632 -0.02878632 -0.02878632 #>  [9,] -0.03183478  0.14917990  0.29022195  0.35349926  0.32205673  0.20431936 #> [10,]  0.35349926  0.32205673  0.20431936  0.03183478 -0.14917990 -0.29022195 #> [11,]  0.00000000  0.00000000  0.00000000  0.00000000  0.00000000  0.00000000 #> [12,]  0.46018590  0.46018590  0.46018590  0.46018590  0.46018590  0.46018590 #>  #> $theta.cov #> , , 1 #>  #>                [,1]          [,2]          [,3]          [,4]       [,5] #>  [1,]  9.872440e-02  2.030001e-03  2.664470e-04  2.782113e-03 0.00000000 #>  [2,]  2.030001e-03  4.887590e-04 -4.027821e-05  1.799244e-04 0.00000000 #>  [3,]  2.664470e-04 -4.027821e-05  7.211060e-03  1.560346e-04 0.00000000 #>  [4,]  2.782113e-03  1.799244e-04  1.560346e-04  7.336572e-03 0.00000000 #>  [5,]  0.000000e+00  0.000000e+00  0.000000e+00  0.000000e+00 0.08356629 #>  [6,] -6.226665e-02 -4.927366e-09 -7.251207e-04  6.870868e-04 0.00000000 #>  [7,]  5.546934e-03  9.903291e-05  1.724105e-04 -1.141960e-05 0.00000000 #>  [8,]  9.874520e-05  5.360397e-06  3.997851e-06  2.579428e-06 0.00000000 #>  [9,]  1.737814e-04  3.965807e-06  4.029683e-04  2.452050e-06 0.00000000 #> [10,] -3.471055e-06  2.786504e-06  2.279165e-06  3.970212e-04 0.00000000 #> [11,]  0.000000e+00  0.000000e+00  0.000000e+00  0.000000e+00 0.00000000 #> [12,] -3.336156e-03  1.057412e-06 -1.024899e-04  1.055686e-04 0.00000000 #>                [,6]          [,7]          [,8]          [,9]         [,10] #>  [1,] -6.226665e-02  5.546934e-03  9.874520e-05  1.737814e-04 -3.471055e-06 #>  [2,] -4.927366e-09  9.903291e-05  5.360397e-06  3.965807e-06  2.786504e-06 #>  [3,] -7.251207e-04  1.724105e-04  3.997851e-06  4.029683e-04  2.279165e-06 #>  [4,]  6.870868e-04 -1.141960e-05  2.579428e-06  2.452050e-06  3.970212e-04 #>  [5,]  0.000000e+00  0.000000e+00  0.000000e+00  0.000000e+00  0.000000e+00 #>  [6,]  6.252295e-02 -3.335446e-03  1.037567e-06 -1.052795e-04  1.074222e-04 #>  [7,] -3.335446e-03  1.123101e-01  2.378678e-03  2.857220e-04  3.505718e-03 #>  [8,]  1.037567e-06  2.378678e-03  5.651565e-04 -4.818086e-05  2.093564e-04 #>  [9,] -1.052795e-04  2.857220e-04 -4.818086e-05  8.644493e-03  1.464377e-04 #> [10,]  1.074222e-04  3.505718e-03  2.093564e-04  1.464377e-04  8.881564e-03 #> [11,]  0.000000e+00  0.000000e+00  0.000000e+00  0.000000e+00  0.000000e+00 #> [12,]  3.363887e-03 -6.930073e-02  3.556783e-07 -8.642072e-04  8.397154e-04 #>            [,11]         [,12] #>  [1,] 0.00000000 -3.336156e-03 #>  [2,] 0.00000000  1.057412e-06 #>  [3,] 0.00000000 -1.024899e-04 #>  [4,] 0.00000000  1.055686e-04 #>  [5,] 0.00000000  0.000000e+00 #>  [6,] 0.00000000  3.363887e-03 #>  [7,] 0.00000000 -6.930073e-02 #>  [8,] 0.00000000  3.556783e-07 #>  [9,] 0.00000000 -8.642072e-04 #> [10,] 0.00000000  8.397154e-04 #> [11,] 0.08084326  0.000000e+00 #> [12,] 0.00000000  6.963794e-02 #>  #> , , 2 #>  #>                [,1]          [,2]          [,3]          [,4]       [,5] #>  [1,]  1.082152e-01  2.518760e-03  1.676887e-03  2.452115e-03 0.00000000 #>  [2,]  2.518760e-03  5.132187e-04  5.508022e-05  1.759582e-04 0.00000000 #>  [3,]  1.676887e-03  5.508022e-05  7.557962e-03  1.323654e-04 0.00000000 #>  [4,]  2.452115e-03  1.759582e-04  1.323654e-04  7.353639e-03 0.00000000 #>  [5,]  0.000000e+00  0.000000e+00  0.000000e+00  0.000000e+00 0.08356629 #>  [6,] -6.226665e-02 -4.927366e-09 -2.844295e-04  9.575950e-04 0.00000000 #>  [7,]  5.750072e-03  1.043933e-04  1.483541e-04 -9.586001e-05 0.00000000 #>  [8,]  1.041056e-04  5.360397e-06  4.751955e-06  2.349248e-07 0.00000000 #>  [9,]  1.535914e-04  4.827742e-06  4.035302e-04 -1.305902e-06 0.00000000 #> [10,] -8.946646e-05  4.302803e-07 -1.478788e-06  3.964593e-04 0.00000000 #> [11,]  0.000000e+00  0.000000e+00  0.000000e+00  0.000000e+00 0.00000000 #> [12,] -3.335098e-03  1.057412e-06 -3.597456e-05  1.426701e-04 0.00000000 #>                [,6]          [,7]         [,8]          [,9]         [,10] #>  [1,] -6.226665e-02  5.750072e-03 1.041056e-04  1.535914e-04 -8.946646e-05 #>  [2,] -4.927366e-09  1.043933e-04 5.360397e-06  4.827742e-06  4.302803e-07 #>  [3,] -2.844295e-04  1.483541e-04 4.751955e-06  4.035302e-04 -1.478788e-06 #>  [4,]  9.575950e-04 -9.586001e-05 2.349248e-07 -1.305902e-06  3.964593e-04 #>  [5,]  0.000000e+00  0.000000e+00 0.000000e+00  0.000000e+00  0.000000e+00 #>  [6,]  6.252295e-02 -3.334409e-03 1.037567e-06 -3.746360e-05  1.456701e-04 #>  [7,] -3.334409e-03  1.232574e-01 2.943835e-03  2.063254e-03  3.098578e-03 #>  [8,]  1.037567e-06  2.943835e-03 5.934287e-04  6.295236e-05  2.053984e-04 #>  [9,] -3.746360e-05  2.063254e-03 6.295236e-05  9.047975e-03  1.758737e-04 #> [10,]  1.456701e-04  3.098578e-03 2.053984e-04  1.758737e-04  8.916400e-03 #> [11,]  0.000000e+00  0.000000e+00 0.000000e+00  0.000000e+00  0.000000e+00 #> [12,]  3.363887e-03 -6.930037e-02 3.556783e-07 -3.285676e-04  1.159319e-03 #>            [,11]         [,12] #>  [1,] 0.00000000 -3.335098e-03 #>  [2,] 0.00000000  1.057412e-06 #>  [3,] 0.00000000 -3.597456e-05 #>  [4,] 0.00000000  1.426701e-04 #>  [5,] 0.00000000  0.000000e+00 #>  [6,] 0.00000000  3.363887e-03 #>  [7,] 0.00000000 -6.930037e-02 #>  [8,] 0.00000000  3.556783e-07 #>  [9,] 0.00000000 -3.285676e-04 #> [10,] 0.00000000  1.159319e-03 #> [11,] 0.08084326  0.000000e+00 #> [12,] 0.00000000  6.963794e-02 #>  #> , , 3 #>  #>                [,1]          [,2]          [,3]          [,4]       [,5] #>  [1,]  1.187079e-01  3.031979e-03  2.813964e-03  1.409995e-03 0.00000000 #>  [2,]  3.031979e-03  5.376785e-04  1.356800e-04  1.248441e-04 0.00000000 #>  [3,]  2.813964e-03  1.356800e-04  7.801907e-03 -2.229182e-05 0.00000000 #>  [4,]  1.409995e-03  1.248441e-04 -2.229182e-05  7.473662e-03 0.00000000 #>  [5,]  0.000000e+00  0.000000e+00  0.000000e+00  0.000000e+00 0.08356629 #>  [6,] -6.226666e-02 -4.927366e-09  2.324743e-04  9.715164e-04 0.00000000 #>  [7,]  5.963931e-03  1.097537e-04  8.478115e-05 -1.593668e-04 0.00000000 #>  [8,]  1.094660e-04  5.360397e-06  4.232776e-06 -2.172527e-06 0.00000000 #>  [9,]  9.267687e-05  4.396087e-06  4.005567e-04 -3.671510e-06 0.00000000 #> [10,] -1.563171e-04 -2.041237e-06 -3.844396e-06  3.994329e-04 0.00000000 #> [11,]  0.000000e+00  0.000000e+00  0.000000e+00  0.000000e+00 0.00000000 #> [12,] -3.334041e-03  1.057412e-06  4.018016e-05  1.415432e-04 0.00000000 #>                [,6]          [,7]          [,8]          [,9]         [,10] #>  [1,] -6.226666e-02  5.963931e-03  1.094660e-04  9.267687e-05 -1.563171e-04 #>  [2,] -4.927366e-09  1.097537e-04  5.360397e-06  4.396087e-06 -2.041237e-06 #>  [3,]  2.324743e-04  8.478115e-05  4.232776e-06  4.005567e-04 -3.844396e-06 #>  [4,]  9.715164e-04 -1.593668e-04 -2.172527e-06 -3.671510e-06  3.994329e-04 #>  [5,]  0.000000e+00  0.000000e+00  0.000000e+00  0.000000e+00  0.000000e+00 #>  [6,]  6.252295e-02 -3.333371e-03  1.037567e-06  4.039061e-05  1.448858e-04 #>  [7,] -3.333371e-03  1.353632e-01  3.537263e-03  3.493337e-03  1.798224e-03 #>  [8,]  1.037567e-06  3.537263e-03  6.217009e-04  1.572175e-04  1.464041e-04 #>  [9,]  4.039061e-05  3.493337e-03  1.572175e-04  9.384788e-03  3.096312e-05 #> [10,]  1.448858e-04  1.798224e-03  1.464041e-04  3.096312e-05  9.017905e-03 #> [11,]  0.000000e+00  0.000000e+00  0.000000e+00  0.000000e+00  0.000000e+00 #> [12,]  3.363887e-03 -6.930001e-02  3.556783e-07  2.951113e-04  1.168283e-03 #>            [,11]         [,12] #>  [1,] 0.00000000 -3.334041e-03 #>  [2,] 0.00000000  1.057412e-06 #>  [3,] 0.00000000  4.018016e-05 #>  [4,] 0.00000000  1.415432e-04 #>  [5,] 0.00000000  0.000000e+00 #>  [6,] 0.00000000  3.363887e-03 #>  [7,] 0.00000000 -6.930001e-02 #>  [8,] 0.00000000  3.556783e-07 #>  [9,] 0.00000000  2.951113e-04 #> [10,] 0.00000000  1.168283e-03 #> [11,] 0.08084326  0.000000e+00 #> [12,] 0.00000000  6.963794e-02 #>  #> , , 4 #>  #>                [,1]          [,2]          [,3]          [,4]       [,5] #>  [1,]  1.302516e-01  3.569658e-03  3.321886e-03 -1.456124e-04 0.00000000 #>  [2,]  3.569658e-03  5.621383e-04  1.799244e-04  4.027821e-05 0.00000000 #>  [3,]  3.321886e-03  1.799244e-04  7.880934e-03 -1.532799e-04 0.00000000 #>  [4,] -1.456124e-04  4.027821e-05 -1.532799e-04  7.758603e-03 0.00000000 #>  [5,]  0.000000e+00  0.000000e+00  0.000000e+00  0.000000e+00 0.08356629 #>  [6,] -6.226666e-02 -4.927366e-09  6.870868e-04  7.251207e-04 0.00000000 #>  [7,]  6.188511e-03  1.151141e-04 -3.681319e-06 -1.844041e-04 0.00000000 #>  [8,]  1.148264e-04  5.360397e-06  2.579428e-06 -3.997851e-06 0.00000000 #>  [9,]  4.888459e-06  2.786504e-06  3.970212e-04 -2.279165e-06 0.00000000 #> [10,] -1.856789e-04 -3.965807e-06 -2.452050e-06  4.029683e-04 0.00000000 #> [11,]  0.000000e+00  0.000000e+00  0.000000e+00  0.000000e+00 0.00000000 #> [12,] -3.332983e-03  1.057412e-06  1.055686e-04  1.024899e-04 0.00000000 #>                [,6]          [,7]          [,8]          [,9]         [,10] #>  [1,] -6.226666e-02  6.188511e-03  1.148264e-04  4.888459e-06 -1.856789e-04 #>  [2,] -4.927366e-09  1.151141e-04  5.360397e-06  2.786504e-06 -3.965807e-06 #>  [3,]  6.870868e-04 -3.681319e-06  2.579428e-06  3.970212e-04 -2.452050e-06 #>  [4,]  7.251207e-04 -1.844041e-04 -3.997851e-06 -2.279165e-06  4.029683e-04 #>  [5,]  0.000000e+00  0.000000e+00  0.000000e+00  0.000000e+00  0.000000e+00 #>  [6,]  6.252295e-02 -3.332334e-03  1.037567e-06  1.074222e-04  1.052795e-04 #>  [7,] -3.332334e-03  1.486842e-01  4.158964e-03  4.133787e-03 -1.411795e-04 #>  [8,]  1.037567e-06  4.158964e-03  6.499731e-04  2.093564e-04  4.818086e-05 #>  [9,]  1.074222e-04  4.133787e-03  2.093564e-04  9.537277e-03 -1.433836e-04 #> [10,]  1.052795e-04 -1.411795e-04  4.818086e-05 -1.433836e-04  9.303733e-03 #> [11,]  0.000000e+00  0.000000e+00  0.000000e+00  0.000000e+00  0.000000e+00 #> [12,]  3.363887e-03 -6.929966e-02  3.556783e-07  8.397154e-04  8.642072e-04 #>            [,11]         [,12] #>  [1,] 0.00000000 -3.332983e-03 #>  [2,] 0.00000000  1.057412e-06 #>  [3,] 0.00000000  1.055686e-04 #>  [4,] 0.00000000  1.024899e-04 #>  [5,] 0.00000000  0.000000e+00 #>  [6,] 0.00000000  3.363887e-03 #>  [7,] 0.00000000 -6.929966e-02 #>  [8,] 0.00000000  3.556783e-07 #>  [9,] 0.00000000  8.397154e-04 #> [10,] 0.00000000  8.642072e-04 #> [11,] 0.08084326  0.000000e+00 #> [12,] 0.00000000  6.963794e-02 #>  #> , , 5 #>  #>                [,1]          [,2]          [,3]          [,4]       [,5] #>  [1,]  1.428951e-01  4.131796e-03  2.979990e-03 -1.842127e-03 0.00000000 #>  [2,]  4.131796e-03  5.865981e-04  1.759582e-04 -5.508022e-05 0.00000000 #>  [3,]  2.979990e-03  1.759582e-04  7.898001e-03 -1.296108e-04 0.00000000 #>  [4,] -1.842127e-03 -5.508022e-05 -1.296108e-04  8.105505e-03 0.00000000 #>  [5,]  0.000000e+00  0.000000e+00  0.000000e+00  0.000000e+00 0.08356629 #>  [6,] -6.226667e-02 -4.927366e-09  9.575950e-04  2.844295e-04 0.00000000 #>  [7,]  6.423812e-03  1.204745e-04 -9.515524e-05 -1.626099e-04 0.00000000 #>  [8,]  1.201868e-04  5.360397e-06  2.349248e-07 -4.751955e-06 0.00000000 #>  [9,] -8.817562e-05  4.302803e-07  3.964593e-04  1.478788e-06 0.00000000 #> [10,] -1.680746e-04 -4.827742e-06  1.305902e-06  4.035302e-04 0.00000000 #> [11,]  0.000000e+00  0.000000e+00  0.000000e+00  0.000000e+00 0.00000000 #> [12,] -3.331926e-03  1.057412e-06  1.426701e-04  3.597456e-05 0.00000000 #>                [,6]          [,7]          [,8]          [,9]         [,10] #>  [1,] -6.226667e-02  6.423812e-03  1.201868e-04 -8.817562e-05 -1.680746e-04 #>  [2,] -4.927366e-09  1.204745e-04  5.360397e-06  4.302803e-07 -4.827742e-06 #>  [3,]  9.575950e-04 -9.515524e-05  2.349248e-07  3.964593e-04  1.305902e-06 #>  [4,]  2.844295e-04 -1.626099e-04 -4.751955e-06  1.478788e-06  4.035302e-04 #>  [5,]  0.000000e+00  0.000000e+00  0.000000e+00  0.000000e+00  0.000000e+00 #>  [6,]  6.252295e-02 -3.331296e-03  1.037567e-06  1.456701e-04  3.746360e-05 #>  [7,] -3.331296e-03  1.632769e-01  4.808937e-03  3.714773e-03 -2.252111e-03 #>  [8,]  1.037567e-06  4.808937e-03  6.782454e-04  2.053984e-04 -6.295236e-05 #>  [9,]  1.456701e-04  3.714773e-03  2.053984e-04  9.572113e-03 -1.728196e-04 #> [10,]  3.746360e-05 -2.252111e-03 -6.295236e-05 -1.728196e-04  9.707215e-03 #> [11,]  0.000000e+00  0.000000e+00  0.000000e+00  0.000000e+00  0.000000e+00 #> [12,]  3.363887e-03 -6.929930e-02  3.556783e-07  1.159319e-03  3.285676e-04 #>            [,11]         [,12] #>  [1,] 0.00000000 -3.331926e-03 #>  [2,] 0.00000000  1.057412e-06 #>  [3,] 0.00000000  1.426701e-04 #>  [4,] 0.00000000  3.597456e-05 #>  [5,] 0.00000000  0.000000e+00 #>  [6,] 0.00000000  3.363887e-03 #>  [7,] 0.00000000 -6.929930e-02 #>  [8,] 0.00000000  3.556783e-07 #>  [9,] 0.00000000  1.159319e-03 #> [10,] 0.00000000  3.285676e-04 #> [11,] 0.08084326  0.000000e+00 #> [12,] 0.00000000  6.963794e-02 #>  #> , , 6 #>  #>                [,1]          [,2]          [,3]          [,4]       [,5] #>  [1,]  0.1566873035  4.718394e-03  1.784527e-03 -3.221004e-03 0.00000000 #>  [2,]  0.0047183942  6.110579e-04  1.248441e-04 -1.356800e-04 0.00000000 #>  [3,]  0.0017845274  1.248441e-04  8.018024e-03  2.504646e-05 0.00000000 #>  [4,] -0.0032210041 -1.356800e-04  2.504646e-05  8.349450e-03 0.00000000 #>  [5,]  0.0000000000  0.000000e+00  0.000000e+00  0.000000e+00 0.08356629 #>  [6,] -0.0622666729 -4.927366e-09  9.715164e-04 -2.324743e-04 0.00000000 #>  [7,]  0.0066698340  1.258349e-04 -1.658843e-04 -9.747948e-05 0.00000000 #>  [8,]  0.0001255472  5.360397e-06 -2.172527e-06 -4.232776e-06 0.00000000 #>  [9,] -0.0001624408 -2.041237e-06  3.994329e-04  3.844396e-06 0.00000000 #> [10,] -0.0001058651 -4.396087e-06  3.671510e-06  4.005567e-04 0.00000000 #> [11,]  0.0000000000  0.000000e+00  0.000000e+00  0.000000e+00 0.00000000 #> [12,] -0.0033308684  1.057412e-06  1.415432e-04 -4.018016e-05 0.00000000 #>                [,6]          [,7]          [,8]          [,9]         [,10] #>  [1,] -6.226667e-02  6.669834e-03  1.255472e-04 -1.624408e-04 -1.058651e-04 #>  [2,] -4.927366e-09  1.258349e-04  5.360397e-06 -2.041237e-06 -4.396087e-06 #>  [3,]  9.715164e-04 -1.658843e-04 -2.172527e-06  3.994329e-04  3.671510e-06 #>  [4,] -2.324743e-04 -9.747948e-05 -4.232776e-06  3.844396e-06  4.005567e-04 #>  [5,]  0.000000e+00  0.000000e+00  0.000000e+00  0.000000e+00  0.000000e+00 #>  [6,]  6.252295e-02 -3.330259e-03  1.037567e-06  1.448858e-04 -4.039061e-05 #>  [7,] -3.330259e-03  1.791978e-01  5.487183e-03  2.237436e-03 -3.964989e-03 #>  [8,]  1.037567e-06  5.487183e-03  7.065176e-04  1.464041e-04 -1.572175e-04 #>  [9,]  1.448858e-04  2.237436e-03  1.464041e-04  9.673617e-03 -2.790901e-05 #> [10,] -4.039061e-05 -3.964989e-03 -1.572175e-04 -2.790901e-05  1.004403e-02 #> [11,]  0.000000e+00  0.000000e+00  0.000000e+00  0.000000e+00  0.000000e+00 #> [12,]  3.363887e-03 -6.929895e-02  3.556783e-07  1.168283e-03 -2.951113e-04 #>            [,11]         [,12] #>  [1,] 0.00000000 -3.330868e-03 #>  [2,] 0.00000000  1.057412e-06 #>  [3,] 0.00000000  1.415432e-04 #>  [4,] 0.00000000 -4.018016e-05 #>  [5,] 0.00000000  0.000000e+00 #>  [6,] 0.00000000  3.363887e-03 #>  [7,] 0.00000000 -6.929895e-02 #>  [8,] 0.00000000  3.556783e-07 #>  [9,] 0.00000000  1.168283e-03 #> [10,] 0.00000000 -2.951113e-04 #> [11,] 0.08084326  0.000000e+00 #> [12,] 0.00000000  6.963794e-02 #>  #> , , 7 #>  #>                [,1]          [,2]          [,3]          [,4]       [,5] #>  [1,]  1.716772e-01  5.329452e-03 -2.477774e-05 -3.861659e-03 0.00000000 #>  [2,]  5.329452e-03  6.355177e-04  4.027821e-05 -1.799244e-04 0.00000000 #>  [3,] -2.477774e-05  4.027821e-05  8.302965e-03  1.560346e-04 0.00000000 #>  [4,] -3.861659e-03 -1.799244e-04  1.560346e-04  8.428477e-03 0.00000000 #>  [5,]  0.000000e+00  0.000000e+00  0.000000e+00  0.000000e+00 0.08356629 #>  [6,] -6.226668e-02 -4.927366e-09  7.251207e-04 -6.870868e-04 0.00000000 #>  [7,]  6.926576e-03  1.311953e-04 -1.963976e-04 -4.056966e-06 0.00000000 #>  [8,]  1.309076e-04  5.360397e-06 -3.997851e-06 -2.579428e-06 0.00000000 #>  [9,] -1.975763e-04 -3.965807e-06  4.029683e-04  2.452050e-06 0.00000000 #> [10,] -1.324797e-05 -2.786504e-06  2.279165e-06  3.970212e-04 0.00000000 #> [11,]  0.000000e+00  0.000000e+00  0.000000e+00  0.000000e+00 0.00000000 #>                [,6]          [,7]          [,8]          [,9]         [,10] #>  [1,] -6.226668e-02  6.926576e-03  1.309076e-04 -1.975763e-04 -1.324797e-05 #>  [2,] -4.927366e-09  1.311953e-04  5.360397e-06 -3.965807e-06 -2.786504e-06 #>  [3,]  7.251207e-04 -1.963976e-04 -3.997851e-06  4.029683e-04  2.279165e-06 #>  [4,] -6.870868e-04 -4.056966e-06 -2.579428e-06  2.452050e-06  3.970212e-04 #>  [5,]  0.000000e+00  0.000000e+00  0.000000e+00  0.000000e+00  0.000000e+00 #>  [6,]  6.252295e-02 -3.329221e-03  1.037567e-06  1.052795e-04 -1.074222e-04 #>  [7,] -3.329221e-03  1.965035e-01  6.193700e-03  3.363109e-06 -4.761856e-03 #>  [8,]  1.037567e-06  6.193700e-03  7.347898e-04  4.818086e-05 -2.093564e-04 #>  [9,]  1.052795e-04  3.363109e-06  4.818086e-05  9.959445e-03  1.464377e-04 #> [10,] -1.074222e-04 -4.761856e-03 -2.093564e-04  1.464377e-04  1.019652e-02 #> [11,]  0.000000e+00  0.000000e+00  0.000000e+00  0.000000e+00  0.000000e+00 #>            [,11]         [,12] #>  [1,] 0.00000000 -3.329811e-03 #>  [2,] 0.00000000  1.057412e-06 #>  [3,] 0.00000000  1.024899e-04 #>  [4,] 0.00000000 -1.055686e-04 #>  [5,] 0.00000000  0.000000e+00 #>  [6,] 0.00000000  3.363887e-03 #>  [7,] 0.00000000 -6.929859e-02 #>  [8,] 0.00000000  3.556783e-07 #>  [9,] 0.00000000  8.642072e-04 #> [10,] 0.00000000 -8.397154e-04 #> [11,] 0.08084326  0.000000e+00 #>  #>  [ reached getOption(\"max.print\") -- omitted 1 row(s) and 17 matrix slice(s) ] #>  #> $lambda.mean #>            [,1]       [,2]       [,3]       [,4]       [,5]       [,6] #> [1,] -0.6819068 -0.7520426 -0.7949168 -0.8064766 -0.7910596 -0.7602321 #> [2,] -1.5471819 -1.7569829 -1.9268112 -2.0188749 -2.0162187 -1.9272676 #>            [,7]       [,8]       [,9]      [,10]      [,11]     [,12]     [,13] #> [1,] -0.7296896 -0.7150511 -0.7276742 -0.7716119 -0.8425262 -0.928851 -1.014891 #> [2,] -1.7835693 -1.6313410 -1.5190853 -1.4845943 -1.5448231 -1.691347 -1.892618 #>          [,14]     [,15]     [,16]     [,17]     [,18]     [,19]     [,20] #> [1,] -1.085027 -1.127901 -1.139461 -1.124044 -1.093216 -1.062674 -1.048035 #> [2,] -2.102419 -2.272247 -2.364311 -2.361654 -2.272703 -2.129005 -1.976777 #>          [,21]     [,22]     [,23]     [,24] #> [1,] -1.060658 -1.104596 -1.175510 -1.261835 #> [2,] -1.864521 -1.830030 -1.890259 -2.036783 #>  #> $lambda.cov #> , , 1 #>  #>             [,1]        [,2] #> [1,] 0.126574059 0.002780609 #> [2,] 0.002780609 0.131677338 #>  #> , , 2 #>  #>             [,1]        [,2] #> [1,] 0.140113999 0.003076489 #> [2,] 0.003076489 0.147655162 #>  #> , , 3 #>  #>             [,1]        [,2] #> [1,] 0.154158661 0.003318991 #> [2,] 0.003318991 0.164206083 #>  #> , , 4 #>  #>           [,1]      [,2] #> [1,] 0.1677064 0.0034983 #> [2,] 0.0034983 0.1800504 #>  #> , , 5 #>  #>             [,1]        [,2] #> [1,] 0.180224168 0.003625945 #> [2,] 0.003625945 0.194479798 #>  #> , , 6 #>  #>            [,1]       [,2] #> [1,] 0.19177331 0.00373013 #> [2,] 0.00373013 0.20756617 #>  #> , , 7 #>  #>             [,1]        [,2] #> [1,] 0.202936715 0.003848195 #> [2,] 0.003848195 0.220082065 #>  #> , , 8 #>  #>             [,1]        [,2] #> [1,] 0.214673490 0.004018534 #> [2,] 0.004018534 0.233273283 #>  #> , , 9 #>  #>             [,1]        [,2] #> [1,] 0.228174208 0.004272023 #> [2,] 0.004272023 0.248616919 #>  #> , , 10 #>  #>             [,1]        [,2] #> [1,] 0.244673580 0.004622896 #> [2,] 0.004622896 0.267573558 #>  #> , , 11 #>  #>             [,1]        [,2] #> [1,] 0.265150698 0.005061447 #> [2,] 0.005061447 0.291265577 #>  #> , , 12 #>  #>             [,1]        [,2] #> [1,] 0.289959108 0.005553042 #> [2,] 0.005553042 0.320090109 #>  #> , , 13 #>  #>             [,1]        [,2] #> [1,] 0.318573350 0.006046547 #> [2,] 0.006046547 0.353433294 #>  #> , , 14 #>  #>             [,1]        [,2] #> [1,] 0.349654318 0.006490469 #> [2,] 0.006490469 0.389713270 #>  #> , , 15 #>  #>             [,1]        [,2] #> [1,] 0.381472833 0.006850211 #> [2,] 0.006850211 0.426840044 #>  #> , , 16 #>  #>             [,1]        [,2] #> [1,] 0.412508942 0.007119014 #> [2,] 0.007119014 0.462927711 #>  #> , , 17 #>  #>           [,1]      [,2] #> [1,] 0.4419450 0.0073189 #> [2,] 0.0073189 0.4969327 #>  #> , , 18 #>  #>             [,1]        [,2] #> [1,] 0.469868017 0.007493187 #> [2,] 0.007493187 0.528952268 #>  #> , , 19 #>  #>             [,1]        [,2] #> [1,] 0.497189435 0.007694902 #> [2,] 0.007694902 0.560138432 #>  #> , , 20 #>  #>             [,1]        [,2] #> [1,] 0.525412243 0.007974499 #> [2,] 0.007974499 0.592368608 #>  #> , , 21 #>  #>             [,1]        [,2] #> [1,] 0.556340237 0.008368047 #> [2,] 0.008368047 0.627834567 #>  #> , , 22 #>  #>             [,1]        [,2] #> [1,] 0.591726449 0.008886725 #> [2,] 0.008886725 0.668603095 #>  #> , , 23 #>  #>             [,1]        [,2] #> [1,] 0.632834496 0.009510335 #> [2,] 0.009510335 0.716131861 #>  #> , , 24 #>  #>            [,1]       [,2] #> [1,] 0.67999242 0.01018913 #> [2,] 0.01018913 0.77079255 #>  #>  #> $plot #>"},{"path":"/reference/f_joint_root.html","id":null,"dir":"Reference","previous_headings":"","what":"f_joint_root — f_joint_root","title":"f_joint_root — f_joint_root","text":"Calculates root function given initial value function calculate derivatives.","code":""},{"path":"/reference/f_joint_root.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"f_joint_root — f_joint_root","text":"","code":"f_joint_root(f, start, tol = 1e-08, n.max = 1000)"},{"path":"/reference/f_joint_root.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"f_joint_root — f_joint_root","text":"f function: function receives vector return vector size matrix representing derivatives. start vector: initial value start algorithm. tol numeric: tolerance solution. n.max numeric: maximum number iterations allowed.","code":""},{"path":"/reference/f_joint_root.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"f_joint_root — f_joint_root","text":"list containing: root vector: solution system f(x)=0. f.root vector: function f evaluated root. iter numeric: number steps taken.","code":""},{"path":"/reference/f_root.html","id":null,"dir":"Reference","previous_headings":"","what":"f_root — f_root","title":"f_root — f_root","text":"Calculates root function given initial value function calculate derivatives.","code":""},{"path":"/reference/f_root.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"f_root — f_root","text":"","code":"f_root(f, df, start, tol = 1e-08, n.max = 1000)"},{"path":"/reference/f_root.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"f_root — f_root","text":"f function: function receives vector return vector size. df function: function receives vector return derivatives f respect arguments (f returns vector, must matrix). start vector: initial value start algorithm. tol numeric: tolerance solution. n.max numeric: maximum number iterations allowed.","code":""},{"path":"/reference/f_root.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"f_root — f_root","text":"list containing: root vector: solution system f(x)=0. f.root vector: function f evaluated root. iter numeric: number steps taken.","code":""},{"path":"/reference/Gamma.html","id":null,"dir":"Reference","previous_headings":"","what":"Gamma outcome for kDGLM models — Gamma","title":"Gamma outcome for kDGLM models — Gamma","text":"Creates outcome gamma distribution chosen parameters (can specify 2).","code":""},{"path":"/reference/Gamma.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Gamma outcome for kDGLM models — Gamma","text":"","code":"Gamma(   phi = NA,   mu = NA,   alpha = NA,   beta = NA,   sigma = NA,   data,   offset = as.matrix(data)^0 )"},{"path":"/reference/Gamma.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Gamma outcome for kDGLM models — Gamma","text":"phi character numeric: Name linear predictor associated shape parameter gamma distribution. numeric, parameter treated known equal value passed. character, parameter treated unknown equal exponential associated linear predictor. specified alpha. mu character: Name linear predictor associated mean parameter gamma distribution. parameter treated unknown equal exponential associated linear predictor. alpha character: Name linear predictor associated shape parameter gamma distribution. parameter treated unknown equal exponential associated linear predictor. specified phi. beta character: Name linear predictor associated rate parameter gamma distribution. parameter treated unknown equal exponential associated linear predictor. specified sigma. sigma character: Name linear predictor associated scale parameter gamma distribution. parameter treated unknown equal exponential associated linear predictor. specified beta. data numeric: Values observed data. offset numeric: offset observation. Must shape data.","code":""},{"path":"/reference/Gamma.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Gamma outcome for kDGLM models — Gamma","text":"object class dlm_distr","code":""},{"path":"/reference/Gamma.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Gamma outcome for kDGLM models — Gamma","text":"evaluating posterior parameters, use method proposed Alves et al. (2024) . details implementation see  dos Santos et al. (2024) .","code":""},{"path":"/reference/Gamma.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Gamma outcome for kDGLM models — Gamma","text":"Mariane Branco Alves, Helio S. Migon, Raíra Marotta, Junior, Silvaneo Vieira dos Santos (2024). “k-parametric Dynamic Generalized Linear Models: sequential approach via Information Geometry.” 2201.05387. Junior, Silvaneo Vieira dos Santos, Mariane Branco Alves, Helio S. Migon (2024). “kDGLM: R package Bayesian analysis Dynamic Generialized Linear Models.”","code":""},{"path":[]},{"path":"/reference/Gamma.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Gamma outcome for kDGLM models — Gamma","text":"","code":"structure <- polynomial_block(mu = 1, D = 0.95)  outcome <- Gamma(phi = 0.5, mu = \"mu\", data = cornWheat$corn.log.return[1:500]**2) fitted.data <- fit_model(structure, corn = outcome) summary(fitted.data) #> Fitted DGLM with 1 outcomes. #>  #> distributions: #>     corn: Gamma #>  #> --- #> No static coeficients. #> --- #> See the coef.fitted_dlm for the coeficients with temporal dynamic. #>  #> One-step-ahead prediction #> Log-likelihood        : -Inf #> Interval Score        : 0.00199 #> Mean Abs. Scaled Error: 0.93924 #> --- plot(fitted.data, plot.pkg = \"base\")"},{"path":"/reference/gamma_pred.html","id":null,"dir":"Reference","previous_headings":"","what":"gamma_pred — gamma_pred","title":"gamma_pred — gamma_pred","text":"Calculate values predictive distribution given values parameter conjugated distribution linear predictor. data assumed Gamma distribution known shape parameter phi mean distribution Inverse-Gamma shape parameter e rate parameter b. scenario, marginal distribution data Beta prime parameters phi, alpha, beta / phi.","code":""},{"path":"/reference/gamma_pred.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"gamma_pred — gamma_pred","text":"","code":"gamma_pred(conj.param, outcome = NULL, parms = list(), pred.cred = 0.95)"},{"path":"/reference/gamma_pred.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"gamma_pred — gamma_pred","text":"conj.param list data.frame: parameters conjugated distributions linear predictor. outcome numeric matrix (optional): observed values current time. used function. parms list: list extra parameters model. function, must contain shape parameter phi observational model. pred.cred numeric: desired credibility credibility interval.","code":""},{"path":"/reference/gamma_pred.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"gamma_pred — gamma_pred","text":"list containing following values: pred numeric/matrix: mean predictive distribution next observation. type shape parameter model. var.pred numeric/matrix: variance predictive distribution next observation. type shape parameter model. icl.pred numeric/matrix: percentile 100*((1-pred.cred)/2) icu.pred numeric/matrix: percentile 100*(1-(1-pred.cred)/2) log.like numeric: log likelihood outcome given conjugated parameters.","code":""},{"path":[]},{"path":"/reference/gastroBR.html","id":null,"dir":"Reference","previous_headings":"","what":"Hospital admissions from gastroenteritis in Brazil — gastroBR","title":"Hospital admissions from gastroenteritis in Brazil — gastroBR","text":"dataset containing number Hospital admissions gastroenteritis Brazil, per state, 2010 2022 month.","code":""},{"path":"/reference/gastroBR.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Hospital admissions from gastroenteritis in Brazil — gastroBR","text":"","code":"gastroBR"},{"path":"/reference/gastroBR.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Hospital admissions from gastroenteritis in Brazil — gastroBR","text":"data frame 4212 rows 4 variables: UF abbreviated state name. Date date observation. Note day placeholder just placeholder. Admissions number hospital admissions. Population estimated population.","code":""},{"path":"/reference/gastroBR.html","id":"source","dir":"Reference","previous_headings":"","what":"Source","title":"Hospital admissions from gastroenteritis in Brazil — gastroBR","text":"Admissions: https://datasus.saude.gov.br/informacoes-de-saude-tabnet/ Population: https://www.ibge.gov.br/estatisticas/sociais/populacao.html","code":""},{"path":"/reference/generic_smoother.html","id":null,"dir":"Reference","previous_headings":"","what":"generic_smoother — generic_smoother","title":"generic_smoother — generic_smoother","text":"Generic smoother models.","code":""},{"path":"/reference/generic_smoother.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"generic_smoother — generic_smoother","text":"","code":"generic_smoother(mt, Ct, at, Rt, G, G.labs)"},{"path":"/reference/generic_smoother.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"generic_smoother — generic_smoother","text":"mt matrix: matrix containing filtered mean latent states time. row represent one variable. Ct array: 3D-array representing filtered covariance matrix latent states time. third dimension represent time index. matrix: matrix containing one-step-ahead mean latent states time based upon filtered mean. row represent one variable. Rt array: 3D-array representing one-step-ahead covariance matrix latent states time based upon filtered covariance matrix. third dimension represent time index. G array: 3D-array representing transition matrix model time. G.labs matrix: character matrix containing type associated value G.","code":""},{"path":"/reference/generic_smoother.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"generic_smoother — generic_smoother","text":"list containing smoothed mean (mts) covariance (Cts) latent states time. dimension follows, respectively, dimensions mt Ct.","code":""},{"path":"/reference/generic_smoother.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"generic_smoother — generic_smoother","text":"models covered package, always assume latent states Multivariate Normal distribution. assumption, can use Kalman Smoother algorithm calculate posterior states time, given everything observed (assuming already know filtered distribution states). details implementation see dos Santos et al. (2024) . details algorithm implemented see Alves et al. (2024) , Petris et al. (2009) , chapter 2, West Harrison (1997) , chapter 4, Kalman (1960) .","code":""},{"path":"/reference/generic_smoother.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"generic_smoother — generic_smoother","text":"Mariane Branco Alves, Helio S. Migon, Raíra Marotta, Junior, Silvaneo Vieira dos Santos (2024). “k-parametric Dynamic Generalized Linear Models: sequential approach via Information Geometry.” 2201.05387. Junior, Silvaneo Vieira dos Santos, Mariane Branco Alves, Helio S. Migon (2024). “kDGLM: R package Bayesian analysis Dynamic Generialized Linear Models.” Rudolph Emil Kalman (1960). “New Approach Linear Filtering Prediction Problems.” Transactions ASME--Journal Basic Engineering, 82(Series D), 35--45. Giovanni Petris, Sonia Petrone, Patrizia Campagnoli (2009). Dynamic Linear Models R,  useR! Springer-Verlag, New York. Mike West, Jeff Harrison (1997). Bayesian Forecasting Dynamic Models (Springer Series Statistics). Springer-Verlag. ISBN 0387947256.","code":""},{"path":[]},{"path":"/reference/ginv.html","id":null,"dir":"Reference","previous_headings":"","what":"ginv — ginv","title":"ginv — ginv","text":"function receives covariance matrix S calculates generalized inverse S.","code":""},{"path":"/reference/ginv.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"ginv — ginv","text":"","code":"ginv(S)"},{"path":"/reference/ginv.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"ginv — ginv","text":"S covariance matrix","code":""},{"path":"/reference/harmonic_block.html","id":null,"dir":"Reference","previous_headings":"","what":"Structural blocks for seasonal trends and regressions — harmonic_block","title":"Structural blocks for seasonal trends and regressions — harmonic_block","text":"Creates structure harmonic block desired periodicity.","code":""},{"path":"/reference/harmonic_block.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Structural blocks for seasonal trends and regressions — harmonic_block","text":"","code":"harmonic_block(   ...,   period,   order = 1,   name = \"Var.Sazo\",   D = 1,   h = 0,   H = 0,   a1 = 0,   R1 = 4,   monitoring = rep(FALSE, order * 2) )"},{"path":"/reference/harmonic_block.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Structural blocks for seasonal trends and regressions — harmonic_block","text":"... Named values planning matrix. period Positive integer: size harmonic cycle. order Positive integer: order harmonic structure. name String: optional argument providing name block. Can useful identify models meaningful labels, also, name used used auxiliary functions. D Array, Matrix, vector scalar: values discount factors associated latent states time. D array, dimensions (2n) x (2n) x t, n order harmonic block t length outcomes. D matrix, dimensions (2n) x (2n) discount matrix used observations. D vector, size t interpreted discount factor observed time (discount variable). D scalar, discount used latent states times. h Matrix, vector scalar: drift add temporal evolution (can interpreted mean random noise time). matrix, dimension (2n) x t, n order harmonic_block t length series. vector, size t, value applied first latent state (one affects linear predictors) respective time. scalar, passed value used first latent state time. H Array, Matrix, vector scalar: values covariance matrix noise factor time. H array, dimensions (2n) x (2n) x t, n order harmonic block t length series. H matrix, dimensions (2n) x (2n) values used time. H vector scalar, discount factor matrix created diagonal matrix values H diagonal. a1 Vector scalar: prior mean latent states associated block time 1. a1 vector, dimension equal two times order harmonic block. a1 scalar, value used latent states. R1 Matrix, vector scalar: prior covariance matrix latent states associated block time 1. R1 matrix, dimensions (2n) x (2n). R1 vector scalar, covariance matrix created diagonal matrix values R1 diagonal. monitoring Vector: vector flags indicating variables monitored (automated monitoring used). size 2n. default first order component structure monitored.","code":""},{"path":"/reference/harmonic_block.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Structural blocks for seasonal trends and regressions — harmonic_block","text":"dlm_block object containing following values: FF Array: 3D-array containing regression matrix time. dimension n x k x t, n number latent states, k number linear predictors model t time series length. FF.labs Matrix: n x k character matrix describing type value element FF. G Matrix: 3D-array containing evolution matrix time. dimension n x n x t, n number latent states t time series length. G.labs Matrix: n x n character matrix describing type value element G. D Array: 3D-array containing discount factor matrix time. dimension n x n x t, n number latent states t time series length. h Matrix: mean random noise temporal evolution. dimension n x t. H Array: 3D-array containing covariance matrix noise time. dimension D. a1 Vector: prior mean latent vector. R1 Matrix: prior covariance matrix latent vector. var.names list: list containing variables indexes name. period Positive integer: argument. n Positive integer: number latent states associated block (2). t Positive integer: number time steps associated block. 1, block compatible blocks time length, t greater 1, block can used blocks time length. k Positive integer: number outcomes associated block. block can used blocks outcome length. pred.names Vector: name linear predictors associated block. monitoring Vector: argument. type Character: type block (Harmonic).","code":""},{"path":"/reference/harmonic_block.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Structural blocks for seasonal trends and regressions — harmonic_block","text":"..., D, H, a1 R1 arguments, user may set one values string. , user leave block partially undefined. user must pass undefined parameter values named arguments fit_model function. Also, multiple values can passed, allowing sensitivity analysis value parameter. details implementation see dos Santos et al. (2024) . details modelling seasonal trends using harmonics context DLM's, see West Harrison (1997) , chapter 8. details dynamic regression models context DLM's, see West Harrison (1997) , chapters 6 9.","code":""},{"path":"/reference/harmonic_block.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Structural blocks for seasonal trends and regressions — harmonic_block","text":"Junior, Silvaneo Vieira dos Santos, Mariane Branco Alves, Helio S. Migon (2024). “kDGLM: R package Bayesian analysis Dynamic Generialized Linear Models.” Mike West, Jeff Harrison (1997). Bayesian Forecasting Dynamic Models (Springer Series Statistics). Springer-Verlag. ISBN 0387947256.","code":""},{"path":[]},{"path":"/reference/harmonic_block.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Structural blocks for seasonal trends and regressions — harmonic_block","text":"","code":"# Creating seasonal structure for a model with 2 outcomes. # One block is created for each outcome # with each block being associated with only one of the outcomes. season.1 <- harmonic_block(alpha1 = 1, period = 3) season.2 <- harmonic_block(alpha2 = 1, period = 6)  # Creating a block with shared effect between the outcomes season.3 <- harmonic_block(alpha = 1, alpha2 = 1, period = 12)"},{"path":"/reference/if.na.html","id":null,"dir":"Reference","previous_headings":"","what":"if.na — if.na","title":"if.na — if.na","text":"function wrapper ifelse(.na(vec),vec,val)","code":""},{"path":"/reference/if.na.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"if.na — if.na","text":"","code":"if.na(vec, val)"},{"path":"/reference/if.na.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"if.na — if.na","text":"vec vector matrix. val value replace NA .","code":""},{"path":"/reference/if.na.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"if.na — if.na","text":"vector matrix dimensions input, NA values replaced specified val argument.","code":""},{"path":"/reference/if.nan.html","id":null,"dir":"Reference","previous_headings":"","what":"if.nan — if.nan","title":"if.nan — if.nan","text":"function wrapper ifelse(.nan(vec),vec,val)","code":""},{"path":"/reference/if.nan.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"if.nan — if.nan","text":"","code":"if.nan(vec, val)"},{"path":"/reference/if.nan.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"if.nan — if.nan","text":"vec vector matrix. val value replace NaN .","code":""},{"path":"/reference/if.nan.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"if.nan — if.nan","text":"vector matrix dimensions input, NaN values replaced specified val argument.","code":""},{"path":"/reference/if.null.html","id":null,"dir":"Reference","previous_headings":"","what":"if.null — if.null","title":"if.null — if.null","text":"function wrapper ifelse(.null(.),.,.)","code":""},{"path":"/reference/if.null.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"if.null — if.null","text":"","code":"if.null(vec, val)"},{"path":"/reference/if.null.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"if.null — if.null","text":"vec vector matrix. val value replace NULL .","code":""},{"path":"/reference/if.null.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"if.null — if.null","text":"vector matrix dimensions input, NULL values replaced specified val argument.","code":""},{"path":"/reference/intervention.html","id":null,"dir":"Reference","previous_headings":"","what":"An auxiliary function for model intervention — intervention","title":"An auxiliary function for model intervention — intervention","text":"function adds timely modifications dlm_block, specified time model override usual value variable value chosen user.","code":""},{"path":"/reference/intervention.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"An auxiliary function for model intervention — intervention","text":"","code":"intervention(   block,   time,   var.index = 1:block$n,   FF = NULL,   D = NULL,   h = NULL,   H = NULL,   G = NULL )"},{"path":"/reference/intervention.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"An auxiliary function for model intervention — intervention","text":"block dlm_block: block add intervention. time Vector: sequence integers indicating time intervention. var.index Vector: sequence integers indicating variables modified intervention. FF Array: n x k x t array modified FF used intervention, n length var.index, k number linear predictors block t size time (can omitted time scalar). D Array: n x n x t array modified D used intervention, n length var.index t size time (can omitted time scalar). h matrix: n x t matrix modified h used intervention, n length var.index t size time (can omitted time scalar). H Array: n x n x t array modified H used intervention, n length var.index t size time (can omitted time scalar). G Array: n x n x t array modified G used intervention, n length var.index t size time (can omitted time scalar).","code":""},{"path":"/reference/intervention.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"An auxiliary function for model intervention — intervention","text":"dlm_block added intervention.","code":""},{"path":[]},{"path":"/reference/intervention.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"An auxiliary function for model intervention — intervention","text":"","code":"data <- c(AirPassengers) # Adding an artificial change, so that we can make an intervention on the data at that point # Obviously, one should NOT change their own data. data[60:144] <- data[60:144] + 500  level <- polynomial_block(rate = 1, order = 2, D = 0.95) season <- harmonic_block(rate = 1, order = 2, period = 12, D = 0.975)  # Reducing the discount factor so that the model can capture the expected change. level <- level |> intervention(time = 60, H = 1, var.index = 1) # Comment the line above to see the fit without the intervention  outcome <- Poisson(lambda = \"rate\", data = data)  fitted.data <- fit_model(level, season,   AirPassengers = outcome )  plot(fitted.data, plot.pkg = \"base\")"},{"path":"/reference/joint_prior.html","id":null,"dir":"Reference","previous_headings":"","what":"Joint prior — joint_prior","title":"Joint prior — joint_prior","text":"Defines joint prior structural block.","code":""},{"path":"/reference/joint_prior.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Joint prior — joint_prior","text":"","code":"joint_prior(   block,   var.index = 1:block$n,   a1 = block$a1[var.index],   R1 = block$R1[var.index, var.index] )"},{"path":"/reference/joint_prior.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Joint prior — joint_prior","text":"block dlm_block object: structural block. var.index Integer: index variables set prior. a1 Numeric: prior mean. R1 Matrix: prior covariance matrix.","code":""},{"path":"/reference/joint_prior.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Joint prior — joint_prior","text":"dlm_block object desired prior.","code":""},{"path":"/reference/joint_prior.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Joint prior — joint_prior","text":"discount factor must variables whose prior modified. details implementation see dos Santos et al. (2024) .","code":""},{"path":"/reference/joint_prior.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Joint prior — joint_prior","text":"Junior, Silvaneo Vieira dos Santos, Mariane Branco Alves, Helio S. Migon (2024). “kDGLM: R package Bayesian analysis Dynamic Generialized Linear Models.”","code":""},{"path":[]},{"path":"/reference/joint_prior.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Joint prior — joint_prior","text":"","code":"polynomial_block(mu = 1, D = 0.95) |>   block_mult(5) |>   joint_prior(var.index = 1:2, R1 = matrix(c(1, 0.5, 0.5, 1), 2, 2)) #> Mixed DLM block. #> latent states:  #>     Var.Poly.1: Level (1 variable(s)) #>     Var.Poly.2: Level (1 variable(s)) #>     Var.Poly.3: Level (1 variable(s)) #>     Var.Poly.4: Level (1 variable(s)) #>     Var.Poly.5: Level (1 variable(s)) #>  #> Linear predictors:  #>     mu.1 #>     mu.2 #>     mu.3 #>     mu.4 #>     mu.5 #>  #> Status: defined #> Serie length: 1 #> Interventions at:  #> Number of latent states: 5 #> Number of linear predictors: 5"},{"path":"/reference/lcm.html","id":null,"dir":"Reference","previous_headings":"","what":"lcm — lcm","title":"lcm — lcm","text":"Calculates least common multiple set integer. Internal use .","code":""},{"path":"/reference/lcm.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"lcm — lcm","text":"","code":"lcm(x)"},{"path":"/reference/lcm.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"lcm — lcm","text":"x numeric: sequence integers.","code":""},{"path":"/reference/lcm.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"lcm — lcm","text":"least common multiple.","code":""},{"path":"/reference/Multinom.html","id":null,"dir":"Reference","previous_headings":"","what":"Multinom outcome for kDGLM models — Multinom","title":"Multinom outcome for kDGLM models — Multinom","text":"Creates outcome Multinomial distribution chosen parameters.","code":""},{"path":"/reference/Multinom.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Multinom outcome for kDGLM models — Multinom","text":"","code":"Multinom(p, data, offset = as.matrix(data)^0, base.class = NULL)"},{"path":"/reference/Multinom.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Multinom outcome for kDGLM models — Multinom","text":"p character: vector name linear predictor associated probability category (except base one, assumed last). data vector: Values observed data. offset vector: offset observation. Must shape data. base.class character integer: name index base class. Default use last column data.","code":""},{"path":"/reference/Multinom.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Multinom outcome for kDGLM models — Multinom","text":"object class dlm_distr","code":""},{"path":"/reference/Multinom.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Multinom outcome for kDGLM models — Multinom","text":"evaluating posterior parameters, use method proposed Alves et al. (2024) . details implementation see  dos Santos et al. (2024) .","code":""},{"path":"/reference/Multinom.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Multinom outcome for kDGLM models — Multinom","text":"Mariane Branco Alves, Helio S. Migon, Raíra Marotta, Junior, Silvaneo Vieira dos Santos (2024). “k-parametric Dynamic Generalized Linear Models: sequential approach via Information Geometry.” 2201.05387. Junior, Silvaneo Vieira dos Santos, Mariane Branco Alves, Helio S. Migon (2024). “kDGLM: R package Bayesian analysis Dynamic Generialized Linear Models.”","code":""},{"path":[]},{"path":"/reference/Multinom.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Multinom outcome for kDGLM models — Multinom","text":"","code":"structure <- (   polynomial_block(p = 1, order = 2, D = 0.95) +     harmonic_block(p = 1, period = 12, D = 0.975) +     noise_block(p = 1, R1 = 0.1) +     regression_block(p = chickenPox$date >= as.Date(\"2013-09-01\"))   # Vaccine was introduced in September of 2013 ) * 4  outcome <- Multinom(p = structure$pred.names, data = chickenPox[, c(2, 3, 4, 6, 5)]) fitted.data <- fit_model(structure, chickenPox = outcome) summary(fitted.data) #> Fitted DGLM with 1 outcomes. #>  #> distributions: #>     chickenPox: Multinomial #>  #> Static coeficients (smoothed): #>                  Estimate Std. Error   t value Pr(>|t|) #> Var.Reg.1         0.38672    0.25101  1.54061    0.123    #> Var.Reg.2         0.46804    0.26503  1.76600    0.077    #> Var.Reg.3         0.48480    0.28504  1.70080    0.089    #> Var.Reg.4        -0.26821    0.24810 -1.08105    0.280    #> --- #> Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1 #>  #> --- #> See the coef.fitted_dlm for the coeficients with temporal dynamic. #>  #> One-step-ahead prediction #> Log-likelihood        : -1962.023 #> Interval Score        : 167.73519 #> Mean Abs. Scaled Error:   0.77385 #> --- plot(fitted.data, plot.pkg = \"base\")"},{"path":"/reference/multi_normal_gamma_pred.html","id":null,"dir":"Reference","previous_headings":"","what":"update_multi_NG_chol\r\nmulti_normal_gamma_pred — multi_normal_gamma_pred","title":"update_multi_NG_chol\r\nmulti_normal_gamma_pred — multi_normal_gamma_pred","text":"update_multi_NG_chol multi_normal_gamma_pred","code":""},{"path":"/reference/multi_normal_gamma_pred.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"update_multi_NG_chol\r\nmulti_normal_gamma_pred — multi_normal_gamma_pred","text":"","code":"multi_normal_gamma_pred(   conj.param,   outcome = NULL,   parms = list(),   pred.cred = 0.95 )"},{"path":"/reference/multi_normal_gamma_pred.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"update_multi_NG_chol\r\nmulti_normal_gamma_pred — multi_normal_gamma_pred","text":"conj.param list data.frame: parameters conjugated distribution (Normal-Gamma) linear predictor. outcome numeric matrix (optional): observed values current time. parms list (optional): list extra parameters model. used function. pred.cred numeric: desired credibility credibility interval.","code":""},{"path":"/reference/multi_normal_gamma_pred.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"update_multi_NG_chol\r\nmulti_normal_gamma_pred — multi_normal_gamma_pred","text":"list containing following values: pred numeric/matrix: mean predictive distribution next observation. type shape parameter model. var.pred numeric/matrix: variance predictive distribution next observation. type shape parameter model. icl.pred numeric/matrix: percentile 100*((1-pred.cred)/2) icu.pred numeric/matrix: percentile 100*(1-(1-pred.cred)/2) log.like numeric: log likelihood outcome given conjugated parameters.","code":""},{"path":[]},{"path":"/reference/multnom_pred.html","id":null,"dir":"Reference","previous_headings":"","what":"multnom_pred — multnom_pred","title":"multnom_pred — multnom_pred","text":"Calculate values predictive distribution given values parameter conjugated distribution linear predictor. data assumed Multinomial distribution known number trial N probability vector distribution Dirichlet parameters alpha_i. scenario, marginal distribution data Dirichlet-Multinomial parameters N alpha_i.","code":""},{"path":"/reference/multnom_pred.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"multnom_pred — multnom_pred","text":"","code":"multnom_pred(conj.param, outcome, parms = list(), pred.cred = 0.95)"},{"path":"/reference/multnom_pred.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"multnom_pred — multnom_pred","text":"conj.param List data.frame: parameters conjugated distributions linear predictor. outcome Vector matrix: observed values current time. value passed used compute N. parms List (optional): list extra parameters model. used function. pred.cred Numeric: desired credibility credibility interval.","code":""},{"path":"/reference/multnom_pred.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"multnom_pred — multnom_pred","text":"list containing following values: pred vector/matrix: mean predictive distribution next observation. type shape parameter model. var.pred vector/matrix: variance predictive distribution next observation. type shape parameter model. icl.pred vector/matrix: percentile 100*((1-pred.cred)/2) icu.pred vector/matrix: percentile 100*(1-(1-pred.cred)/2) log.like vector: log likelihood outcome given conjugated parameters.","code":""},{"path":[]},{"path":"/reference/noise_block.html","id":null,"dir":"Reference","previous_headings":"","what":"noise_block — noise_block","title":"noise_block — noise_block","text":"Creates structure Noise block. block represents independent random noise added linear predictor. variance noise formally estimated, use discount strategy similar West Harrison (1997)  specify .","code":""},{"path":"/reference/noise_block.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"noise_block — noise_block","text":"","code":"noise_block(..., name = \"Noise\", D = 0.99, R1 = 0.1, H = 0)"},{"path":"/reference/noise_block.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"noise_block — noise_block","text":"... Named values planning matrix. name String: optional argument providing name block. Can useful identify models meaningful labels, also, name used used auxiliary functions. D scalar vector: sequence values specifying desired discount factor time. length 1 t, t size series. D H specified, value D ignored. R1 scalar: prior variance noise. H scalar: variance noise. D H specified, value D ignored.","code":""},{"path":"/reference/noise_block.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"noise_block — noise_block","text":"dlm_block object containing following values: FF Array: 3D-array containing regression matrix time. dimension n x k x t, n number latent states, k number linear predictors model t time series length. FF.labs Matrix: n x k character matrix describing type value element FF. G Matrix: 3D-array containing evolution matrix time. dimension n x n x t, n number latent states t time series length. G.labs Matrix: n x n character matrix describing type value element G. D Array: 3D-array containing discount factor matrix time. dimension n x n x t, n number latent states t time series length. H Array: 3D-array containing covariance matrix noise time. dimension D. a1 Vector: prior mean latent vector. R1 Matrix: prior covariance matrix latent vector. var.names list: list containing variables indexes name. order Positive integer: argument. n Positive integer: number latent states associated block (2). t Positive integer: number time steps associated block. 1, block compatible blocks time length, t greater 1, block can used blocks time length. k Positive integer: number outcomes associated block. block can used blocks outcome length. pred.names Vector: name linear predictors associated block. monitoring Vector: combination monitoring, monitoring monitoring.pulse. type Character: type block (Noise).","code":""},{"path":"/reference/noise_block.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"noise_block — noise_block","text":"details implementation see dos Santos et al. (2024) . details dynamic regression models context DLMs, see West Harrison (1997) , chapters 6 9.","code":""},{"path":"/reference/noise_block.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"noise_block — noise_block","text":"Junior, Silvaneo Vieira dos Santos, Mariane Branco Alves, Helio S. Migon (2024). “kDGLM: R package Bayesian analysis Dynamic Generialized Linear Models.” Mike West, Jeff Harrison (1997). Bayesian Forecasting Dynamic Models (Springer Series Statistics). Springer-Verlag. ISBN 0387947256.","code":""},{"path":[]},{"path":"/reference/noise_block.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"noise_block — noise_block","text":"","code":"noise_block(mu = 1, D = 0.99, R1 = 1e-2) #> Noise DLM block. #> latent states:  #>     Noise: Var (1 variable(s)) #>  #> Linear predictors:  #>     mu #>  #> Status: defined #> Serie length: 1 #> Interventions at:  #> Number of latent states: 1 #> Number of linear predictors: 1"},{"path":"/reference/Normal.html","id":null,"dir":"Reference","previous_headings":"","what":"Normal outcome for kDGLM models — Normal","title":"Normal outcome for kDGLM models — Normal","text":"Creates outcome Normal distribution chosen parameters (can specify 2).","code":""},{"path":"/reference/Normal.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Normal outcome for kDGLM models — Normal","text":"","code":"Normal(mu, V = NA, Tau = NA, Sd = NA, data)"},{"path":"/reference/Normal.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Normal outcome for kDGLM models — Normal","text":"mu character: Name linear predictor associated mean parameter Normal distribution. parameter treated unknown equal associated linear predictor. V character numeric: V character, interpreted names linear predictors associated variance parameter Normal distribution. V numeric, variance considered known equal value V, otherwise, variance considered unknown equal exponential linear predictor informed V. outcome Multivariate Normal, V must matrix , variance unknown, elements outside main diagonal treated linear predictor associated correlation coordinate outcome, otherwise V treated covariance matrix. user specify V Tau Sd. Tau character numeric: Tau character, interpreted names linear predictors associated precisions parameter Normal distribution. Tau numeric, precision considered known equal value Tau, otherwise, precision considered unknown equal exponential linear predictor informed Tau. outcome Multivariate Normal, Tau must matrix , precision unknown, elements outside main diagonal treated linear predictor associated correlation coordinate outcome, otherwise Tau treated precision matrix. user specify Tau V Sd. Sd character numeric: Sd character, interpreted names linear predictors associated standard deviation parameter Normal distribution. Sd numeric, standard deviation considered known equal value Sd, otherwise, precision considered unknown equal exponential linear predictor informed Sd. outcome Multivariate Normal, Tau must matrix elements outside main diagonal treated correlation (name linear predictor associated) coordinate outcome. user specify Sd V Tau. data numeric: Values observed data.","code":""},{"path":"/reference/Normal.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Normal outcome for kDGLM models — Normal","text":"object class dlm_distr","code":""},{"path":"/reference/Normal.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Normal outcome for kDGLM models — Normal","text":"V/Sigma/Tau/Sd string, use method proposed Alves et al. (2024) . Otherwise, V/Sigma/Tau/Sd numeric, follow theory presented West Harrison (1997) . details implementation see  dos Santos et al. (2024) .","code":""},{"path":"/reference/Normal.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Normal outcome for kDGLM models — Normal","text":"Mariane Branco Alves, Helio S. Migon, Raíra Marotta, Junior, Silvaneo Vieira dos Santos (2024). “k-parametric Dynamic Generalized Linear Models: sequential approach via Information Geometry.” 2201.05387. Junior, Silvaneo Vieira dos Santos, Mariane Branco Alves, Helio S. Migon (2024). “kDGLM: R package Bayesian analysis Dynamic Generialized Linear Models.” Mike West, Jeff Harrison (1997). Bayesian Forecasting Dynamic Models (Springer Series Statistics). Springer-Verlag. ISBN 0387947256.","code":""},{"path":[]},{"path":"/reference/Normal.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Normal outcome for kDGLM models — Normal","text":"","code":"# Univariate Normal case structure <- polynomial_block(mu = 1, D = 0.95) +   polynomial_block(V = 1, D = 0.95)  outcome <- Normal(mu = \"mu\", V = \"V\", data = cornWheat$corn.log.return[1:500]) fitted.data <- fit_model(structure, corn = outcome) summary(fitted.data) #> Fitted DGLM with 1 outcomes. #>  #> distributions: #>     corn: Normal #>  #> --- #> No static coeficients. #> --- #> See the coef.fitted_dlm for the coeficients with temporal dynamic. #>  #> One-step-ahead prediction #> Log-likelihood        : 1277.54 #> Interval Score        : 0.07564 #> Mean Abs. Scaled Error: 0.76327 #> --- plot(fitted.data, plot.pkg = \"base\")   # Bivariate Normal case structure <- (polynomial_block(mu = 1, D = 0.95) +   polynomial_block(V = 1, D = 0.95)) * 2 +   polynomial_block(rho = 1, D = 0.95)  outcome <- Normal(   mu = c(\"mu.1\", \"mu.2\"),   V = matrix(c(\"V.1\", \"rho\", \"rho\", \"V.2\"), 2, 2),   data = cornWheat[1:500, c(4, 5)] ) fitted.data <- fit_model(structure, cornWheat = outcome) summary(fitted.data) #> Fitted DGLM with 1 outcomes. #>  #> distributions: #>     cornWheat: Normal #>  #> --- #> No static coeficients. #> --- #> See the coef.fitted_dlm for the coeficients with temporal dynamic. #>  #> One-step-ahead prediction #> Log-likelihood        : 2557.802 #> Interval Score        : 0.07505 #> Mean Abs. Scaled Error: 0.74750 #> --- plot(fitted.data, plot.pkg = \"base\")"},{"path":"/reference/normal_pred.html","id":null,"dir":"Reference","previous_headings":"","what":"normal_pred — normal_pred","title":"normal_pred — normal_pred","text":"Calculate values predictive distribution given values parameter conjugated distribution linear predictor. data assumed Normal distribution known variance mean distribution Normal. scenario, marginal distribution data also Normal.","code":""},{"path":"/reference/normal_pred.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"normal_pred — normal_pred","text":"","code":"normal_pred(conj.param, outcome = NULL, parms = list(), pred.cred = 0.95)"},{"path":"/reference/normal_pred.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"normal_pred — normal_pred","text":"conj.param list data.frame: parameters conjugated distributions linear predictor. outcome numeric matrix (optional): observed values current time. used function. parms list: list extra parameters model. function, must contain observational covariance matrix, V pred.cred numeric: desired credibility credibility interval.","code":""},{"path":"/reference/normal_pred.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"normal_pred — normal_pred","text":"list containing following values: pred numeric/matrix: mean predictive distribution next observation. type shape parameter model. var.pred numeric/matrix: variance predictive distribution next observation. type shape parameter model. icl.pred numeric/matrix: percentile 100*((1-pred.cred)/2) icu.pred numeric/matrix: percentile 100*(1-(1-pred.cred)/2) log.like numeric: log likelihood outcome given conjugated parameters.","code":""},{"path":[]},{"path":"/reference/noticeSARI.html","id":null,"dir":"Reference","previous_headings":"","what":"SARI data from Belo Horizonte — noticeSARI","title":"SARI data from Belo Horizonte — noticeSARI","text":"dataset containing reports Severe Acute Respiratory Illness (SARI) 2020 April 2022 week.","code":""},{"path":"/reference/noticeSARI.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"SARI data from Belo Horizonte — noticeSARI","text":"","code":"noticeSARI"},{"path":"/reference/noticeSARI.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"SARI data from Belo Horizonte — noticeSARI","text":"data frame 65404 rows 7 variables: ref.week reference week, counting since monitoring begun. reported.1.week number cases occurred period reported 1 week reference week. reported.2.week number cases occurred period reported 2 weeks reference week. reported.4.week number cases occurred period reported 4 weeks reference week. reported.6.week number cases occurred period reported 6 weeks reference week. reported.8.week number cases occurred period reported 8 weeks reference week. reported.12.week number cases occurred period reported 12 weeks reference week. occured total number cases reported (time).","code":""},{"path":"/reference/noticeSARI.html","id":"source","dir":"Reference","previous_headings":"","what":"Source","title":"SARI data from Belo Horizonte — noticeSARI","text":"https://datasus.saude.gov.br/informacoes-de-saude-tabnet/","code":""},{"path":"/reference/plot.dlm_coef.html","id":null,"dir":"Reference","previous_headings":"","what":"Visualizing latent states in a fitted kDGLM model — plot.dlm_coef","title":"Visualizing latent states in a fitted kDGLM model — plot.dlm_coef","text":"Visualizing latent states fitted kDGLM model","code":""},{"path":"/reference/plot.dlm_coef.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Visualizing latent states in a fitted kDGLM model — plot.dlm_coef","text":"","code":"# S3 method for dlm_coef plot(   x,   var = rownames(x$theta.mean)[x$dynamic],   cutoff = floor(t/10),   pred.cred = 0.95,   plot.pkg = \"auto\",   ... )"},{"path":"/reference/plot.dlm_coef.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Visualizing latent states in a fitted kDGLM model — plot.dlm_coef","text":"x dlm_coef object: coefficients fitted DGLM model. var character: name variables plot (value passed creating structure). variable whose name partially match variable plotted. cutoff integer: number initial steps skipped plot. Usually, model still learning initial steps, estimated values reliable. pred.cred numeric: credibility value credibility interval. plot.pkg character: flag indicating plot produced. one 'auto', 'base', 'ggplot2' 'plotly'. ... Extra arguments passed plot method.","code":""},{"path":"/reference/plot.dlm_coef.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Visualizing latent states in a fitted kDGLM model — plot.dlm_coef","text":"ggplot plotly object: plot showing predictive mean credibility interval observed data.","code":""},{"path":[]},{"path":"/reference/plot.dlm_coef.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Visualizing latent states in a fitted kDGLM model — plot.dlm_coef","text":"","code":"data <- c(AirPassengers)  level <- polynomial_block(rate = 1, order = 2, D = 0.95) season <- harmonic_block(rate = 1, order = 2, period = 12, D = 0.975)  outcome <- Poisson(lambda = \"rate\", data)  fitted.data <- fit_model(level, season,   AirPassengers = outcome )  model.coef <- coef(fitted.data)  plot(model.coef)$plot #> NULL"},{"path":"/reference/plot.fitted_dlm.html","id":null,"dir":"Reference","previous_headings":"","what":"Visualizing a fitted kDGLM model — plot.fitted_dlm","title":"Visualizing a fitted kDGLM model — plot.fitted_dlm","text":"Calculate predictive mean quantile observed data show plot.","code":""},{"path":"/reference/plot.fitted_dlm.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Visualizing a fitted kDGLM model — plot.fitted_dlm","text":"","code":"# S3 method for fitted_dlm plot(   x,   outcomes = NULL,   latent.states = NULL,   linear.predictors = NULL,   pred.cred = 0.95,   lag = NA,   cutoff = floor(x$t/10),   plot.pkg = \"auto\",   ... )"},{"path":"/reference/plot.fitted_dlm.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Visualizing a fitted kDGLM model — plot.fitted_dlm","text":"x fitted_dlm object: fitted DGLM. outcomes character: name outcomes plot. latent.states character: name latent states plot. linear.predictors character: name linear predictors plot. pred.cred numeric: credibility value credibility interval. lag integer: number steps ahead used prediction. lag<0, smoothed distribution used , lag==0, filtered interval.score used. cutoff integer: number initial steps skipped plot. Usually, model still learning initial steps, predictions reliable. plot.pkg character: flag indicating plot produced. one 'auto', 'base', 'ggplot2' 'plotly'. ... Extra arguments passed plot method.","code":""},{"path":"/reference/plot.fitted_dlm.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Visualizing a fitted kDGLM model — plot.fitted_dlm","text":"ggplot plotly object: plot showing predictive mean credibility interval observed data.","code":""},{"path":[]},{"path":"/reference/plot.fitted_dlm.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Visualizing a fitted kDGLM model — plot.fitted_dlm","text":"","code":"data <- c(AirPassengers)  level <- polynomial_block(rate = 1, order = 2, D = 0.95) season <- harmonic_block(rate = 1, order = 2, period = 12, D = 0.975)  outcome <- Poisson(lambda = \"rate\", data)  fitted.data <- fit_model(level, season,   AirPassengers = outcome )  plot(fitted.data, plot.pkg = \"base\")"},{"path":"/reference/plus-.dlm_block.html","id":null,"dir":"Reference","previous_headings":"","what":"+.fitted_dlm — +.dlm_block","title":"+.fitted_dlm — +.dlm_block","text":"Define add operator class dlm_block. method wrapper block_superpos function.","code":""},{"path":"/reference/plus-.dlm_block.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"+.fitted_dlm — +.dlm_block","text":"","code":"# S3 method for dlm_block +(e1, e2)"},{"path":"/reference/plus-.dlm_block.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"+.fitted_dlm — +.dlm_block","text":"e1 dlm_block. e2 dlm_block.","code":""},{"path":"/reference/plus-.dlm_block.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"+.fitted_dlm — +.dlm_block","text":"combined blocks dlm_block.","code":""},{"path":[]},{"path":"/reference/Poisson.html","id":null,"dir":"Reference","previous_headings":"","what":"Poisson outcome for kDGLM models — Poisson","title":"Poisson outcome for kDGLM models — Poisson","text":"Creates outcome Poisson distribution chosen parameter.","code":""},{"path":"/reference/Poisson.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Poisson outcome for kDGLM models — Poisson","text":"","code":"Poisson(lambda, data, offset = as.matrix(data)^0)"},{"path":"/reference/Poisson.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Poisson outcome for kDGLM models — Poisson","text":"lambda character: name linear predictor associated rate (mean) parameter Poisson distribution. parameter treated unknown equal exponential associated linear predictor. data numeric: values observed data. offset numeric: offset observation. Must shape data.","code":""},{"path":"/reference/Poisson.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Poisson outcome for kDGLM models — Poisson","text":"object class dlm_distr","code":""},{"path":"/reference/Poisson.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Poisson outcome for kDGLM models — Poisson","text":"evaluating posterior parameters, use method proposed Alves et al. (2024) . details implementation see  dos Santos et al. (2024) .","code":""},{"path":"/reference/Poisson.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Poisson outcome for kDGLM models — Poisson","text":"Mariane Branco Alves, Helio S. Migon, Raíra Marotta, Junior, Silvaneo Vieira dos Santos (2024). “k-parametric Dynamic Generalized Linear Models: sequential approach via Information Geometry.” 2201.05387. Junior, Silvaneo Vieira dos Santos, Mariane Branco Alves, Helio S. Migon (2024). “kDGLM: R package Bayesian analysis Dynamic Generialized Linear Models.”","code":""},{"path":[]},{"path":"/reference/Poisson.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Poisson outcome for kDGLM models — Poisson","text":"","code":"data <- c(AirPassengers)  level <- polynomial_block(rate = 1, D = 0.95, order = 2) season <- harmonic_block(rate = 1, period = 12, D = 0.975)  outcome <- Poisson(lambda = \"rate\", data = data)  fitted.data <- fit_model(level, season,   AirPassengers = outcome ) summary(fitted.data) #> Fitted DGLM with 1 outcomes. #>  #> distributions: #>     AirPassengers: Poisson #>  #> --- #> No static coeficients. #> --- #> See the coef.fitted_dlm for the coeficients with temporal dynamic. #>  #> One-step-ahead prediction #> Log-likelihood        : -625.2975 #> Interval Score        : 138.36923 #> Mean Abs. Scaled Error:   0.68377 #> ---  plot(fitted.data, plot.pkg = \"base\")"},{"path":"/reference/poisson_pred.html","id":null,"dir":"Reference","previous_headings":"","what":"poisson_pred — poisson_pred","title":"poisson_pred — poisson_pred","text":"Calculate values predictive distribution given values parameter conjugated distribution linear predictor. data assumed Poisson distribution mean distribution Gamma shape parameter e rate parameter b. scenario, marginal distribution data Negative Binomial dispersion parameter b/(b+1) probability.","code":""},{"path":"/reference/poisson_pred.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"poisson_pred — poisson_pred","text":"","code":"poisson_pred(conj.param, outcome = NULL, parms = list(), pred.cred = 0.95)"},{"path":"/reference/poisson_pred.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"poisson_pred — poisson_pred","text":"conj.param list data.frame: parameters conjugated distributions linear predictor. outcome numeric matrix (optional): observed values current time. used function. parms list (optional): list extra parameters model. used function. pred.cred numeric: desired credibility credibility interval.","code":""},{"path":"/reference/poisson_pred.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"poisson_pred — poisson_pred","text":"list containing following values: pred numeric/matrix: mean predictive distribution next observation. type shape parameter model. var.pred numeric/matrix: variance predictive distribution next observation. type shape parameter model. icl.pred numeric/matrix: percentile 100*((1-pred.cred)/2) icu.pred numeric/matrix: percentile 100*(1-(1-pred.cred)/2) log.like numeric: log likelihood outcome given conjugated parameters.","code":""},{"path":[]},{"path":"/reference/polynomial_block.html","id":null,"dir":"Reference","previous_headings":"","what":"Structural blocks for polynomial trends and regressions — polynomial_block","title":"Structural blocks for polynomial trends and regressions — polynomial_block","text":"Creates structure polynomial block desired order.","code":""},{"path":"/reference/polynomial_block.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Structural blocks for polynomial trends and regressions — polynomial_block","text":"","code":"polynomial_block(   ...,   order = 1,   name = \"Var.Poly\",   D = 1,   h = 0,   H = 0,   a1 = 0,   R1 = c(9, rep(1, order - 1)),   monitoring = c(TRUE, rep(FALSE, order - 1)) )"},{"path":"/reference/polynomial_block.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Structural blocks for polynomial trends and regressions — polynomial_block","text":"... Named values planning matrix. order Positive integer: order polynomial structure. name String: optional argument providing name block. Can useful identify models meaningful labels, also, name used used auxiliary functions. D Array, Matrix, vector scalar: values discount factors associated latent states time. D array, dimensions n x n x t, n order polynomial block t length outcomes. D matrix, dimensions n x n discount matrix used observations. D vector, size t interpreted discount factor observed time (discount variable). D scalar, discount used latent states times. h Matrix, vector scalar: drift add temporal evolution (can interpreted mean random noise time). matrix, dimension n x t, n number latent states (.e., order) t length series. vector, size t, value applied first latent state (one affects linear predictors) respective time. scalar, passed value used first latent state time. H Array, Matrix, vector scalar: values covariance matrix noise factor time. H array, dimensions n x n x t, n order polynomial block t length series. H matrix, dimensions n x n values used time. H vector scalar, discount factor matrix created diagonal matrix values H diagonal. a1 Vector scalar: prior mean latent states associated block time 1. a1 vector, dimension equal order polynomial block. a1 scalar, value used latent states. R1 Matrix, vector scalar: prior covariance matrix latent states associated block time 1. R1 matrix, dimensions n x n. R1 vector scalar, covariance matrix created diagonal matrix values R1 diagonal. monitoring Vector: vector flags indicating variables monitored (automated monitoring used). size n. default first order component structure monitored.","code":""},{"path":"/reference/polynomial_block.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Structural blocks for polynomial trends and regressions — polynomial_block","text":"dlm_block object containing following values: FF Array: 3D-array containing regression matrix time. dimension n x k x t, n number latent states, k number linear predictors model t time series length. FF.labs Matrix: n x k character matrix describing type value element FF. G Matrix: 3D-array containing evolution matrix time. dimension n x n x t, n number latent states t time series length. G.labs Matrix: n x n character matrix describing type value element G. D Array: 3D-array containing discount factor matrix time. dimension n x n x t, n number latent states t time series length. h Matrix: mean random noise temporal evolution. dimension n x t. H Array: 3D-array containing covariance matrix noise time. dimension D. a1 Vector: prior mean latent vector. R1 Matrix: prior covariance matrix latent vector. var.names list: list containing variables indexes name. order Positive integer: argument. n Positive integer: number latent states associated block (value order). t Positive integer: number time steps associated block. 1, block compatible blocks time length, t greater 1, block can used blocks time length. k Positive integer: number outcomes associated block. block can used blocks outcome length. pred.names Vector: name linear predictors associated block. monitoring Vector: argument. type Character: type block (polynomial).","code":""},{"path":"/reference/polynomial_block.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Structural blocks for polynomial trends and regressions — polynomial_block","text":"..., D, H, a1 R1 arguments, user may set one values string. , user leave block partially undefined. user must pass undefined parameter values named arguments fit_model function. Also, multiple values can passed, allowing sensitivity analysis value parameter. details implementation see dos Santos et al. (2024) . details polynomial trend context DLM's, see West Harrison (1997) , chapter 7. details dynamic regression models context DLM's, see West Harrison (1997) , chapters 6 9.","code":""},{"path":"/reference/polynomial_block.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Structural blocks for polynomial trends and regressions — polynomial_block","text":"Junior, Silvaneo Vieira dos Santos, Mariane Branco Alves, Helio S. Migon (2024). “kDGLM: R package Bayesian analysis Dynamic Generialized Linear Models.” Mike West, Jeff Harrison (1997). Bayesian Forecasting Dynamic Models (Springer Series Statistics). Springer-Verlag. ISBN 0387947256.","code":""},{"path":[]},{"path":"/reference/polynomial_block.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Structural blocks for polynomial trends and regressions — polynomial_block","text":"","code":"# Creating a first order structure for a model with 2 outcomes. # One block is created for each outcome # with each block being associated with only one of the outcomes. level.1 <- polynomial_block(alpha1 = 1, order = 1) level.2 <- polynomial_block(alpha2 = 1, order = 1)  # Creating a block with shared effect between the outcomes level.3 <- polynomial_block(alpha1 = 1, alpha2 = 1, order = 2)"},{"path":"/reference/print.dlm_block.html","id":null,"dir":"Reference","previous_headings":"","what":"print.dlm_block — print.dlm_block","title":"print.dlm_block — print.dlm_block","text":"method wrapper summary.dlm_block function.","code":""},{"path":"/reference/print.dlm_block.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"print.dlm_block — print.dlm_block","text":"","code":"# S3 method for dlm_block print(x, ...)"},{"path":"/reference/print.dlm_block.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"print.dlm_block — print.dlm_block","text":"x dlm_block object. ... Arguments passed summary.dlm_block","code":""},{"path":"/reference/print.dlm_block.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"print.dlm_block — print.dlm_block","text":"return value, called print summary kDGLM structure.","code":""},{"path":[]},{"path":"/reference/print.dlm_distr.html","id":null,"dir":"Reference","previous_headings":"","what":"print.dlm_distr — print.dlm_distr","title":"print.dlm_distr — print.dlm_distr","text":"method wrapper summary.dlm_distr function.","code":""},{"path":"/reference/print.dlm_distr.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"print.dlm_distr — print.dlm_distr","text":"","code":"# S3 method for dlm_distr print(x, ...)"},{"path":"/reference/print.dlm_distr.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"print.dlm_distr — print.dlm_distr","text":"x dlm_distr object. ... Arguments passed summary.dlm_distr","code":""},{"path":"/reference/print.dlm_distr.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"print.dlm_distr — print.dlm_distr","text":"return value, called print summary kDGLM outcome.","code":""},{"path":[]},{"path":"/reference/print.fitted_dlm.html","id":null,"dir":"Reference","previous_headings":"","what":"print.fitted_dlm — print.fitted_dlm","title":"print.fitted_dlm — print.fitted_dlm","text":"method wrapper summary.fitted_dlm methdd.","code":""},{"path":"/reference/print.fitted_dlm.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"print.fitted_dlm — print.fitted_dlm","text":"","code":"# S3 method for fitted_dlm print(x, ...)"},{"path":"/reference/print.fitted_dlm.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"print.fitted_dlm — print.fitted_dlm","text":"x fitted_dlm object. ... Arguments passed summary.fitted_dlm","code":""},{"path":"/reference/print.fitted_dlm.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"print.fitted_dlm — print.fitted_dlm","text":"return value, called print summary fitted kDGLM model.","code":""},{"path":[]},{"path":"/reference/print.searched_dlm.html","id":null,"dir":"Reference","previous_headings":"","what":"print.searched_dlm — print.searched_dlm","title":"print.searched_dlm — print.searched_dlm","text":"method wrapper block_superpos function.","code":""},{"path":"/reference/print.searched_dlm.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"print.searched_dlm — print.searched_dlm","text":"","code":"# S3 method for searched_dlm print(x, ...)"},{"path":"/reference/print.searched_dlm.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"print.searched_dlm — print.searched_dlm","text":"x searched_dlm object. ... Arguments passed summary.searched_dlm","code":""},{"path":"/reference/print.searched_dlm.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"print.searched_dlm — print.searched_dlm","text":"return value, called print summary searched_dlm object.","code":""},{"path":[]},{"path":"/reference/reexports.html","id":null,"dir":"Reference","previous_headings":"","what":"Objects exported from other packages — reexports","title":"Objects exported from other packages — reexports","text":"objects imported packages. Follow links see documentation. generics forecast, specify stats simulate","code":""},{"path":"/reference/regression_block.html","id":null,"dir":"Reference","previous_headings":"","what":"Structural blocks for regressions — regression_block","title":"Structural blocks for regressions — regression_block","text":"Creates block (dynamic) regression covariate X_t.","code":""},{"path":"/reference/regression_block.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Structural blocks for regressions — regression_block","text":"","code":"regression_block(   ...,   max.lag = 0,   zero.fill = TRUE,   name = \"Var.Reg\",   D = 1,   h = 0,   H = 0,   a1 = 0,   R1 = 9,   monitoring = rep(FALSE, max.lag + 1) )"},{"path":"/reference/regression_block.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Structural blocks for regressions — regression_block","text":"... Named values planning matrix. max.lag Non-negative integer: optional argument providing maximum lag explanatory variables. positive value provided, block create additional latent states measure lagged effect X_t given value. See West Harrison (1997) , subsection 9.2.2 item (3). zero.fill boolean: Boolean indicating block fill initial delay values 0's. TRUE max.lag positive, block assumes X_t=0 t<1. FALSE, block assumes user provide X_t t, X_t size t+propagation_size name String: optional argument providing name block. Can useful identify models meaningful labels, also, name used used auxiliary functions. D Array, Matrix, vector scalar: values discount factors time. D array, dimensions n x n x t, n order polynomial block t length outcomes. D matrix, dimensions n x n values used time. D vector scalar, discount factor matrix created diagonal matrix values D diagonal. h Matrix, vector scalar: drift add temporal evolution (can interpreted mean random noise time). matrix, dimension 2 x t, t length series. vector, size t, value applied first latent state (one affects linear predictors) respective time. scalar, passed value used first latent state time. H Array, Matrix, vector scalar: values covariance matrix noise factor time. H array, dimensions n x n x t, n order polynomial block t length outcomes. H matrix, dimensions n x n values used time. H vector scalar, discount factor matrix created diagonal matrix values H diagonal. a1 Vector scalar: prior mean latent states associated block time 1. a1 vector, dimension equal order polynomial block. a1 scalar, value used latent states. R1 Matrix, vector scalar: prior covariance matrix latent states associated block time 1. R1 matrix, dimensions n x n. R1 vector scalar, covariance matrix created diagonal matrix values R1 diagonal. monitoring Vector: vector flags indicating variables monitored (automated monitoring used). size n. default variable monitored.","code":""},{"path":"/reference/regression_block.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Structural blocks for regressions — regression_block","text":"dlm_block object containing following values: FF Array: 3D-array containing regression matrix time. dimension n x k x t, n number latent states, k number linear predictors model t time series length. FF.labs Matrix: n x k character matrix describing type value element FF. G Matrix: 3D-array containing evolution matrix time. dimension n x n x t, n number latent states t time series length. G.labs Matrix: n x n character matrix describing type value element G. D Array: 3D-array containing discount factor matrix time. dimension n x n x t, n number latent states t time series length. h Matrix: mean random noise temporal evolution. dimension n x t. H Array: 3D-array containing covariance matrix noise time. dimension D. a1 Vector: prior mean latent vector. R1 Matrix: prior covariance matrix latent vector. var.names list: list containing variables indexes name. max.lag Positive integer: argument. n Positive integer: number latent states associated block (2). t Positive integer: number time steps associated block. 1, block compatible blocks time length, t greater 1, block can used blocks time length. k Positive integer: number outcomes associated block. block can used blocks outcome length. pred.names Vector: name linear predictors associated block. monitoring Vector: argument. type Character: type block (Harmonic).","code":""},{"path":"/reference/regression_block.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Structural blocks for regressions — regression_block","text":"..., D, H, a1 R1 arguments, user may set one values string. , user leave block partially undefined. user must pass undefined parameter values named arguments fit_model function. Also, multiple values can passed, allowing sensitivity analysis value parameter. details implementation see dos Santos et al. (2024) . details dynamic regression models context DLM's, see West Harrison (1997) , chapters 6 9.","code":""},{"path":"/reference/regression_block.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Structural blocks for regressions — regression_block","text":"Junior, Silvaneo Vieira dos Santos, Mariane Branco Alves, Helio S. Migon (2024). “kDGLM: R package Bayesian analysis Dynamic Generialized Linear Models.” Mike West, Jeff Harrison (1997). Bayesian Forecasting Dynamic Models (Springer Series Statistics). Springer-Verlag. ISBN 0387947256.","code":""},{"path":[]},{"path":"/reference/regression_block.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Structural blocks for regressions — regression_block","text":"","code":"structure <- (   polynomial_block(p = 1, order = 2, D = 0.95) +     harmonic_block(p = 1, period = 12, D = 0.95) +     regression_block(p = chickenPox$date >= as.Date(\"2013-09-01\"))   # Vaccine was introduced in September of 2013 ) * 4  outcome <- Multinom(p = structure$pred.names, data = chickenPox[, c(2, 3, 4, 6, 5)]) fitted.data <- fit_model(structure, chickenPox = outcome) summary(fitted.data) #> Fitted DGLM with 1 outcomes. #>  #> distributions: #>     chickenPox: Multinomial #>  #> Static coeficients (smoothed): #>                  Estimate Std. Error   t value Pr(>|t|) #> Var.Reg.1         0.32058    0.09625   3.33080 8.66e-04 ***  #> Var.Reg.2         0.53709    0.13266   4.04872 5.15e-05 ***  #> Var.Reg.3         0.47829    0.17849   2.67965    0.007 **  #> Var.Reg.4        -0.27518    0.10475  -2.62711    0.009 **  #> --- #> Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1 #>  #> --- #> See the coef.fitted_dlm for the coeficients with temporal dynamic. #>  #> One-step-ahead prediction #> Log-likelihood        : -1800.428 #> Interval Score        : 120.88889 #> Mean Abs. Scaled Error:   0.68065 #> --- plot(coef(fitted.data), plot.pkg = \"base\")"},{"path":"/reference/rmvnorm.html","id":null,"dir":"Reference","previous_headings":"","what":"rmvnorm — rmvnorm","title":"rmvnorm — rmvnorm","text":"Obtains sample multivariate normal distribution.","code":""},{"path":"/reference/rmvnorm.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"rmvnorm — rmvnorm","text":"","code":"rmvnorm(n, mu, Sigma, norm.x = matrnorm(k, n, seed = round(runif(1) * 1e+15)))"},{"path":"/reference/rmvnorm.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"rmvnorm — rmvnorm","text":"n integer: sample size. mu numeric: mean vector Sigma matrix: Covariance matrix.","code":""},{"path":"/reference/rowQuantile.html","id":null,"dir":"Reference","previous_headings":"","what":"rowQuantile — rowQuantile","title":"rowQuantile — rowQuantile","text":"function calculates row-wise quantile matrix.","code":""},{"path":"/reference/rowQuantile.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"rowQuantile — rowQuantile","text":"","code":"rowQuantile(X, q)"},{"path":"/reference/rowQuantile.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"rowQuantile — rowQuantile","text":"X matrix. q numeric: number 0 1.","code":""},{"path":"/reference/rowQuantile.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"rowQuantile — rowQuantile","text":"numeric: chosen quantile row X.","code":""},{"path":"/reference/simulate.fitted_dlm.html","id":null,"dir":"Reference","previous_headings":"","what":"Draw samples from the distribution of the latent states — simulate.fitted_dlm","title":"Draw samples from the distribution of the latent states — simulate.fitted_dlm","text":"function draws samples latent states using backward sampling algorithm. See West Harrison (1997) , chapter 15, details.","code":""},{"path":"/reference/simulate.fitted_dlm.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Draw samples from the distribution of the latent states — simulate.fitted_dlm","text":"","code":"# S3 method for fitted_dlm simulate(object, nsim, seed = NULL, lag = -1, ...)"},{"path":"/reference/simulate.fitted_dlm.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Draw samples from the distribution of the latent states — simulate.fitted_dlm","text":"object fitted_dlm: fitted model sample. nsim integer: number samples draw. seed integer: object specifying random number generator initialized. lag integer: relative offset forecast. Values time t calculated based filtered values time t-h. lag negative, smoothed distribution latent states used. ... Extra arguments passed plot method.","code":""},{"path":"/reference/simulate.fitted_dlm.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Draw samples from the distribution of the latent states — simulate.fitted_dlm","text":"list containing following values: theta array: array containing sample latent states. Dimensions n x t x nsim, n number latent states model t number observed values. lambda array: array containing sample linear predictors. Dimensions k x t x nsim, k number linear predictors model t number observed values. param list: named list containing, model outcome, array samples parameters observational model. array dimensions l x t x nsim, l number parameters observational model t number observed values.","code":""},{"path":[]},{"path":"/reference/simulate.fitted_dlm.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Draw samples from the distribution of the latent states — simulate.fitted_dlm","text":"","code":"structure <- polynomial_block(mu = 1, D = 0.95) +   polynomial_block(V = 1, D = 0.95)  outcome <- Normal(mu = \"mu\", V = \"V\", data = cornWheat$corn.log.return[1:500]) fitted.data <- fit_model(structure, corn = outcome)  sample <- simulate(fitted.data, 5000)"},{"path":"/reference/smoothing.html","id":null,"dir":"Reference","previous_headings":"","what":"Auxiliary function for model smoothing — smoothing","title":"Auxiliary function for model smoothing — smoothing","text":"Auxiliary function model smoothing","code":""},{"path":"/reference/smoothing.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Auxiliary function for model smoothing — smoothing","text":"","code":"smoothing(model)"},{"path":"/reference/smoothing.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Auxiliary function for model smoothing — smoothing","text":"model fitted_dlm object.","code":""},{"path":"/reference/smoothing.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Auxiliary function for model smoothing — smoothing","text":"fitted_dlm object smoothed means (mts) covariance matrix (Cts) observation.","code":""},{"path":[]},{"path":"/reference/specify.dlm_block.html","id":null,"dir":"Reference","previous_headings":"","what":"Specify method for dlm blocks — specify.dlm_block","title":"Specify method for dlm blocks — specify.dlm_block","text":"Sets values undefined parameters block passed user.","code":""},{"path":"/reference/specify.dlm_block.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Specify method for dlm blocks — specify.dlm_block","text":"","code":"# S3 method for dlm_block specify(x, ...)"},{"path":"/reference/specify.dlm_block.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Specify method for dlm blocks — specify.dlm_block","text":"x dlm_block: undefined dlm_block object undefined parameters shall substituted. ... set named values unknown parameter.","code":""},{"path":"/reference/specify.dlm_block.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Specify method for dlm blocks — specify.dlm_block","text":"initual block, undefined parameters set chosen values.","code":""},{"path":[]},{"path":"/reference/specify.dlm_block.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Specify method for dlm blocks — specify.dlm_block","text":"","code":"season <- harmonic_block(rate = 1, period = 12, D = \"D.sazo\") |>   specify(D.sazo = 0.975)"},{"path":"/reference/summary.dlm_block.html","id":null,"dir":"Reference","previous_headings":"","what":"Summary for a kDGLM structure — summary.dlm_block","title":"Summary for a kDGLM structure — summary.dlm_block","text":"Prints report dlm_block object.","code":""},{"path":"/reference/summary.dlm_block.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Summary for a kDGLM structure — summary.dlm_block","text":"","code":"# S3 method for dlm_block summary(object, ...)"},{"path":"/reference/summary.dlm_block.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Summary for a kDGLM structure — summary.dlm_block","text":"object dlm_block object.","code":""},{"path":"/reference/summary.dlm_block.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Summary for a kDGLM structure — summary.dlm_block","text":"return value, called print summary kDGLM structure.","code":""},{"path":[]},{"path":"/reference/summary.dlm_distr.html","id":null,"dir":"Reference","previous_headings":"","what":"Summary for a kDGLM outcome — summary.dlm_distr","title":"Summary for a kDGLM outcome — summary.dlm_distr","text":"Prints report dlm_distr object.","code":""},{"path":"/reference/summary.dlm_distr.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Summary for a kDGLM outcome — summary.dlm_distr","text":"","code":"# S3 method for dlm_distr summary(object, ...)"},{"path":"/reference/summary.dlm_distr.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Summary for a kDGLM outcome — summary.dlm_distr","text":"object dlm_distr object.","code":""},{"path":"/reference/summary.dlm_distr.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Summary for a kDGLM outcome — summary.dlm_distr","text":"return value, called print summary kDGLM outcome.","code":""},{"path":[]},{"path":"/reference/summary.fitted_dlm.html","id":null,"dir":"Reference","previous_headings":"","what":"Summary for a fitted kDGLM model — summary.fitted_dlm","title":"Summary for a fitted kDGLM model — summary.fitted_dlm","text":"Prints report fitted_dlm object.","code":""},{"path":"/reference/summary.fitted_dlm.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Summary for a fitted kDGLM model — summary.fitted_dlm","text":"","code":"# S3 method for fitted_dlm summary(   object,   t = object$t,   lag = -1,   metric.lag = 1,   metric.cutoff = floor(object$t/10),   pred.cred = 0.95,   ... )"},{"path":"/reference/summary.fitted_dlm.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Summary for a fitted kDGLM model — summary.fitted_dlm","text":"object fitted_dlm object. t Integer: time index latent states. lag Integer: number steps ahead used evaluating latent states. Use lag<0 smoothed distribution, lag==0 filtered distribution lag=h h-step-ahead prediction. metric.lag Integer: number steps ahead used evaluating predictions used calculating metrics. Use metric.lag<0 smoothed distribution, metric.lag==0 filtered distribution metric.lag=h h-step-ahead prediction. metric.cutoff Integer: cutoff time index metric calculation. Values time ignored. pred.cred numeric: credibility interval used interval score. ... Extra arguments passed coef method.#'","code":""},{"path":"/reference/summary.fitted_dlm.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Summary for a fitted kDGLM model — summary.fitted_dlm","text":"return value, called print summary fitted kDGLM model.","code":""},{"path":[]},{"path":"/reference/summary.fitted_dlm.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Summary for a fitted kDGLM model — summary.fitted_dlm","text":"","code":"data <- c(AirPassengers)  level <- polynomial_block(rate = 1, order = 2, D = 0.95) season <- harmonic_block(rate = 1, order = 2, period = 12, D = 0.975)  outcome <- Poisson(lambda = \"rate\", data)  fitted.data <- fit_model(level, season,   AirPassengers = outcome ) summary(fitted.data) #> Fitted DGLM with 1 outcomes. #>  #> distributions: #>     AirPassengers: Poisson #>  #> --- #> No static coeficients. #> --- #> See the coef.fitted_dlm for the coeficients with temporal dynamic. #>  #> One-step-ahead prediction #> Log-likelihood        : -580.2514 #> Interval Score        : 129.48462 #> Mean Abs. Scaled Error:   0.47013 #> ---"},{"path":"/reference/summary.searched_dlm.html","id":null,"dir":"Reference","previous_headings":"","what":"Summary for a searched_dlm object — summary.searched_dlm","title":"Summary for a searched_dlm object — summary.searched_dlm","text":"Prints report searched_dlm object.","code":""},{"path":"/reference/summary.searched_dlm.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Summary for a searched_dlm object — summary.searched_dlm","text":"","code":"# S3 method for searched_dlm summary(object, ...)"},{"path":"/reference/summary.searched_dlm.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Summary for a searched_dlm object — summary.searched_dlm","text":"object searched_dlm object.","code":""},{"path":"/reference/summary.searched_dlm.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Summary for a searched_dlm object — summary.searched_dlm","text":"return value, called print summary searched_dlm object.","code":""},{"path":[]},{"path":"/reference/TF_block.html","id":null,"dir":"Reference","previous_headings":"","what":"Structural blocks for auto regressive trends and regressions — TF_block","title":"Structural blocks for auto regressive trends and regressions — TF_block","text":"Creates structure Auto Regressive (AR) block (see West Harrison (1997) , chapter 9) desired order. package suppose structure model linear, linearization applied evolution equation, described West Harrison (1997) , chapter 13. block also supports Transfer Functions, necessary specify associated pulse calling TF_block function (see arg.).","code":""},{"path":"/reference/TF_block.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Structural blocks for auto regressive trends and regressions — TF_block","text":"","code":"TF_block(   ...,   order,   noise.var = NULL,   noise.disc = NULL,   pulse = 0,   name = \"Var.AR\",   AR.support = \"free\",   h = 0,   a1 = 0,   R1 = 4,   monitoring = TRUE,   D.coef = 1,   h.coef = 0,   H.coef = 0,   a1.coef = c(1, rep(0, order - 1)),   R1.coef = c(1, rep(0.25, order - 1)),   monitoring.coef = rep(FALSE, order),   D.pulse = 1,   h.pulse = 0,   H.pulse = 0,   a1.pulse = 0,   R1.pulse = 4,   monitoring.pulse = FALSE )"},{"path":"/reference/TF_block.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Structural blocks for auto regressive trends and regressions — TF_block","text":"... Named values planning matrix. order Positive integer: order AR block. noise.var Non-negative scalar: variance white noise added latent state. noise.disc Vector scalar: value discount factor associated current latent state. noise.disc vector, size t interpreted discount factor observed time. D scalar, discount used observation. pulse Vector scalar: optional argument providing values pulse Transfer Function. Default 0 (Transfer Function). name String: optional argument providing name block. Can useful identify models meaningful labels, also, name used used auxiliary functions. AR.support String: Either \"constrained\" \"free\" (default). AR.support \"constrained\", AR coefficients forced interval (-1,1), otherwise, coefficients unrestricted. Beware , restriction coefficients, guarantee estimated coefficients imply stationary process, furthermore, order AR block greater 1. restriction coefficients support available AR blocks order equal 1. h Vector scalar: drift add states temporal evolution (can interpreted mean random noise time). vector, size t, value applied respective time. scalar, passed value used observations. a1 Vector scalar: prior mean states associated block time 1. a1 vector, dimension equal order AR block. a1 scalar, value used coefficients. R1 Matrix, vector scalar: prior covariance matrix states associated block time 1. R1 matrix, dimensions n x n, n order AR block. R1 vector scalar, covariance matrix created diagonal matrix values R1 diagonal. monitoring bool: flag indicating latent state monitored (automated monitoring used). default TRUE. D.coef Array, Matrix, vector scalar: values discount factors associated AR coefficients time. D.coef array, dimensions n x n x t, n order AR block t length outcomes. D.coef matrix, dimensions n x n discount matrix used observations. D.coef vector, size t interpreted discount factor observed time (discount variable). D.coef scalar, discount used AR coefficients times. h.coef Matrix, vector scalar: drift add AR coefficients temporal evolution (can interpreted mean random noise time). matrix, dimension n x t, n order AR block t length series. scalar, passed value used coefficients time. H.coef Array, Matrix, vector scalar: values covariance matrix noise factor associated AR coefficients time. H.coef array, dimensions n x n x t, n order AR block t length outcomes. H.coef matrix, dimensions n x n values used time. H.coef vector scalar, discount factor matrix created diagonal matrix values H.coef diagonal. a1.coef Vector scalar: prior mean AR coefficients associated block time 1. a1.coef vector, dimension equal order AR block. a1.coef scalar, value used coefficients. coefficients restricted interval (-1,1), a1.coef interpreted mean atanh(rho), rho AR coefficient. R1.coef Matrix, vector scalar: prior covariance matrix coefficients associated block time 1. R1.coef matrix, dimensions n x n, n order AR block. R1.coef vector scalar, covariance matrix created diagonal matrix values R1.coef diagonal. coefficients restricted interval (-1,1), R1.coef interpreted covariance matrix atanh(rho), rho AR coefficient. monitoring.coef Vector: vector flags indicating AR coefficients monitored (automated monitoring used). size n, n order AR block. default coefficient monitored. D.pulse Array, Matrix, vector scalar: values discount factors associated pulse coefficients time. D.pulse array, dimensions n x n x t, n number pulses t length outcomes. D.pulse matrix, dimensions n x n discount matrix used observations. D.pulse vector, size t interpreted discount factor observed time (discount variable). D scalar, discount used pulse coefficients times. h.pulse Matrix, vector scalar: drift add pulse effect temporal evolution (can interpreted mean random noise time). matrix, dimension n x t, n number pulses t length series. scalar, passed value used latent state time. H.pulse Array, Matrix, vector scalar: values covariance matrix noise factor associated pulse coefficients time. H.pulse array, dimensions n x n x t, n number pulses t length outcomes. H.pulse matrix, dimensions n x n values used time. H.pulse vector scalar, covariance matrix created diagonal matrix values H.pulse diagonal. a1.pulse Vector scalar: prior mean coefficients associated pulses time 1. a1.pulse vector, dimension equal number pulses. a1.pulse scalar, value used coefficients. R1.pulse Matrix, vector scalar: prior covariance matrix coefficients associated pulses time 1. R1.pulse matrix, dimensions n x n, n number pulses. R1.pulse vector scalar, covariance matrix created diagonal matrix values R1.pulse diagonal. monitoring.pulse Vector: vector flags indicating pulse coefficients monitored (automated monitoring used). size n, n number pulses. default pulse coefficient monitored.","code":""},{"path":"/reference/TF_block.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Structural blocks for auto regressive trends and regressions — TF_block","text":"dlm_block object containing following values: FF Array: 3D-array containing regression matrix time. dimension n x k x t, n number latent states, k number linear predictors model t time series length. FF.labs Matrix: n x k character matrix describing type value element FF. G Matrix: 3D-array containing evolution matrix time. dimension n x n x t, n number latent states t time series length. G.labs Matrix: n x n character matrix describing type value element G. D Array: 3D-array containing discount factor matrix time. dimension n x n x t, n number latent states t time series length. H Array: 3D-array containing covariance matrix noise time. dimension D. a1 Vector: prior mean latent vector. R1 Matrix: prior covariance matrix latent vector. var.names list: list containing variables indexes name. order Positive integer: argument. n Positive integer: number latent states associated block (2). t Positive integer: number time steps associated block. 1, block compatible blocks time length, t greater 1, block can used blocks time length. k Positive integer: number outcomes associated block. block can used blocks outcome length. pred.names Vector: name linear predictors associated block. monitoring Vector: combination monitoring, monitoring monitoring.pulse. type Character: type block (AR). AR.support Character: argument.","code":""},{"path":"/reference/TF_block.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Structural blocks for auto regressive trends and regressions — TF_block","text":"..., noise.var, noise.disc, D, H, a1, R1, a1, R1, a1.pulse, R1.pulse, D.pulse, h.pulse, H.pulse arguments, user may set one values string. , user leave block partially undefined. user must pass undefined parameter values named arguments fit_model function. Also, multiple values can passed, allowing sensitivity analysis value parameter. details implementation see dos Santos et al. (2024) . details Auto regressive models context DLM's, see West Harrison (1997) , chapter 9. details linearization non-linear evolution equations context DLM's, see West Harrison (1997) , chapter 13. details dynamic regression models context DLM's, see West Harrison (1997) , chapters 6 9.","code":""},{"path":"/reference/TF_block.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Structural blocks for auto regressive trends and regressions — TF_block","text":"Junior, Silvaneo Vieira dos Santos, Mariane Branco Alves, Helio S. Migon (2024). “kDGLM: R package Bayesian analysis Dynamic Generialized Linear Models.” Mike West, Jeff Harrison (1997). Bayesian Forecasting Dynamic Models (Springer Series Statistics). Springer-Verlag. ISBN 0387947256.","code":""},{"path":[]},{"path":"/reference/TF_block.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Structural blocks for auto regressive trends and regressions — TF_block","text":"","code":"#### AR block #### TF_block(mu = 1, order = 2, noise.disc = 0.9) #> AR DLM block. #> latent states:  #>     Var.AR.State: Lag.0, Lag.1 (2 variable(s)) #>     Var.AR.Coef: Lag.0, Lag.1 (2 variable(s)) #>  #> Linear predictors:  #>     mu #>  #> Status: defined #> Serie length: 1 #> Interventions at:  #> Number of latent states: 4 #> Number of linear predictors: 1  #### Transfer function #### TF_block(mu = 1, pulse = beaver1$activ, order = 1, noise.disc = 0.9) #> Mixed DLM block. #> latent states:  #>     Var.AR.State: Lag.0 (1 variable(s)) #>     Var.AR.Coef: Lag.0 (1 variable(s)) #>     Var.AR.Pulse: 1 (1 variable(s)) #>  #> Linear predictors:  #>     mu #>  #> Status: defined #> Serie length: 114 #> Interventions at:  #> Number of latent states: 3 #> Number of linear predictors: 1"},{"path":"/reference/times-.dlm_block.html","id":null,"dir":"Reference","previous_headings":"","what":"*.fitted_dlm — *.dlm_block","title":"*.fitted_dlm — *.dlm_block","text":"Define product operator class dlm_block. method wrapper block_mult function.","code":""},{"path":"/reference/times-.dlm_block.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"*.fitted_dlm — *.dlm_block","text":"","code":"# S3 method for dlm_block *(e1, e2)"},{"path":"/reference/times-.dlm_block.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"*.fitted_dlm — *.dlm_block","text":"e1 dlm_block (e2 integer) integer (e2 dlm_block). e2 integer (e1 dlm_block) dlm_block (e1 integer).","code":""},{"path":"/reference/times-.dlm_block.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"*.fitted_dlm — *.dlm_block","text":"combined replicated blocks dlm_block.","code":""},{"path":[]},{"path":"/reference/update.fitted_dlm.html","id":null,"dir":"Reference","previous_headings":"","what":"update.fitted_dlm — update.fitted_dlm","title":"update.fitted_dlm — update.fitted_dlm","text":"update.fitted_dlm","code":""},{"path":"/reference/update.fitted_dlm.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"update.fitted_dlm — update.fitted_dlm","text":"","code":"# S3 method for fitted_dlm update(object, ...)"},{"path":"/reference/update.fitted_dlm.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"update.fitted_dlm — update.fitted_dlm","text":"object fitted_dlm: fitted model updated. ... Extra variables necessary updating (covariates, observed values, etc.).","code":""},{"path":"/reference/update.fitted_dlm.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"update.fitted_dlm — update.fitted_dlm","text":"fitted_dlm object.","code":""},{"path":"/reference/update.fitted_dlm.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"update.fitted_dlm — update.fitted_dlm","text":"covariate necessary updating, passed named argument. name must follow structure: <block name>.Covariate<.index>. one pulse associated block index omitted. pulse necessary updating, passed named argument. name must follow structure: <block name>.Pulse<.index>. one pulse associated block index omitted. offset necessary updating, passed along observed data. See example.","code":""},{"path":[]},{"path":"/reference/update.fitted_dlm.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"update.fitted_dlm — update.fitted_dlm","text":"","code":"level <- polynomial_block(rate = 1, order = 2, D = 0.95) season <- harmonic_block(rate = 1, order = 2, period = 12, D = 0.975)  # Only first 100 observations (for the sake of the example) outcome <- Poisson(lambda = \"rate\", data = c(AirPassengers)[1:100])  fitted.data <- fit_model(level, season,   AirPassengers = outcome )  updated.fit <- update(fitted.data, AirPassengers = list(data = c(AirPassengers)[101:144])) # If a offset was present, the user should pass its value when updating # updated.fit=update(fitted.data, #                     AirPassengers=list( #                      data=c(AirPassengers)[101:144], #                      offset= ... ))"},{"path":"/reference/update_Gamma.html","id":null,"dir":"Reference","previous_headings":"","what":"update_Gamma — update_Gamma","title":"update_Gamma — update_Gamma","text":"Calculate posterior parameter Inverse-Gamma, assuming observed values came Gamma model shape parameter (phi) known mean (mu) prior distribution Inverse-Gamma.","code":""},{"path":"/reference/update_Gamma.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"update_Gamma — update_Gamma","text":"","code":"update_Gamma(conj.param, ft, Qt, y, parms)"},{"path":"/reference/update_Gamma.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"update_Gamma — update_Gamma","text":"conj.param list: vector containing parameters Inverse-Gamma (alpha,beta). ft numeric: vector representing means normal distribution. used default method. Qt matrix: matrix representing covariance matrix normal distribution. used default method. y numeric: vector containing observations. parms list: list extra known parameters distribution. kernel, parms containing shape parameter (phi) observational gamma model.","code":""},{"path":"/reference/update_Gamma.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"update_Gamma — update_Gamma","text":"parameters posterior distribution.","code":""},{"path":[]},{"path":"/reference/update_Multinom.html","id":null,"dir":"Reference","previous_headings":"","what":"update_Multinom — update_Multinom","title":"update_Multinom — update_Multinom","text":"Calculate posterior parameter Dirichlet, assuming observed values came Multinomial model number trials known prior distribution probabilities category joint distribution Dirichlet.","code":""},{"path":"/reference/update_Multinom.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"update_Multinom — update_Multinom","text":"","code":"update_Multinom(conj.param, ft, Qt, y, parms = list())"},{"path":"/reference/update_Multinom.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"update_Multinom — update_Multinom","text":"conj.param list: vector containing concentration parameters Dirichlet. ft vector: vector representing means normal distribution. used default method. Qt matrix: matrix representing covariance matrix normal distribution. used default method. y vector: vector containing observations. parms list: list extra known parameters distribution. used kernel.","code":""},{"path":"/reference/update_Multinom.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"update_Multinom — update_Multinom","text":"parameters posterior distribution.","code":""},{"path":[]},{"path":"/reference/update_multi_NG_correl.html","id":null,"dir":"Reference","previous_headings":"","what":"update_multi_NG_correl — update_multi_NG_correl","title":"update_multi_NG_correl — update_multi_NG_correl","text":"update_multi_NG_correl","code":""},{"path":"/reference/update_multi_NG_correl.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"update_multi_NG_correl — update_multi_NG_correl","text":"","code":"update_multi_NG_correl(conj.param, ft, Qt, y, parms)"},{"path":"/reference/update_multi_NG_correl.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"update_multi_NG_correl — update_multi_NG_correl","text":"parameters posterior distribution.","code":""},{"path":"/reference/update_NG.html","id":null,"dir":"Reference","previous_headings":"","what":"update_NG — update_NG","title":"update_NG — update_NG","text":"Calculate posterior parameter Normal-Gamma, assuming observed values came Normal model prior distribution mean precision joint distribution Normal-Gamma","code":""},{"path":"/reference/update_NG.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"update_NG — update_NG","text":"","code":"update_NG(conj.param, ft, Qt, y, parms = list())"},{"path":"/reference/update_NG.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"update_NG — update_NG","text":"conj.param list: vector containing parameters Normal-Gamma (mu0,c0,alpha,beta). ft numeric: vector representing means normal distribution. used default method. Qt matrix: matrix representing covariance matrix normal distribution. used default method. y numeric: vector containing observations. parms list: list extra known parameters distribution. used kernel.","code":""},{"path":"/reference/update_NG.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"update_NG — update_NG","text":"parameters posterior distribution.","code":""},{"path":"/reference/update_NG2.html","id":null,"dir":"Reference","previous_headings":"","what":"update_NG — update_NG2","title":"update_NG — update_NG2","text":"Calculate posterior parameter Normal-Gamma, assuming observed values came Normal model prior distribution mean precision joint distribution Normal-Gamma","code":""},{"path":"/reference/update_NG2.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"update_NG — update_NG2","text":"","code":"update_NG2(conj.param, ft, Qt, y, parms = list())"},{"path":"/reference/update_NG2.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"update_NG — update_NG2","text":"conj.param list: vector containing parameters Normal-Gamma (mu0,c0,alpha,beta). ft numeric: vector representing means normal distribution. used default method. Qt matrix: matrix representing covariance matrix normal distribution. used default method. y numeric: vector containing observations. parms list: list extra known parameters distribution. used kernel.","code":""},{"path":"/reference/update_NG2.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"update_NG — update_NG2","text":"parameters posterior distribution.","code":""},{"path":"/reference/update_Normal.html","id":null,"dir":"Reference","previous_headings":"","what":"update_Normal — update_Normal","title":"update_Normal — update_Normal","text":"Calculate posterior parameter Normal, assuming observed values came Normal model covariance known prior distribution mean vector Normal distribution","code":""},{"path":"/reference/update_Normal.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"update_Normal — update_Normal","text":"","code":"update_Normal(conj.param, ft, Qt, y, parms)"},{"path":"/reference/update_Normal.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"update_Normal — update_Normal","text":"conj.param list: vector containing concentration parameters Normal. ft numeric: vector representing means normal distribution. used default method. Qt matrix: matrix representing covariance matrix normal distribution. used default method. y numeric: vector containing observations. parms list: list extra known parameters distribution. kernel, parms containing covariance matrix parameter (V) observational Normal model.","code":""},{"path":"/reference/update_Normal.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"update_Normal — update_Normal","text":"parameters posterior distribution.","code":""},{"path":[]},{"path":"/reference/update_Poisson.html","id":null,"dir":"Reference","previous_headings":"","what":"update_Poisson — update_Poisson","title":"update_Poisson — update_Poisson","text":"Calculate posterior parameter Gamma, assuming observed values came Poisson model rate parameter (lambda) prior distribution Gamma.","code":""},{"path":"/reference/update_Poisson.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"update_Poisson — update_Poisson","text":"","code":"update_Poisson(conj.param, ft, Qt, y, parms)"},{"path":"/reference/update_Poisson.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"update_Poisson — update_Poisson","text":"conj.param list: vector containing parameters Gamma (alpha,beta). ft numeric: vector representing means normal distribution. used default method. Qt matrix: matrix representing covariance matrix normal distribution. used default method. y numeric: vector containing observations. parms list: list extra known parameters distribution. used kernel.","code":""},{"path":"/reference/update_Poisson.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"update_Poisson — update_Poisson","text":"parameters posterior distribution.","code":""},{"path":[]},{"path":"/reference/var_decomp.html","id":null,"dir":"Reference","previous_headings":"","what":"var_decomp — var_decomp","title":"var_decomp — var_decomp","text":"function receives covariance matrix S creates matrix Q, t(Q)","code":""},{"path":"/reference/var_decomp.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"var_decomp — var_decomp","text":"","code":"var_decomp(S)"},{"path":"/reference/var_decomp.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"var_decomp — var_decomp","text":"S covariance matrix","code":""},{"path":"/reference/zero_sum_prior.html","id":null,"dir":"Reference","previous_headings":"","what":"Zero sum prior — zero_sum_prior","title":"Zero sum prior — zero_sum_prior","text":"Defines prior structural block latent states sum zero probability one.","code":""},{"path":"/reference/zero_sum_prior.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Zero sum prior — zero_sum_prior","text":"","code":"zero_sum_prior(   block,   var.index = 1:block$n,   weights = rep(1, length(var.index)) )"},{"path":"/reference/zero_sum_prior.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Zero sum prior — zero_sum_prior","text":"block dlm_block object: structural block. var.index integer: index variables set prior. weights numeric: vector indicating linear transformation data 0 probability 1. Default equivalent zero-sum restriction.","code":""},{"path":"/reference/zero_sum_prior.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Zero sum prior — zero_sum_prior","text":"dlm_block object desired prior.","code":""},{"path":"/reference/zero_sum_prior.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Zero sum prior — zero_sum_prior","text":"covariance matrix evolution drift parameter also altered guarantee zero sum condition always hold. discount factor must variables whose prior modified. details implementation see dos Santos et al. (2024) .","code":""},{"path":"/reference/zero_sum_prior.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Zero sum prior — zero_sum_prior","text":"Junior, Silvaneo Vieira dos Santos, Mariane Branco Alves, Helio S. Migon (2024). “kDGLM: R package Bayesian analysis Dynamic Generialized Linear Models.”","code":""},{"path":[]},{"path":"/reference/zero_sum_prior.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Zero sum prior — zero_sum_prior","text":"","code":"polynomial_block(mu = 1, D = 0.95) |>   block_mult(5) |>   zero_sum_prior() #> Mixed DLM block. #> latent states:  #>     Var.Poly.1: Level (1 variable(s)) #>     Var.Poly.2: Level (1 variable(s)) #>     Var.Poly.3: Level (1 variable(s)) #>     Var.Poly.4: Level (1 variable(s)) #>     Var.Poly.5: Level (1 variable(s)) #>  #> Linear predictors:  #>     mu.1 #>     mu.2 #>     mu.3 #>     mu.4 #>     mu.5 #>  #> Status: defined #> Serie length: 1 #> Interventions at:  #> Number of latent states: 5 #> Number of linear predictors: 5"}]
