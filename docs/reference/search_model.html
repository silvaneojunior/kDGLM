<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="Search the best hyper parameters fo a kDGLM model"><title>Search the best hyper parameters fo a kDGLM model — search_model • kDGLM</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Search the best hyper parameters fo a kDGLM model — search_model"><meta property="og:description" content="Search the best hyper parameters fo a kDGLM model"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">kDGLM</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.1.3</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/intro.html">Notation</a>
    <a class="dropdown-item" href="../articles/structures.html">Creation of model structures</a>
    <a class="dropdown-item" href="../articles/outcomes.html">Creation of model outcomes</a>
    <a class="dropdown-item" href="../articles/fitting.html">Fitting and analysing models</a>
    <a class="dropdown-item" href="../articles/example1.html">Applied example: Space-time model hospital admissions from gastroenteritis</a>
  </div>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"><li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/silvaneojunior/kDGLM/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Search the best hyper parameters fo a kDGLM model</h1>
      <small class="dont-index">Source: <a href="https://github.com/silvaneojunior/kDGLM/blob/HEAD/R/main.R" class="external-link"><code>R/main.R</code></a></small>
      <div class="d-none name"><code>search_model.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Search the best hyper parameters fo a kDGLM model</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">search_model</span><span class="op">(</span></span>
<span>  <span class="va">...</span>,</span>
<span>  <span class="va">search.grid</span>,</span>
<span>  condition <span class="op">=</span> <span class="st">"TRUE"</span>,</span>
<span>  metric <span class="op">=</span> <span class="st">"log.like"</span>,</span>
<span>  smooth <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  lag <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  pred.cred <span class="op">=</span> <span class="fl">0.95</span>,</span>
<span>  metric.cutoff <span class="op">=</span> <span class="cn">NA</span>,</span>
<span>  p.monit <span class="op">=</span> <span class="cn">NA</span>,</span>
<span>  save.models <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>...</dt>
<dd><p>dlm_block or dlm_distr objects: The structural blocks of the model (dlm_block objects), alongside the model outcomes (dlm_distr object). At least one block must be undefined.</p></dd>


<dt>search.grid</dt>
<dd><p>list: A named list containing the possible values of each undefined hyper parameter.</p></dd>


<dt>condition</dt>
<dd><p>character: A character defining which combinations of undefined hyper parameter should be tested. See example for details.</p></dd>


<dt>metric</dt>
<dd><p>character: The name of the metric to use for model selection. One of log-likelihood for the one-step-ahead prediction ("log.like"), Mean Absolute Error ("mae"), Mean Absolute Scaled Error ("mase") (Hyndman and Koehler 2006)
, Relative Absolute Error ("rae"), Mean Squared Error ("mse") or Interval Score ("interval.score") (Bracher et al. 2022)
.</p></dd>


<dt>smooth</dt>
<dd><p>boolean: A flag indicating if the smoothed distribution for the latent variables should be calculated.</p></dd>


<dt>lag</dt>
<dd><p>integer: The number of steps ahead used for the prediction when calculating the metrics. If lag&lt;0, predictions are made using the smoothed distribution of the latent variables.</p></dd>


<dt>pred.cred</dt>
<dd><p>numeric: A number between 0 and 1 (not included) indicating the credibility interval for predictions. If not within the valid range of values, 0.95 will be used.</p></dd>


<dt>metric.cutoff</dt>
<dd><p>integer: The number of observations to ignore when calculating the metrics. Default is 1/10 of the number of observations (rounded down).</p></dd>


<dt>p.monit</dt>
<dd><p>numeric (optional): The prior probability of changes in the latent space variables that are not part of its dynamic.</p></dd>


<dt>save.models</dt>
<dd><p>boolean: A flag indicating if all evaluated models should be saved. If FALSE, only the best model (according to the chosen metric) will be saved;</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    

<p>A searched_dlm object containing the following values:</p><ul><li><p>search.data data.frame: A table contain the metrics of each combination of hyper parameter tested and ordered from best combination to worst.</p></li>
<li><p>structure dlm_block object: The initial structure passed by the user, by with the undefined hyper parameters set to the best values found.</p></li>
<li><p>model fitted_dlm object: A model fitted with the best combination of hyper parameters.</p></li>
</ul></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>This is an auxiliary function to search for the best combination of hyper parameters among the possible variations specified by the user.
This function simple evaluates all possible combinations and chooses the one that results in the best fitting.</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Johannes Bracher, Evan
L. Ray, Tilmann Gneiting, Nicholas
G. Reich (2022).
“Correction: Evaluating epidemic forecasts in an interval format.”
<em>PLOS Computational Biology</em>, <b>18</b>(10), 1-3.
<a href="https://doi.org/10.1371/journal.pcbi.1010592" class="external-link">doi:10.1371/journal.pcbi.1010592</a>
.<br><br> Rob
J. Hyndman, Anne
B. Koehler (2006).
“Another look at measures of forecast accuracy.”
<em>International Journal of Forecasting</em>, <b>22</b>(4), 679--688.
<a href="http://www.sciencedirect.com/science/article/B6V92-4K18VK5-1/1/227cef013b86100791c53712fae7677c" class="external-link">http://www.sciencedirect.com/science/article/B6V92-4K18VK5-1/1/227cef013b86100791c53712fae7677c</a>.</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p>Other auxiliary functions for fitted_dlm objects: 
<code><a href="coef.fitted_dlm.html">coef.fitted_dlm</a>()</code>,
<code><a href="dlm_sampling.html">dlm_sampling</a>()</code>,
<code><a href="eval_dlm_norm_const.html">eval_dlm_norm_const</a>()</code>,
<code><a href="fit_model.html">fit_model</a>()</code>,
<code><a href="forecast.fitted_dlm.html">forecast.fitted_dlm</a>()</code>,
<code><a href="smoothing.html">smoothing</a>()</code>,
<code><a href="update.fitted_dlm.html">update.fitted_dlm</a>()</code></p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">AirPassengers</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">level</span> <span class="op">&lt;-</span> <span class="fu"><a href="polynomial_block.html">polynomial_block</a></span><span class="op">(</span>rate <span class="op">=</span> <span class="fl">1</span>, order <span class="op">=</span> <span class="fl">2</span>, D <span class="op">=</span> <span class="fl">0.95</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">season</span> <span class="op">&lt;-</span> <span class="fu"><a href="harmonic_block.html">harmonic_block</a></span><span class="op">(</span>rate <span class="op">=</span> <span class="st">"sazo.effect"</span>, order <span class="op">=</span> <span class="fl">2</span>, period <span class="op">=</span> <span class="fl">12</span>, D <span class="op">=</span> <span class="st">"D.sazo"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">outcome</span> <span class="op">&lt;-</span> <span class="fu"><a href="Poisson.html">Poisson</a></span><span class="op">(</span>lambda <span class="op">=</span> <span class="st">"rate"</span>, data <span class="op">=</span> <span class="va">data</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu">search_model</span><span class="op">(</span><span class="va">level</span>, <span class="va">season</span>,</span></span>
<span class="r-in"><span>  outcomes <span class="op">=</span> <span class="va">outcome</span>,</span></span>
<span class="r-in"><span>  search.grid <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>    sazo.effect <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    D.sazo <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq.int</a></span><span class="op">(</span><span class="fl">0.95</span>, <span class="fl">1</span>, l <span class="op">=</span> <span class="fl">11</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="op">)</span>,</span></span>
<span class="r-in"><span>  condition <span class="op">=</span> <span class="st">"sazo.effect==1 | D.sazo==1"</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [====                                              ] - 8.33% - ETA - 0 minutes                 [========                                          ] - 16.67% - ETA - 0.01 minutes                 [============                                      ] - 25% - ETA - 0.01 minutes                 [=================                                 ] - 33.33% - ETA - 0.01 minutes                 [=====================                             ] - 41.67% - ETA - 0.01 minutes                 [=========================                         ] - 50% - ETA - 0.01 minutes                 [=============================                     ] - 58.33% - ETA - 0 minutes                 [=================================                 ] - 66.67% - ETA - 0 minutes                 [======================================            ] - 75% - ETA - 0 minutes                 [==========================================        ] - 83.33% - ETA - 0 minutes                 [==============================================    ] - 91.67% - ETA - 0 minutes                 [==================================================] - 100% - ETA - 0 minutes                 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    sazo.effect D.sazo  log.like      mae        rae      mse      mase</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 20           1  0.995 -564.3869 13.84093 0.05111656 325.6502 0.4321200</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 22           1  1.000 -564.5277 13.88405 0.05102099 332.5234 0.4334661</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 18           1  0.990 -564.6147 13.83227 0.05130397 321.3583 0.4318495</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 16           1  0.985 -565.1605 13.83729 0.05152992 319.2973 0.4320063</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 14           1  0.980 -565.9742 13.85868 0.05180876 319.1286 0.4326739</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    interval.score</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 20       102.3692</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 22       102.9538</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 18       101.5154</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 16       101.6769</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 14       102.3462</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Fitted DGLM with 1 outcomes.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> distributions:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     outcomes: Poisson</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Coeficients (smoothed) at time 144:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                 Estimate Std. Error   t value Pr(&gt;|t|)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Var.Poly.Level   6.21075    0.01381 449.64055   &lt;1e-12 *** </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Var.Poly.Slope   0.00897    0.00050  17.83528   &lt;1e-12 *** </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Var.Sazo.Main.1 -0.15281    0.00840 -18.18911   &lt;1e-12 *** </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Var.Sazo.Aux.1  -0.06640    0.00847  -7.83729   &lt;1e-12 *** </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Var.Sazo.Main.2 -0.01352    0.00817  -1.65530    0.098   </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Var.Sazo.Aux.2   0.08280    0.00832   9.95199   &lt;1e-12 *** </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ---</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ---</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> One-step-ahead prediction</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Log-likelihood        : -564.38688</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Interval Score        :  102.36923</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Mean Abs. Scaled Error:    0.43212</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Relative abs. Error   :    0.05112</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Mean Abs. Error       :   13.84093</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Mean Squared Error    :  325.65021</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ---</span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Developed by Silvaneo dos Santos.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer></div>

  

  

  </body></html>

