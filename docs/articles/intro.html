<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="kDGLM">
<title>kDGLM: an R package for Bayesian analysis of Dynamic Generialized Linear Models • kDGLM</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="kDGLM: an R package for Bayesian analysis of Dynamic Generialized Linear Models">
<meta property="og:description" content="kDGLM">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">kDGLM</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.1.3</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/example1.html">Space-time model hospital admissions from gastroenteritis</a>
    <a class="dropdown-item" href="../articles/fitting.html">Fitting and analysing models</a>
    <a class="dropdown-item" href="../articles/intro.html">kDGLM: an R package for Bayesian analysis of Dynamic Generialized Linear Models</a>
    <a class="dropdown-item" href="../articles/outcomes.html">Creation of model outcomes</a>
    <a class="dropdown-item" href="../articles/structures.html">Creation of model structures</a>
  </div>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/silvaneojunior/kDGLM/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>kDGLM: an R package for Bayesian analysis of Dynamic Generialized Linear Models</h1>
                        <h4 data-toc-skip class="author">Silvaneo V. dos
Santos Jr.</h4>
            
            <h4 data-toc-skip class="date">21 of February, 2024</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/silvaneojunior/kDGLM/blob/HEAD/vignettes/intro.Rmd" class="external-link"><code>vignettes/intro.Rmd</code></a></small>
      <div class="d-none name"><code>intro.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="table-of-contents">Table of contents<a class="anchor" aria-label="anchor" href="#table-of-contents"></a>
</h2>
<ol>
<li>
<details><summary><a href="intro.html">Introduction:</a> &gt;
</summary><ul>
<li>
<a href="intro.html#introduction">Introduction</a>
</li>
<li>
<a href="intro.html#notation">Notation</a>
</li>
</ul></details>
</li>
<li>
<details><summary><a href="structures.html">Creating the model structure:</a> &gt;
</summary><ul>
<li>
<a href="structures.html#a-structure-for-polynomial-trend-models">A
structure for polynomial trend models</a>
</li>
<li>
<a href="structures.html#a-structure-for-dynamic-regression-models">A
structure for dynamic regression models</a>
</li>
<li>
<a href="structures.html#a-structure-for-harmonic-trend-models">A
structure for harmonic trend models</a>
</li>
<li>
<a href="structures.html#a-structure-for-autoregresive-models">A
structure for autoregresive models</a>
</li>
<li>
<a href="structures.html#a-structure-for-overdispersed-models">A
structure for overdispersed models</a>
</li>
<li>
<a href="structures.html#handling-multiple-structural-blocks">Handling
multiple structural blocks</a>
</li>
<li>
<a href="structures.html#handling-multiple-linear-predictors">Handling
multiple linear predictors</a>
</li>
<li>
<a href="structures.html#handling-unknown-components-in-the-planning-matrix-f_t">Handling
unknown components in the planning matrix <span class="math inline">\(F_t\)</span></a>
</li>
<li>
<a href="structures.html#special-priors">Special priors</a>
</li>
</ul></details>
</li>
<li>
<details><summary><a href="outcomes.html">Creating the model outcome:</a> &gt;
</summary><ul>
<li>
<a href="outcomes.html#normal-case">Normal case</a>
</li>
<li>
<a href="outcomes.html#poisson-case">Poisson case</a>
</li>
<li>
<a href="outcomes.html#gamma-case">Gamma case</a>
</li>
<li>
<a href="outcomes.html#multinomial-case">Multinomial case</a>
</li>
<li>
<a href="outcomes.html#handling-multiple-outcomes">Handling multiple
outcomes</a>
</li>
</ul></details>
</li>
<li>
<details><summary><a href="fitting.html">Fitting and analysing models:</a> &gt;
</summary><ul>
<li>
<a href="fitting.html#filtering-and-smoothing">Filtering and
smoothing</a>
</li>
<li>
<a href="fitting.html#extracting-components">Extracting components</a>
</li>
<li>
<a href="fitting.html#forecasting">Forecasting</a>
</li>
<li>
<a href="fitting.html#intervention-and-monitoring">Intervention and
monitoring</a>
</li>
<li>
<a href="fitting.html#tools-for-sensibility-analysis">Tools for
sensibility analysis</a>
</li>
<li>
<a href="fitting.html#sampling-and-hyper-parameter-estimation">Sampling
and hyper parameter estimation</a>
</li>
</ul></details>
</li>
<li>
<details><summary>
Advanced examples:&gt;
</summary><ul><li>
<a href="example1.html">Space-time model hospital admissions from
gastroenteritis</a>
</li></ul></details>
</li>
</ol>
</div>
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>This vignette is intended as an introduction to the usage of the
kDGLM package, which offers routines for Bayesian analysis of Dynamic
Generalized Linear Models, including fitting (filtering and smoothing),
forecasting, sampling, intervention and automated monitoring, following
the theory developed and/or explored in <span class="citation">Kalman
(<a href="#ref-Kalman_filter_origins">1960</a>)</span>, <span class="citation">West and Harrison (<a href="#ref-WestHarr-DLM">1997</a>)</span> and <span class="citation">Alves et al. (<a href="#ref-ArtigokParametrico">2023</a>)</span>.</p>
<p>In this document we will focus exclusively in the usage of the
package and will only briefly mention the theory behind these models and
only with the intention of highlighting the notation. We highly
recommend all users to read the theoretical work in which we based this
package.</p>
<p>This document is organized in the following order:</p>
<ol style="list-style-type: decimal">
<li>First we introduce the notations and the class of models we will be
dealing with;</li>
<li>Next we present the details about the specification of the model
structure, offering tools that allow for an easy, fast and (hopefully)
intuitive way of defining models;</li>
<li>In the following section we discuss details about how the user can
specify the observational model;</li>
<li>Then we present some basic examples of model fitting, also showing
the auxiliary functions that help the user to analyse the fitted model.
We also show tools for easy model selection;</li>
<li>Lastly, we present a variety of advanced examples, combining the
basic features shown in previous sections to create more complex
models;</li>
</ol>
</div>
<div class="section level2">
<h2 id="notation">Notation<a class="anchor" aria-label="anchor" href="#notation"></a>
</h2>
<p>Let us assume that the user is interested in analyzing a Time Series
<span class="math inline">\(\{Y_t\}_{t=1}^T\)</span> which can be
described by the following model:</p>
<p><span class="math display">\[
\begin{align}
Y_t|\eta_t &amp;\sim \mathcal{F}\left(\eta_t\right),\\
g(\eta_t) &amp;=\lambda_{t}=F_t'\theta_t,\\
\theta_t&amp;=G_t\theta_{t-1}+\omega_t,\\
\omega_t &amp;\sim \mathcal{N}_n(h_t,W_t),
\end{align}
\]</span> where:</p>
<ul>
<li>
<span class="math inline">\(\theta_t\)</span> are the unknown
parameter of interest;</li>
<li>
<span class="math inline">\(\mathcal{F}\)</span> is a probability
distribution in the Exponential Family and indexed by <span class="math inline">\(\eta_t\)</span>;</li>
<li>
<span class="math inline">\(g\)</span>, called the link function, is
a pre-specified function (in this package, each choice of <span class="math inline">\(\mathcal{F}\)</span> will have a pre-determined
<span class="math inline">\(g\)</span>);</li>
<li>
<span class="math inline">\(F_t\)</span>, called the design matrix,
is a (mostly) known matrix specified by the user;</li>
<li>
<span class="math inline">\(G_t\)</span>, called the evolution
matrix, is a (mostly) known matrix specified by the user;</li>
<li>
<span class="math inline">\(h_t\)</span>, called drift, is a known
vector specified by the user. In general, we have <span class="math inline">\(h_t=0\)</span>, except when making interventions
on the model <span class="citation">(see <a href="#ref-WestHarr-DLM">West and Harrison 1997, chap.
11</a>)</span>;</li>
<li>
<span class="math inline">\(W_t\)</span> is a known covariance
matrix specified by the user;</li>
<li>
<span class="math inline">\(n\)</span> is the dimension of <span class="math inline">\(\theta_t\)</span> (we will always consider that
<span class="math inline">\(\theta_t\)</span> has the same dimension for
all <span class="math inline">\(t\)</span>).</li>
</ul>
<p>Also, following the notation in <span class="citation">West and
Harrison (<a href="#ref-WestHarr-DLM">1997</a>)</span>, we will define
<span class="math inline">\(\mathcal{D}_t\)</span> as the information
one has after the first <span class="math inline">\(t\)</span>
observations, such that <span class="math inline">\(\mathcal{D}_t=\mathcal{D}_{t-1}\cup\{Y_t\}\)</span>
(for now, let us assume that there is no external source of information
beside <span class="math inline">\(Y_t\)</span> itself) and <span class="math inline">\(\mathcal{D}_0\)</span> denotes the information we
have about the process <span class="math inline">\(\{Y_t\}^T_{t=1}\)</span> <em>prior</em> to
observing the data.</p>
<p>For the specification of <span class="math inline">\(W_t\)</span>, we
follow the ideas presented <span class="citation">West and Harrison (<a href="#ref-WestHarr-DLM">1997</a>)</span>, section 6.3, such that we
define <span class="math inline">\(W_t=Var[G_t\theta_{t-1}|\mathcal{D}_{t-1}] \odot
(1-D_t) \oslash D_t + H_t\)</span>, where:</p>
<ul>
<li>
<span class="math inline">\(D_t\)</span> (called the discount
matrix) is a matrix of values between <span class="math inline">\(0\)</span> and <span class="math inline">\(1\)</span> (including <span class="math inline">\(1\)</span>, but excluding <span class="math inline">\(0\)</span>);</li>
<li>
<span class="math inline">\(\odot\)</span> is the Hadamard product
(i.e., element-wise product);</li>
<li>
<span class="math inline">\(\oslash\)</span> is the Hadamard
division (i.e., element-wise division);</li>
<li>
<span class="math inline">\(H_t\)</span> is a known matrix specified
by the user.</li>
</ul>
<p>Notice that this specification implies that <span class="math inline">\(Var[\theta_{t}|\mathcal{D}_{t-1}]=Var[G_t\theta_{t-1}|\mathcal{D}_{t-1}]
\oslash D_t + H_t\)</span>, such that, if all entries of <span class="math inline">\(D_t\)</span> are equal to <span class="math inline">\(1\)</span>, then <span class="math inline">\(Var[\theta_{t}|\mathcal{D}_{t-1}]=Var[G_t\theta_{t-1}|\mathcal{D}_{t-1}]+H_t\)</span>.
If also all entries of <span class="math inline">\(H_t\)</span> are
equal to <span class="math inline">\(0\)</span>, then <span class="math inline">\(Var[\theta_{t}|\mathcal{D}_{t-1}]=Var[G_t\theta_{t-1}|\mathcal{D}_{t-1}]\)</span>
(i.e. <span class="math inline">\(\theta_t\)</span> is a deterministic
transformation of <span class="math inline">\(\theta_{t-1}\)</span>),
such that our model becomes equivalent to a Generalized Linear
Model.</p>
<p>Notice that we <strong>did not</strong> make any assumptions on the
dimension of <span class="math inline">\(Y_t\)</span> or <span class="math inline">\(\eta_t\)</span>, indeed, the range of applications
of this package covers both time series of vectors (as in the
Multinomial case) and/or with multiple unknown parameters (as in the
Normal with unknown variance case).</p>
<p>Naturally, the manual specification of all the structural components
of the model can be quite tiresome. With that in mind, our package
offers a wide and ever expanding set of auxiliary functions that aim to
help the user to specify the structure of a model. In the next section
we will explore some of those tools.</p>
</div>
<div class="section level2">
<h2 class="unnumbered" id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<div id="refs" class="references csl-bib-body hanging-indent">
<div id="ref-ArtigokParametrico" class="csl-entry">
Alves, Mariane Branco, Helio S. Migon, Raíra Marotta, and Silvaneo V.
dos Santos Jr. au2. 2023. <span>“K-Parametric Dynamic Generalized Linear
Models: A Sequential Approach via Information Geometry.”</span> arXiv.
<a href="https://doi.org/10.48550/ARXIV.2201.05387" class="external-link">https://doi.org/10.48550/ARXIV.2201.05387</a>.
</div>
<div id="ref-Kalman_filter_origins" class="csl-entry">
Kalman, Rudolph Emil. 1960. <span>“A New Approach to Linear Filtering
and Prediction Problems.”</span> <em>Transactions of the ASME–Journal of
Basic Engineering</em> 82 (Series D): 35–45.
</div>
<div id="ref-WestHarr-DLM" class="csl-entry">
West, Mike, and Jeff Harrison. 1997. <em>Bayesian Forecasting and
Dynamic Models (Springer Series in Statistics)</em>. Hardcover;
Springer-Verlag.
</div>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Silvaneo dos Santos.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
